{"format_version":"1.1","terraform_version":"1.3.2","variables":{"aws_region":{"value":"eu-central-1"},"environment":{"value":"ut-default"}},"planned_values":{"root_module":{"resources":[{"address":"data.aws_security_group.default","mode":"data","type":"aws_security_group","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"filter":[],"name":"default"},"sensitive_values":{"filter":[],"tags":{}}}],"child_modules":[{"resources":[{"address":"module.runner.aws_autoscaling_group.gitlab_runner_instance","mode":"managed","type":"aws_autoscaling_group","name":"gitlab_runner_instance","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"capacity_rebalance":null,"desired_capacity":1,"enabled_metrics":["GroupDesiredCapacity","GroupInServiceCapacity"],"force_delete":false,"force_delete_warm_pool":false,"health_check_grace_period":0,"initial_lifecycle_hook":[],"instance_refresh":[{"preferences":[{"checkpoint_delay":null,"checkpoint_percentages":null,"instance_warmup":null,"min_healthy_percentage":0}],"strategy":"Rolling","triggers":["tag"]}],"launch_configuration":null,"launch_template":[{}],"load_balancers":null,"max_instance_lifetime":null,"max_size":1,"metrics_granularity":"1Minute","min_elb_capacity":null,"min_size":1,"mixed_instances_policy":[],"placement_group":null,"protect_from_scale_in":false,"suspended_processes":null,"tag":[{"key":"Environment","propagate_at_launch":true,"value":"default"},{"key":"Name","propagate_at_launch":true,"value":"default"},{"key":"tf-aws-gitlab-runner:example","propagate_at_launch":true,"value":"runner-default"},{"key":"tf-aws-gitlab-runner:instancelifecycle","propagate_at_launch":true,"value":"spot:yes"}],"tags":null,"target_group_arns":null,"termination_policies":null,"timeouts":{"delete":"10m"},"wait_for_capacity_timeout":"10m","wait_for_elb_capacity":null,"warm_pool":[]},"sensitive_values":{"availability_zones":[],"enabled_metrics":[false,false],"initial_lifecycle_hook":[],"instance_refresh":[{"preferences":[{}],"triggers":[false]}],"launch_template":[{}],"mixed_instances_policy":[],"tag":[{},{},{},{}],"timeouts":{},"vpc_zone_identifier":[],"warm_pool":[]}},{"address":"module.runner.aws_cloudwatch_log_group.environment[0]","mode":"managed","type":"aws_cloudwatch_log_group","name":"environment","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"kms_key_id":"","name":"default","name_prefix":null,"retention_in_days":0,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.aws_iam_instance_profile.docker_machine[0]","mode":"managed","type":"aws_iam_instance_profile","name":"docker_machine","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"default-docker-machine","name_prefix":null,"path":"/","role":"default-docker-machine","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.aws_iam_instance_profile.instance[0]","mode":"managed","type":"aws_iam_instance_profile","name":"instance","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"default-instance","name_prefix":null,"path":"/","role":"default-instance","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.aws_iam_policy.instance_docker_machine_policy[0]","mode":"managed","type":"aws_iam_policy","name":"instance_docker_machine_policy","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Policy for docker machine.","name":"default-docker-machine","name_prefix":null,"path":"/","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.aws_iam_policy.instance_session_manager_policy[0]","mode":"managed","type":"aws_iam_policy","name":"instance_session_manager_policy","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Policy session manager.","name":"default-session-manager","name_prefix":null,"path":"/","policy":"{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ssmmessages:CreateControlChannel\",\n                \"ssmmessages:CreateDataChannel\",\n                \"ssmmessages:OpenControlChannel\",\n                \"ssmmessages:OpenDataChannel\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.aws_iam_policy.service_linked_role[0]","mode":"managed","type":"aws_iam_policy","name":"service_linked_role","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Policy for creation of service linked roles.","name":"default-service_linked_role","name_prefix":null,"path":"/","policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/*\"\n    }\n  ]\n}\n","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.aws_iam_policy.ssm[0]","mode":"managed","type":"aws_iam_policy","name":"ssm","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Policy for runner token param access via SSM","name":"default-ssm","name_prefix":null,"path":"/","policy":"{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ssm:PutParameter\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ssm:GetParameters\"\n            ],\n            \"Resource\": \"arn:aws:ssm:*\"\n        }\n    ]\n}\n","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.aws_iam_role.docker_machine[0]","mode":"managed","type":"aws_iam_role","name":"docker_machine","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"default-docker-machine","path":"/","permissions_boundary":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}},{"address":"module.runner.aws_iam_role.instance[0]","mode":"managed","type":"aws_iam_role","name":"instance","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"default-instance","path":"/","permissions_boundary":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}},{"address":"module.runner.aws_iam_role_policy.instance[0]","mode":"managed","type":"aws_iam_role_policy","name":"instance","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"default-logging","name_prefix":null,"policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"allowLoggingToCloudWatch\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogStreams\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:*\"\n      ]\n    }\n  ]\n}\n","role":"default-instance"},"sensitive_values":{}},{"address":"module.runner.aws_iam_role_policy_attachment.docker_machine_cache_instance[0]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"docker_machine_cache_instance","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"default-instance"},"sensitive_values":{}},{"address":"module.runner.aws_iam_role_policy_attachment.instance_docker_machine_policy[0]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"instance_docker_machine_policy","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"default-instance"},"sensitive_values":{}},{"address":"module.runner.aws_iam_role_policy_attachment.instance_session_manager_aws_managed[0]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"instance_session_manager_aws_managed","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore","role":"default-instance"},"sensitive_values":{}},{"address":"module.runner.aws_iam_role_policy_attachment.instance_session_manager_policy[0]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"instance_session_manager_policy","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"default-instance"},"sensitive_values":{}},{"address":"module.runner.aws_iam_role_policy_attachment.service_linked_role[0]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"service_linked_role","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"default-instance"},"sensitive_values":{}},{"address":"module.runner.aws_iam_role_policy_attachment.ssm[0]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ssm","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"default-instance"},"sensitive_values":{}},{"address":"module.runner.aws_launch_template.gitlab_runner_instance","mode":"managed","type":"aws_launch_template","name":"gitlab_runner_instance","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_device_mappings":[{"device_name":"/dev/xvda","ebs":[{"delete_on_termination":"true","encrypted":"true","kms_key_id":null,"snapshot_id":null,"volume_size":8,"volume_type":"gp3"}],"no_device":null,"virtual_name":null}],"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"description":null,"disable_api_termination":null,"ebs_optimized":"true","elastic_gpu_specifications":[],"elastic_inference_accelerator":[],"enclave_options":[],"hibernation_options":[],"iam_instance_profile":[{"arn":null,"name":"default-instance"}],"image_id":"ami-0d3fb251d83530a2e","instance_initiated_shutdown_behavior":null,"instance_market_options":[],"instance_type":"t3.micro","kernel_id":null,"key_name":null,"license_specification":[],"metadata_options":[{"http_endpoint":"enabled","http_protocol_ipv6":"disabled","http_put_response_hop_limit":2,"http_tokens":"required","instance_metadata_tags":"disabled"}],"monitoring":[{"enabled":true}],"name_prefix":"default","network_interfaces":[{"associate_carrier_ip_address":null,"associate_public_ip_address":"false","delete_on_termination":null,"description":null,"device_index":null,"interface_type":null,"ipv4_address_count":null,"ipv4_addresses":null,"ipv4_prefix_count":null,"ipv4_prefixes":null,"ipv6_address_count":null,"ipv6_addresses":null,"ipv6_prefix_count":null,"ipv6_prefixes":null,"network_card_index":null,"network_interface_id":null,"private_ip_address":null,"subnet_id":null}],"placement":[],"private_dns_name_options":[],"ram_disk_id":null,"security_group_names":null,"tag_specifications":[{"resource_type":"instance","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},{"resource_type":"volume","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}}],"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"update_default_version":true,"vpc_security_group_ids":null},"sensitive_values":{"block_device_mappings":[{"ebs":[{}]}],"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"elastic_gpu_specifications":[],"elastic_inference_accelerator":[],"enclave_options":[],"hibernation_options":[],"iam_instance_profile":[{}],"instance_market_options":[],"license_specification":[],"metadata_options":[{}],"monitoring":[{}],"network_interfaces":[{"security_groups":[]}],"placement":[],"private_dns_name_options":[],"tag_specifications":[{"tags":{}},{"tags":{}}],"tags":{},"tags_all":{}}},{"address":"module.runner.aws_security_group.docker_machine[0]","mode":"managed","type":"aws_security_group","name":"docker_machine","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"A security group containing docker-machine instances","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"Allow all egress traffic for docker machine build runners","from_port":0,"ipv6_cidr_blocks":["::/0"],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"name_prefix":"default-docker-machine","revoke_rules_on_delete":false,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"timeouts":null},"sensitive_values":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]}],"ingress":[],"tags":{},"tags_all":{}}},{"address":"module.runner.aws_security_group.runner","mode":"managed","type":"aws_security_group","name":"runner","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"A security group containing gitlab-runner agent instances","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":["::/0"],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"name_prefix":"default","revoke_rules_on_delete":false,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"timeouts":null},"sensitive_values":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]}],"ingress":[],"tags":{},"tags_all":{}}},{"address":"module.runner.aws_security_group_rule.docker_machine_docker_runner[0]","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_docker_runner","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"from_port":2376,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","self":false,"to_port":2376,"type":"ingress"},"sensitive_values":{}},{"address":"module.runner.aws_security_group_rule.docker_machine_docker_self[0]","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_docker_self","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"from_port":2376,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","self":true,"to_port":2376,"type":"ingress"},"sensitive_values":{}},{"address":"module.runner.aws_security_group_rule.docker_machine_ssh_runner[0]","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_ssh_runner","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"from_port":22,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","self":false,"to_port":22,"type":"ingress"},"sensitive_values":{}},{"address":"module.runner.aws_security_group_rule.docker_machine_ssh_self[0]","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_ssh_self","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"from_port":22,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","self":true,"to_port":22,"type":"ingress"},"sensitive_values":{}},{"address":"module.runner.aws_ssm_parameter.runner_registration_token","mode":"managed","type":"aws_ssm_parameter","name":"runner_registration_token","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"allowed_pattern":null,"description":null,"name":"default-runner-token","overwrite":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tier":"Standard","type":"SecureString","value":"null"},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.aws_ssm_parameter.runner_sentry_dsn","mode":"managed","type":"aws_ssm_parameter","name":"runner_sentry_dsn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"allowed_pattern":null,"description":null,"name":"default-sentry-dsn","overwrite":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tier":"Standard","type":"SecureString","value":"null"},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.data.aws_availability_zone.runners","mode":"data","type":"aws_availability_zone","name":"runners","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"all_availability_zones":null,"filter":[]},"sensitive_values":{"filter":[]}},{"address":"module.runner.data.aws_subnet.runners","mode":"data","type":"aws_subnet","name":"runners","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"filter":[]},"sensitive_values":{"filter":[],"tags":{}}}],"address":"module.runner","child_modules":[{"resources":[{"address":"module.runner.module.terminate_agent_hook.aws_autoscaling_lifecycle_hook.terminate_instances","mode":"managed","type":"aws_autoscaling_lifecycle_hook","name":"terminate_instances","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"default_result":"CONTINUE","heartbeat_timeout":50,"lifecycle_transition":"autoscaling:EC2_INSTANCE_TERMINATING","name":"default-terminate-instances","notification_metadata":null,"notification_target_arn":null,"role_arn":null},"sensitive_values":{}},{"address":"module.runner.module.terminate_agent_hook.aws_cloudwatch_event_rule.terminate_instances","mode":"managed","type":"aws_cloudwatch_event_rule","name":"terminate_instances","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Trigger GitLab runner instance lifecycle hook on termination.","event_bus_name":"default","is_enabled":true,"name":"default-terminate-instances","role_arn":null,"schedule_expression":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.module.terminate_agent_hook.aws_cloudwatch_event_target.terminate_instances","mode":"managed","type":"aws_cloudwatch_event_target","name":"terminate_instances","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"input":null,"input_path":null,"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"role_arn":null,"rule":"default-terminate-instances","run_command_targets":[],"sqs_target":[],"target_id":"default-TriggerTerminateLambda"},"sensitive_values":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"run_command_targets":[],"sqs_target":[]}},{"address":"module.runner.module.terminate_agent_hook.aws_cloudwatch_log_group.lambda","mode":"managed","type":"aws_cloudwatch_log_group","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"kms_key_id":"","name":"/aws/lambda/default-terminate-instances","name_prefix":null,"retention_in_days":0,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.module.terminate_agent_hook.aws_iam_policy.lambda","mode":"managed","type":"aws_iam_policy","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"name":"default-terminate-instances","name_prefix":null,"path":"/","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.module.terminate_agent_hook.aws_iam_role.lambda","mode":"managed","type":"aws_iam_role","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}","description":"Role for executing the terminate-instances instance termination function","force_detach_policies":true,"max_session_duration":3600,"name":"default-terminate-instances","path":"/","permissions_boundary":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}},{"address":"module.runner.module.terminate_agent_hook.aws_iam_role_policy_attachment.lambda","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"default-terminate-instances"},"sensitive_values":{}},{"address":"module.runner.module.terminate_agent_hook.aws_lambda_function.terminate_runner_instances","mode":"managed","type":"aws_lambda_function","name":"terminate_runner_instances","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"architectures":["x86_64"],"code_signing_config_arn":null,"dead_letter_config":[],"description":"Lifecycle hook for terminating GitLab runner agent instances","environment":[],"file_system_config":[],"filename":"builds/lambda_function_037173b002bc0421d8c11a9afce8c2cf4bb065a2a3dada7096305b404a156542.zip","function_name":"default-terminate-instances","handler":"lambda_function.handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":true,"reserved_concurrent_executions":-1,"runtime":"python3.8","s3_bucket":null,"s3_key":null,"s3_object_version":null,"source_code_hash":"eeC7Wx01Z5w7ek/MJJxqpXjnqKC+vOQLnyol0EiWcIA=","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"timeout":30,"timeouts":null,"vpc_config":[]},"sensitive_values":{"architectures":[false],"dead_letter_config":[],"environment":[],"file_system_config":[],"image_config":[],"tags":{},"tags_all":{},"tracing_config":[],"vpc_config":[]}},{"address":"module.runner.module.terminate_agent_hook.aws_lambda_permission.current_version_triggers","mode":"managed","type":"aws_lambda_permission","name":"current_version_triggers","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"default-terminate-instances","principal":"events.amazonaws.com","source_account":null,"statement_id":"TerminateInstanceEvent","statement_id_prefix":null},"sensitive_values":{}},{"address":"module.runner.module.terminate_agent_hook.aws_lambda_permission.unqualified_alias_triggers","mode":"managed","type":"aws_lambda_permission","name":"unqualified_alias_triggers","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"default-terminate-instances","principal":"events.amazonaws.com","qualifier":null,"source_account":null,"statement_id":"TerminateInstanceEventUnqualified","statement_id_prefix":null},"sensitive_values":{}},{"address":"module.runner.module.terminate_agent_hook.data.aws_iam_policy_document.lambda","mode":"data","type":"aws_iam_policy_document","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["ec2:DescribeInstanceStatus","ec2:DescribeInstances","ec2:DescribeRegions","ec2:DescribeTags"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":["*"],"sid":"GitLabRunnerLifecycleGetInstances"},{"actions":["ec2:TerminateInstances"],"condition":[{"test":"StringLike","values":["i-*"],"variable":"ec2:ResourceTag/gitlab-runner-parent-id"}],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":["arn:aws:ec2:eu-central-1:990563477234:instance/*"],"sid":"GitLabRunnerLifecycleTerminateInstances"},{"actions":["autoscaling:CompleteLifecycleAction"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"GitLabRunnerLifecycleTerminateEvent"},{"actions":["logs:CreateLogStream","logs:PutLogEvents"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null,null],"sid":"GitLabRunnerLifecycleTerminateLogs"}],"version":null},"sensitive_values":{"statement":[{"actions":[false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false,false]}]}}],"address":"module.runner.module.terminate_agent_hook"},{"resources":[{"address":"module.runner.module.cache[0].aws_iam_policy.docker_machine_cache","mode":"managed","type":"aws_iam_policy","name":"docker_machine_cache","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Policy for docker machine instance to access cache","name":"default-docker-machine-cache","name_prefix":null,"path":"/","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.runner.module.cache[0].aws_s3_bucket.build_cache","mode":"managed","type":"aws_s3_bucket","name":"build_cache","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"default-990563477234-gitlab-runner-cache","bucket_prefix":null,"force_destroy":true,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}},{"address":"module.runner.module.cache[0].aws_s3_bucket_acl.build_cache_acl","mode":"managed","type":"aws_s3_bucket_acl","name":"build_cache_acl","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"acl":"private","expected_bucket_owner":null},"sensitive_values":{"access_control_policy":[]}},{"address":"module.runner.module.cache[0].aws_s3_bucket_lifecycle_configuration.build_cache_versioning","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"build_cache_versioning","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[{"date":null,"days":1}],"filter":[{"and":[],"object_size_greater_than":null,"object_size_less_than":null,"prefix":"runner/","tag":[]}],"id":"clear","noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"status":"Enabled","transition":[]}]},"sensitive_values":{"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[{}],"filter":[{"and":[],"tag":[]}],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[]}]}},{"address":"module.runner.module.cache[0].aws_s3_bucket_public_access_block.build_cache_policy","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"build_cache_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"sensitive_values":{}},{"address":"module.runner.module.cache[0].aws_s3_bucket_server_side_encryption_configuration.build_cache_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"build_cache_encryption","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"aws:kms"}],"bucket_key_enabled":true}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}},{"address":"module.runner.module.cache[0].aws_s3_bucket_versioning.build_cache_versioning","mode":"managed","type":"aws_s3_bucket_versioning","name":"build_cache_versioning","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"mfa":null,"versioning_configuration":[{"status":"Suspended"}]},"sensitive_values":{"versioning_configuration":[{}]}}],"address":"module.runner.module.cache[0]"}]},{"resources":[{"address":"module.vpc.aws_eip.nat[0]","mode":"managed","type":"aws_eip","name":"nat","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"address":null,"associate_with_private_ip":null,"customer_owned_ipv4_pool":null,"tags":{"Environment":"setup","Name":"vpc-ut-default-eu-central-1a"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-eu-central-1a"},"timeouts":null,"vpc":true},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.vpc.aws_internet_gateway.this[0]","mode":"managed","type":"aws_internet_gateway","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"tags":{"Environment":"setup","Name":"vpc-ut-default"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.vpc.aws_nat_gateway.this[0]","mode":"managed","type":"aws_nat_gateway","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"connectivity_type":"public","tags":{"Environment":"setup","Name":"vpc-ut-default-eu-central-1a"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-eu-central-1a"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.vpc.aws_route.private_nat_gateway[0]","mode":"managed","type":"aws_route","name":"private_nat_gateway","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"carrier_gateway_id":null,"destination_cidr_block":"0.0.0.0/0","destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"egress_only_gateway_id":null,"gateway_id":null,"local_gateway_id":null,"timeouts":{"create":"5m","delete":null,"update":null},"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null},"sensitive_values":{"timeouts":{}}},{"address":"module.vpc.aws_route.public_internet_gateway[0]","mode":"managed","type":"aws_route","name":"public_internet_gateway","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"carrier_gateway_id":null,"destination_cidr_block":"0.0.0.0/0","destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"egress_only_gateway_id":null,"local_gateway_id":null,"nat_gateway_id":null,"timeouts":{"create":"5m","delete":null,"update":null},"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null},"sensitive_values":{"timeouts":{}}},{"address":"module.vpc.aws_route_table.private[0]","mode":"managed","type":"aws_route_table","name":"private","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"tags":{"Environment":"setup","Name":"vpc-ut-default-private"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-private"},"timeouts":null},"sensitive_values":{"propagating_vgws":[],"route":[],"tags":{},"tags_all":{}}},{"address":"module.vpc.aws_route_table.public[0]","mode":"managed","type":"aws_route_table","name":"public","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"tags":{"Environment":"setup","Name":"vpc-ut-default-public"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-public"},"timeouts":null},"sensitive_values":{"propagating_vgws":[],"route":[],"tags":{},"tags_all":{}}},{"address":"module.vpc.aws_route_table_association.private[0]","mode":"managed","type":"aws_route_table_association","name":"private","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null},"sensitive_values":{}},{"address":"module.vpc.aws_route_table_association.public[0]","mode":"managed","type":"aws_route_table_association","name":"public","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null},"sensitive_values":{}},{"address":"module.vpc.aws_subnet.private[0]","mode":"managed","type":"aws_subnet","name":"private","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"eu-central-1a","cidr_block":"10.0.1.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Environment":"setup","Name":"vpc-ut-default-private-eu-central-1a"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-private-eu-central-1a"},"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.vpc.aws_subnet.public[0]","mode":"managed","type":"aws_subnet","name":"public","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"eu-central-1a","cidr_block":"10.0.101.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":true,"outpost_arn":null,"tags":{"Environment":"setup","Name":"vpc-ut-default-public-eu-central-1a"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-public-eu-central-1a"},"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.vpc.aws_vpc.this[0]","mode":"managed","type":"aws_vpc","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_generated_ipv6_cidr_block":null,"cidr_block":"10.0.0.0/16","enable_dns_hostnames":false,"enable_dns_support":true,"instance_tenancy":"default","ipv4_ipam_pool_id":null,"ipv4_netmask_length":null,"ipv6_ipam_pool_id":null,"ipv6_netmask_length":null,"tags":{"Environment":"setup","Name":"vpc-ut-default"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default"}},"sensitive_values":{"tags":{},"tags_all":{}}}],"address":"module.vpc"},{"resources":[{"address":"module.vpc_endpoints.aws_vpc_endpoint.this[\"s3\"]","mode":"managed","type":"aws_vpc_endpoint","name":"this","index":"s3","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"auto_accept":null,"private_dns_enabled":false,"service_name":"com.amazonaws.eu-central-1.s3","tags":{"Environment":"setup","Name":"s3-vpc-endpoint"},"tags_all":{"Environment":"setup","Name":"s3-vpc-endpoint"},"timeouts":{"create":"10m","delete":"10m","update":"10m"},"vpc_endpoint_type":"Interface"},"sensitive_values":{"cidr_blocks":[],"dns_entry":[],"network_interface_ids":[],"route_table_ids":[],"security_group_ids":[],"subnet_ids":[],"tags":{},"tags_all":{},"timeouts":{}}}],"address":"module.vpc_endpoints"}]}},"resource_changes":[{"address":"data.aws_security_group.default","mode":"data","type":"aws_security_group","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"filter":[],"name":"default"},"after_unknown":{"arn":true,"description":true,"filter":[],"id":true,"tags":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"filter":[],"tags":{}}},"action_reason":"read_because_config_unknown"},{"address":"module.runner.aws_autoscaling_group.gitlab_runner_instance","module_address":"module.runner","mode":"managed","type":"aws_autoscaling_group","name":"gitlab_runner_instance","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"capacity_rebalance":null,"desired_capacity":1,"enabled_metrics":["GroupDesiredCapacity","GroupInServiceCapacity"],"force_delete":false,"force_delete_warm_pool":false,"health_check_grace_period":0,"initial_lifecycle_hook":[],"instance_refresh":[{"preferences":[{"checkpoint_delay":null,"checkpoint_percentages":null,"instance_warmup":null,"min_healthy_percentage":0}],"strategy":"Rolling","triggers":["tag"]}],"launch_configuration":null,"launch_template":[{}],"load_balancers":null,"max_instance_lifetime":null,"max_size":1,"metrics_granularity":"1Minute","min_elb_capacity":null,"min_size":1,"mixed_instances_policy":[],"placement_group":null,"protect_from_scale_in":false,"suspended_processes":null,"tag":[{"key":"Environment","propagate_at_launch":true,"value":"default"},{"key":"Name","propagate_at_launch":true,"value":"default"},{"key":"tf-aws-gitlab-runner:example","propagate_at_launch":true,"value":"runner-default"},{"key":"tf-aws-gitlab-runner:instancelifecycle","propagate_at_launch":true,"value":"spot:yes"}],"tags":null,"target_group_arns":null,"termination_policies":null,"timeouts":{"delete":"10m"},"wait_for_capacity_timeout":"10m","wait_for_elb_capacity":null,"warm_pool":[]},"after_unknown":{"arn":true,"availability_zones":true,"default_cooldown":true,"enabled_metrics":[false,false],"health_check_type":true,"id":true,"initial_lifecycle_hook":[],"instance_refresh":[{"preferences":[{}],"triggers":[false]}],"launch_template":[{"id":true,"name":true,"version":true}],"mixed_instances_policy":[],"name":true,"name_prefix":true,"service_linked_role_arn":true,"tag":[{},{},{},{}],"timeouts":{},"vpc_zone_identifier":true,"warm_pool":[]},"before_sensitive":false,"after_sensitive":{"availability_zones":[],"enabled_metrics":[false,false],"initial_lifecycle_hook":[],"instance_refresh":[{"preferences":[{}],"triggers":[false]}],"launch_template":[{}],"mixed_instances_policy":[],"tag":[{},{},{},{}],"timeouts":{},"vpc_zone_identifier":[],"warm_pool":[]}}},{"address":"module.runner.aws_cloudwatch_log_group.environment[0]","module_address":"module.runner","mode":"managed","type":"aws_cloudwatch_log_group","name":"environment","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"kms_key_id":"","name":"default","name_prefix":null,"retention_in_days":0,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_iam_instance_profile.docker_machine[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_instance_profile","name":"docker_machine","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"default-docker-machine","name_prefix":null,"path":"/","role":"default-docker-machine","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_iam_instance_profile.instance[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_instance_profile","name":"instance","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"default-instance","name_prefix":null,"path":"/","role":"default-instance","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_iam_policy.instance_docker_machine_policy[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_policy","name":"instance_docker_machine_policy","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Policy for docker machine.","name":"default-docker-machine","name_prefix":null,"path":"/","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"id":true,"policy":true,"policy_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_iam_policy.instance_session_manager_policy[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_policy","name":"instance_session_manager_policy","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Policy session manager.","name":"default-session-manager","name_prefix":null,"path":"/","policy":"{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ssmmessages:CreateControlChannel\",\n                \"ssmmessages:CreateDataChannel\",\n                \"ssmmessages:OpenControlChannel\",\n                \"ssmmessages:OpenDataChannel\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"id":true,"policy_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_iam_policy.service_linked_role[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_policy","name":"service_linked_role","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Policy for creation of service linked roles.","name":"default-service_linked_role","name_prefix":null,"path":"/","policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/*\"\n    }\n  ]\n}\n","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"id":true,"policy_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_iam_policy.ssm[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_policy","name":"ssm","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Policy for runner token param access via SSM","name":"default-ssm","name_prefix":null,"path":"/","policy":"{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ssm:PutParameter\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ssm:GetParameters\"\n            ],\n            \"Resource\": \"arn:aws:ssm:*\"\n        }\n    ]\n}\n","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"id":true,"policy_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_iam_role.docker_machine[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_role","name":"docker_machine","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"default-docker-machine","path":"/","permissions_boundary":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_iam_role.instance[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_role","name":"instance","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"default-instance","path":"/","permissions_boundary":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_iam_role_policy.instance[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_role_policy","name":"instance","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"default-logging","name_prefix":null,"policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"allowLoggingToCloudWatch\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogStreams\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:*\"\n      ]\n    }\n  ]\n}\n","role":"default-instance"},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.aws_iam_role_policy_attachment.docker_machine_cache_instance[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_role_policy_attachment","name":"docker_machine_cache_instance","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"default-instance"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.aws_iam_role_policy_attachment.instance_docker_machine_policy[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_role_policy_attachment","name":"instance_docker_machine_policy","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"default-instance"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.aws_iam_role_policy_attachment.instance_session_manager_aws_managed[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_role_policy_attachment","name":"instance_session_manager_aws_managed","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore","role":"default-instance"},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.aws_iam_role_policy_attachment.instance_session_manager_policy[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_role_policy_attachment","name":"instance_session_manager_policy","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"default-instance"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.aws_iam_role_policy_attachment.service_linked_role[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_role_policy_attachment","name":"service_linked_role","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"default-instance"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.aws_iam_role_policy_attachment.ssm[0]","module_address":"module.runner","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ssm","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"default-instance"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.aws_launch_template.gitlab_runner_instance","module_address":"module.runner","mode":"managed","type":"aws_launch_template","name":"gitlab_runner_instance","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_device_mappings":[{"device_name":"/dev/xvda","ebs":[{"delete_on_termination":"true","encrypted":"true","kms_key_id":null,"snapshot_id":null,"volume_size":8,"volume_type":"gp3"}],"no_device":null,"virtual_name":null}],"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"description":null,"disable_api_termination":null,"ebs_optimized":"true","elastic_gpu_specifications":[],"elastic_inference_accelerator":[],"enclave_options":[],"hibernation_options":[],"iam_instance_profile":[{"arn":null,"name":"default-instance"}],"image_id":"ami-0d3fb251d83530a2e","instance_initiated_shutdown_behavior":null,"instance_market_options":[],"instance_type":"t3.micro","kernel_id":null,"key_name":null,"license_specification":[],"metadata_options":[{"http_endpoint":"enabled","http_protocol_ipv6":"disabled","http_put_response_hop_limit":2,"http_tokens":"required","instance_metadata_tags":"disabled"}],"monitoring":[{"enabled":true}],"name_prefix":"default","network_interfaces":[{"associate_carrier_ip_address":null,"associate_public_ip_address":"false","delete_on_termination":null,"description":null,"device_index":null,"interface_type":null,"ipv4_address_count":null,"ipv4_addresses":null,"ipv4_prefix_count":null,"ipv4_prefixes":null,"ipv6_address_count":null,"ipv6_addresses":null,"ipv6_prefix_count":null,"ipv6_prefixes":null,"network_card_index":null,"network_interface_id":null,"private_ip_address":null,"subnet_id":null}],"placement":[],"private_dns_name_options":[],"ram_disk_id":null,"security_group_names":null,"tag_specifications":[{"resource_type":"instance","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},{"resource_type":"volume","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}}],"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"update_default_version":true,"vpc_security_group_ids":null},"after_unknown":{"arn":true,"block_device_mappings":[{"ebs":[{"iops":true,"throughput":true}]}],"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"default_version":true,"elastic_gpu_specifications":[],"elastic_inference_accelerator":[],"enclave_options":[],"hibernation_options":[],"iam_instance_profile":[{}],"id":true,"instance_market_options":[],"latest_version":true,"license_specification":[],"metadata_options":[{}],"monitoring":[{}],"name":true,"network_interfaces":[{"security_groups":true}],"placement":[],"private_dns_name_options":[],"tag_specifications":[{"tags":{}},{"tags":{}}],"tags":{},"tags_all":{},"user_data":true},"before_sensitive":false,"after_sensitive":{"block_device_mappings":[{"ebs":[{}]}],"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"elastic_gpu_specifications":[],"elastic_inference_accelerator":[],"enclave_options":[],"hibernation_options":[],"iam_instance_profile":[{}],"instance_market_options":[],"license_specification":[],"metadata_options":[{}],"monitoring":[{}],"network_interfaces":[{"security_groups":[]}],"placement":[],"private_dns_name_options":[],"tag_specifications":[{"tags":{}},{"tags":{}}],"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_security_group.docker_machine[0]","module_address":"module.runner","mode":"managed","type":"aws_security_group","name":"docker_machine","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"A security group containing docker-machine instances","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"Allow all egress traffic for docker machine build runners","from_port":0,"ipv6_cidr_blocks":["::/0"],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"name_prefix":"default-docker-machine","revoke_rules_on_delete":false,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"timeouts":null},"after_unknown":{"arn":true,"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]}],"id":true,"ingress":true,"name":true,"owner_id":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]}],"ingress":[],"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_security_group.runner","module_address":"module.runner","mode":"managed","type":"aws_security_group","name":"runner","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"A security group containing gitlab-runner agent instances","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":["::/0"],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"name_prefix":"default","revoke_rules_on_delete":false,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"timeouts":null},"after_unknown":{"arn":true,"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]}],"id":true,"ingress":true,"name":true,"owner_id":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]}],"ingress":[],"tags":{},"tags_all":{}}}},{"address":"module.runner.aws_security_group_rule.docker_machine_docker_runner[0]","module_address":"module.runner","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_docker_runner","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"from_port":2376,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","self":false,"to_port":2376,"type":"ingress"},"after_unknown":{"description":true,"id":true,"security_group_id":true,"source_security_group_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.aws_security_group_rule.docker_machine_docker_self[0]","module_address":"module.runner","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_docker_self","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"from_port":2376,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","self":true,"to_port":2376,"type":"ingress"},"after_unknown":{"description":true,"id":true,"security_group_id":true,"source_security_group_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.aws_security_group_rule.docker_machine_ssh_runner[0]","module_address":"module.runner","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_ssh_runner","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"from_port":22,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","self":false,"to_port":22,"type":"ingress"},"after_unknown":{"description":true,"id":true,"security_group_id":true,"source_security_group_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.aws_security_group_rule.docker_machine_ssh_self[0]","module_address":"module.runner","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_ssh_self","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"from_port":22,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","self":true,"to_port":22,"type":"ingress"},"after_unknown":{"description":true,"id":true,"security_group_id":true,"source_security_group_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.aws_ssm_parameter.runner_registration_token","module_address":"module.runner","mode":"managed","type":"aws_ssm_parameter","name":"runner_registration_token","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allowed_pattern":null,"description":null,"name":"default-runner-token","overwrite":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tier":"Standard","type":"SecureString","value":"null"},"after_unknown":{"arn":true,"data_type":true,"id":true,"key_id":true,"tags":{},"tags_all":{},"version":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{},"value":true}}},{"address":"module.runner.aws_ssm_parameter.runner_sentry_dsn","module_address":"module.runner","mode":"managed","type":"aws_ssm_parameter","name":"runner_sentry_dsn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allowed_pattern":null,"description":null,"name":"default-sentry-dsn","overwrite":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tier":"Standard","type":"SecureString","value":"null"},"after_unknown":{"arn":true,"data_type":true,"id":true,"key_id":true,"tags":{},"tags_all":{},"version":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{},"value":true}}},{"address":"module.runner.data.aws_availability_zone.runners","module_address":"module.runner","mode":"data","type":"aws_availability_zone","name":"runners","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"all_availability_zones":null,"filter":[]},"after_unknown":{"filter":[],"group_name":true,"id":true,"name":true,"name_suffix":true,"network_border_group":true,"opt_in_status":true,"parent_zone_id":true,"parent_zone_name":true,"region":true,"state":true,"zone_id":true,"zone_type":true},"before_sensitive":false,"after_sensitive":{"filter":[]}},"action_reason":"read_because_config_unknown"},{"address":"module.runner.data.aws_subnet.runners","module_address":"module.runner","mode":"data","type":"aws_subnet","name":"runners","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"filter":[]},"after_unknown":{"arn":true,"assign_ipv6_address_on_creation":true,"availability_zone":true,"availability_zone_id":true,"available_ip_address_count":true,"cidr_block":true,"customer_owned_ipv4_pool":true,"default_for_az":true,"enable_dns64":true,"enable_resource_name_dns_a_record_on_launch":true,"enable_resource_name_dns_aaaa_record_on_launch":true,"filter":[],"id":true,"ipv6_cidr_block":true,"ipv6_cidr_block_association_id":true,"ipv6_native":true,"map_customer_owned_ip_on_launch":true,"map_public_ip_on_launch":true,"outpost_arn":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"state":true,"tags":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"filter":[],"tags":{}}},"action_reason":"read_because_config_unknown"},{"address":"module.runner.module.cache[0].aws_iam_policy.docker_machine_cache","module_address":"module.runner.module.cache[0]","mode":"managed","type":"aws_iam_policy","name":"docker_machine_cache","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Policy for docker machine instance to access cache","name":"default-docker-machine-cache","name_prefix":null,"path":"/","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"id":true,"policy":true,"policy_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.runner.module.cache[0].aws_s3_bucket.build_cache","module_address":"module.runner.module.cache[0]","mode":"managed","type":"aws_s3_bucket","name":"build_cache","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"default-990563477234-gitlab-runner-cache","bucket_prefix":null,"force_destroy":true,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"region":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags":{},"tags_all":{},"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}}},{"address":"module.runner.module.cache[0].aws_s3_bucket_acl.build_cache_acl","module_address":"module.runner.module.cache[0]","mode":"managed","type":"aws_s3_bucket_acl","name":"build_cache_acl","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"acl":"private","expected_bucket_owner":null},"after_unknown":{"access_control_policy":true,"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{"access_control_policy":[]}}},{"address":"module.runner.module.cache[0].aws_s3_bucket_lifecycle_configuration.build_cache_versioning","module_address":"module.runner.module.cache[0]","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"build_cache_versioning","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[{"date":null,"days":1}],"filter":[{"and":[],"object_size_greater_than":null,"object_size_less_than":null,"prefix":"runner/","tag":[]}],"id":"clear","noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"status":"Enabled","transition":[]}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[{"expired_object_delete_marker":true}],"filter":[{"and":[],"tag":[]}],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[{}],"filter":[{"and":[],"tag":[]}],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[]}]}}},{"address":"module.runner.module.cache[0].aws_s3_bucket_public_access_block.build_cache_policy","module_address":"module.runner.module.cache[0]","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"build_cache_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.module.cache[0].aws_s3_bucket_server_side_encryption_configuration.build_cache_encryption","module_address":"module.runner.module.cache[0]","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"build_cache_encryption","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"","sse_algorithm":"aws:kms"}],"bucket_key_enabled":true}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{}]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}}},{"address":"module.runner.module.cache[0].aws_s3_bucket_versioning.build_cache_versioning","module_address":"module.runner.module.cache[0]","mode":"managed","type":"aws_s3_bucket_versioning","name":"build_cache_versioning","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"mfa":null,"versioning_configuration":[{"status":"Suspended"}]},"after_unknown":{"bucket":true,"id":true,"versioning_configuration":[{"mfa_delete":true}]},"before_sensitive":false,"after_sensitive":{"versioning_configuration":[{}]}}},{"address":"module.runner.module.terminate_agent_hook.aws_autoscaling_lifecycle_hook.terminate_instances","module_address":"module.runner.module.terminate_agent_hook","mode":"managed","type":"aws_autoscaling_lifecycle_hook","name":"terminate_instances","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"default_result":"CONTINUE","heartbeat_timeout":50,"lifecycle_transition":"autoscaling:EC2_INSTANCE_TERMINATING","name":"default-terminate-instances","notification_metadata":null,"notification_target_arn":null,"role_arn":null},"after_unknown":{"autoscaling_group_name":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.module.terminate_agent_hook.aws_cloudwatch_event_rule.terminate_instances","module_address":"module.runner.module.terminate_agent_hook","mode":"managed","type":"aws_cloudwatch_event_rule","name":"terminate_instances","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Trigger GitLab runner instance lifecycle hook on termination.","event_bus_name":"default","is_enabled":true,"name":"default-terminate-instances","role_arn":null,"schedule_expression":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"event_pattern":true,"id":true,"name_prefix":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.runner.module.terminate_agent_hook.aws_cloudwatch_event_target.terminate_instances","module_address":"module.runner.module.terminate_agent_hook","mode":"managed","type":"aws_cloudwatch_event_target","name":"terminate_instances","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"event_bus_name":"default","http_target":[],"input":null,"input_path":null,"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"role_arn":null,"rule":"default-terminate-instances","run_command_targets":[],"sqs_target":[],"target_id":"default-TriggerTerminateLambda"},"after_unknown":{"arn":true,"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"id":true,"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"run_command_targets":[],"sqs_target":[]},"before_sensitive":false,"after_sensitive":{"batch_target":[],"dead_letter_config":[],"ecs_target":[],"http_target":[],"input_transformer":[],"kinesis_target":[],"redshift_target":[],"retry_policy":[],"run_command_targets":[],"sqs_target":[]}}},{"address":"module.runner.module.terminate_agent_hook.aws_cloudwatch_log_group.lambda","module_address":"module.runner.module.terminate_agent_hook","mode":"managed","type":"aws_cloudwatch_log_group","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"kms_key_id":"","name":"/aws/lambda/default-terminate-instances","name_prefix":null,"retention_in_days":0,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.runner.module.terminate_agent_hook.aws_iam_policy.lambda","module_address":"module.runner.module.terminate_agent_hook","mode":"managed","type":"aws_iam_policy","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"name":"default-terminate-instances","name_prefix":null,"path":"/","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"id":true,"policy":true,"policy_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.runner.module.terminate_agent_hook.aws_iam_role.lambda","module_address":"module.runner.module.terminate_agent_hook","mode":"managed","type":"aws_iam_role","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}","description":"Role for executing the terminate-instances instance termination function","force_detach_policies":true,"max_session_duration":3600,"name":"default-terminate-instances","path":"/","permissions_boundary":null,"tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}}},{"address":"module.runner.module.terminate_agent_hook.aws_iam_role_policy_attachment.lambda","module_address":"module.runner.module.terminate_agent_hook","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"default-terminate-instances"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.module.terminate_agent_hook.aws_lambda_function.terminate_runner_instances","module_address":"module.runner.module.terminate_agent_hook","mode":"managed","type":"aws_lambda_function","name":"terminate_runner_instances","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"architectures":["x86_64"],"code_signing_config_arn":null,"dead_letter_config":[],"description":"Lifecycle hook for terminating GitLab runner agent instances","environment":[],"file_system_config":[],"filename":"builds/lambda_function_037173b002bc0421d8c11a9afce8c2cf4bb065a2a3dada7096305b404a156542.zip","function_name":"default-terminate-instances","handler":"lambda_function.handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":true,"reserved_concurrent_executions":-1,"runtime":"python3.8","s3_bucket":null,"s3_key":null,"s3_object_version":null,"source_code_hash":"eeC7Wx01Z5w7ek/MJJxqpXjnqKC+vOQLnyol0EiWcIA=","tags":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"tags_all":{"Environment":"default","Name":"default","tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"},"timeout":30,"timeouts":null,"vpc_config":[]},"after_unknown":{"architectures":[false],"arn":true,"dead_letter_config":[],"environment":[],"file_system_config":[],"id":true,"image_config":[],"invoke_arn":true,"last_modified":true,"qualified_arn":true,"role":true,"signing_job_arn":true,"signing_profile_version_arn":true,"source_code_size":true,"tags":{},"tags_all":{},"tracing_config":true,"version":true,"vpc_config":[]},"before_sensitive":false,"after_sensitive":{"architectures":[false],"dead_letter_config":[],"environment":[],"file_system_config":[],"image_config":[],"tags":{},"tags_all":{},"tracing_config":[],"vpc_config":[]}}},{"address":"module.runner.module.terminate_agent_hook.aws_lambda_permission.current_version_triggers","module_address":"module.runner.module.terminate_agent_hook","mode":"managed","type":"aws_lambda_permission","name":"current_version_triggers","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"default-terminate-instances","principal":"events.amazonaws.com","source_account":null,"statement_id":"TerminateInstanceEvent","statement_id_prefix":null},"after_unknown":{"id":true,"qualifier":true,"source_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.module.terminate_agent_hook.aws_lambda_permission.unqualified_alias_triggers","module_address":"module.runner.module.terminate_agent_hook","mode":"managed","type":"aws_lambda_permission","name":"unqualified_alias_triggers","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"default-terminate-instances","principal":"events.amazonaws.com","qualifier":null,"source_account":null,"statement_id":"TerminateInstanceEventUnqualified","statement_id_prefix":null},"after_unknown":{"id":true,"source_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.runner.module.terminate_agent_hook.data.aws_iam_policy_document.lambda","module_address":"module.runner.module.terminate_agent_hook","mode":"data","type":"aws_iam_policy_document","name":"lambda","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["ec2:DescribeInstanceStatus","ec2:DescribeInstances","ec2:DescribeRegions","ec2:DescribeTags"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":["*"],"sid":"GitLabRunnerLifecycleGetInstances"},{"actions":["ec2:TerminateInstances"],"condition":[{"test":"StringLike","values":["i-*"],"variable":"ec2:ResourceTag/gitlab-runner-parent-id"}],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":["arn:aws:ec2:eu-central-1:990563477234:instance/*"],"sid":"GitLabRunnerLifecycleTerminateInstances"},{"actions":["autoscaling:CompleteLifecycleAction"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null],"sid":"GitLabRunnerLifecycleTerminateEvent"},{"actions":["logs:CreateLogStream","logs:PutLogEvents"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":[null,null],"sid":"GitLabRunnerLifecycleTerminateLogs"}],"version":null},"after_unknown":{"id":true,"json":true,"statement":[{"actions":[false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false],"condition":[],"not_principals":[],"principals":[],"resources":[true]},{"actions":[false,false],"condition":[],"not_principals":[],"principals":[],"resources":[true,true]}]},"before_sensitive":false,"after_sensitive":{"statement":[{"actions":[false,false,false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false],"condition":[{"values":[false]}],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false],"condition":[],"not_principals":[],"principals":[],"resources":[false]},{"actions":[false,false],"condition":[],"not_principals":[],"principals":[],"resources":[false,false]}]}},"action_reason":"read_because_config_unknown"},{"address":"module.vpc.aws_eip.nat[0]","module_address":"module.vpc","mode":"managed","type":"aws_eip","name":"nat","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"address":null,"associate_with_private_ip":null,"customer_owned_ipv4_pool":null,"tags":{"Environment":"setup","Name":"vpc-ut-default-eu-central-1a"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-eu-central-1a"},"timeouts":null,"vpc":true},"after_unknown":{"allocation_id":true,"association_id":true,"carrier_ip":true,"customer_owned_ip":true,"domain":true,"id":true,"instance":true,"network_border_group":true,"network_interface":true,"private_dns":true,"private_ip":true,"public_dns":true,"public_ip":true,"public_ipv4_pool":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.vpc.aws_internet_gateway.this[0]","module_address":"module.vpc","mode":"managed","type":"aws_internet_gateway","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"tags":{"Environment":"setup","Name":"vpc-ut-default"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default"}},"after_unknown":{"arn":true,"id":true,"owner_id":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.vpc.aws_nat_gateway.this[0]","module_address":"module.vpc","mode":"managed","type":"aws_nat_gateway","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"connectivity_type":"public","tags":{"Environment":"setup","Name":"vpc-ut-default-eu-central-1a"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-eu-central-1a"}},"after_unknown":{"allocation_id":true,"id":true,"network_interface_id":true,"private_ip":true,"public_ip":true,"subnet_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.vpc.aws_route.private_nat_gateway[0]","module_address":"module.vpc","mode":"managed","type":"aws_route","name":"private_nat_gateway","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"carrier_gateway_id":null,"destination_cidr_block":"0.0.0.0/0","destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"egress_only_gateway_id":null,"gateway_id":null,"local_gateway_id":null,"timeouts":{"create":"5m","delete":null,"update":null},"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null},"after_unknown":{"id":true,"instance_id":true,"instance_owner_id":true,"nat_gateway_id":true,"network_interface_id":true,"origin":true,"route_table_id":true,"state":true,"timeouts":{}},"before_sensitive":false,"after_sensitive":{"timeouts":{}}}},{"address":"module.vpc.aws_route.public_internet_gateway[0]","module_address":"module.vpc","mode":"managed","type":"aws_route","name":"public_internet_gateway","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"carrier_gateway_id":null,"destination_cidr_block":"0.0.0.0/0","destination_ipv6_cidr_block":null,"destination_prefix_list_id":null,"egress_only_gateway_id":null,"local_gateway_id":null,"nat_gateway_id":null,"timeouts":{"create":"5m","delete":null,"update":null},"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null},"after_unknown":{"gateway_id":true,"id":true,"instance_id":true,"instance_owner_id":true,"network_interface_id":true,"origin":true,"route_table_id":true,"state":true,"timeouts":{}},"before_sensitive":false,"after_sensitive":{"timeouts":{}}}},{"address":"module.vpc.aws_route_table.private[0]","module_address":"module.vpc","mode":"managed","type":"aws_route_table","name":"private","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"tags":{"Environment":"setup","Name":"vpc-ut-default-private"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-private"},"timeouts":null},"after_unknown":{"arn":true,"id":true,"owner_id":true,"propagating_vgws":true,"route":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"propagating_vgws":[],"route":[],"tags":{},"tags_all":{}}}},{"address":"module.vpc.aws_route_table.public[0]","module_address":"module.vpc","mode":"managed","type":"aws_route_table","name":"public","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"tags":{"Environment":"setup","Name":"vpc-ut-default-public"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-public"},"timeouts":null},"after_unknown":{"arn":true,"id":true,"owner_id":true,"propagating_vgws":true,"route":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"propagating_vgws":[],"route":[],"tags":{},"tags_all":{}}}},{"address":"module.vpc.aws_route_table_association.private[0]","module_address":"module.vpc","mode":"managed","type":"aws_route_table_association","name":"private","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.vpc.aws_route_table_association.public[0]","module_address":"module.vpc","mode":"managed","type":"aws_route_table_association","name":"public","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.vpc.aws_subnet.private[0]","module_address":"module.vpc","mode":"managed","type":"aws_subnet","name":"private","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"eu-central-1a","cidr_block":"10.0.1.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Environment":"setup","Name":"vpc-ut-default-private-eu-central-1a"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-private-eu-central-1a"},"timeouts":null},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.vpc.aws_subnet.public[0]","module_address":"module.vpc","mode":"managed","type":"aws_subnet","name":"public","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"eu-central-1a","cidr_block":"10.0.101.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":true,"outpost_arn":null,"tags":{"Environment":"setup","Name":"vpc-ut-default-public-eu-central-1a"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default-public-eu-central-1a"},"timeouts":null},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.vpc.aws_vpc.this[0]","module_address":"module.vpc","mode":"managed","type":"aws_vpc","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_generated_ipv6_cidr_block":null,"cidr_block":"10.0.0.0/16","enable_dns_hostnames":false,"enable_dns_support":true,"instance_tenancy":"default","ipv4_ipam_pool_id":null,"ipv4_netmask_length":null,"ipv6_ipam_pool_id":null,"ipv6_netmask_length":null,"tags":{"Environment":"setup","Name":"vpc-ut-default"},"tags_all":{"Environment":"setup","Name":"vpc-ut-default"}},"after_unknown":{"arn":true,"default_network_acl_id":true,"default_route_table_id":true,"default_security_group_id":true,"dhcp_options_id":true,"enable_classiclink":true,"enable_classiclink_dns_support":true,"id":true,"ipv6_association_id":true,"ipv6_cidr_block":true,"ipv6_cidr_block_network_border_group":true,"main_route_table_id":true,"owner_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.vpc_endpoints.aws_vpc_endpoint.this[\"s3\"]","module_address":"module.vpc_endpoints","mode":"managed","type":"aws_vpc_endpoint","name":"this","index":"s3","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_accept":null,"private_dns_enabled":false,"service_name":"com.amazonaws.eu-central-1.s3","tags":{"Environment":"setup","Name":"s3-vpc-endpoint"},"tags_all":{"Environment":"setup","Name":"s3-vpc-endpoint"},"timeouts":{"create":"10m","delete":"10m","update":"10m"},"vpc_endpoint_type":"Interface"},"after_unknown":{"arn":true,"cidr_blocks":true,"dns_entry":true,"id":true,"network_interface_ids":true,"owner_id":true,"policy":true,"prefix_list_id":true,"requester_managed":true,"route_table_ids":true,"security_group_ids":true,"state":true,"subnet_ids":true,"tags":{},"tags_all":{},"timeouts":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"cidr_blocks":[],"dns_entry":[],"network_interface_ids":[],"route_table_ids":[],"security_group_ids":[],"subnet_ids":[],"tags":{},"tags_all":{},"timeouts":{}}}}],"prior_state":{"format_version":"1.0","terraform_version":"1.3.2","values":{"root_module":{"resources":[{"address":"data.aws_availability_zones.available","mode":"data","type":"aws_availability_zones","name":"available","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"all_availability_zones":null,"exclude_names":null,"exclude_zone_ids":null,"filter":null,"group_names":["eu-central-1"],"id":"eu-central-1","names":["eu-central-1a","eu-central-1b","eu-central-1c"],"state":"available","zone_ids":["euc1-az2","euc1-az3","euc1-az1"]},"sensitive_values":{"group_names":[false],"names":[false,false,false],"zone_ids":[false,false,false]}},{"address":"data.aws_region.this","mode":"data","type":"aws_region","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Europe (Frankfurt)","endpoint":"ec2.eu-central-1.amazonaws.com","id":"eu-central-1","name":"eu-central-1"},"sensitive_values":{}}],"child_modules":[{"resources":[{"address":"module.runner.data.aws_ami.docker-machine[0]","mode":"data","type":"aws_ami","name":"docker-machine","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"architecture":"x86_64","arn":"arn:aws:ec2:eu-central-1::image/ami-0b81e95bb0a06ea8c","block_device_mappings":[{"device_name":"/dev/sda1","ebs":{"delete_on_termination":"true","encrypted":"false","iops":"0","snapshot_id":"snap-002f583af6c3a88a9","throughput":"0","volume_size":"8","volume_type":"gp2"},"no_device":"","virtual_name":""},{"device_name":"/dev/sdb","ebs":{},"no_device":"","virtual_name":"ephemeral0"},{"device_name":"/dev/sdc","ebs":{},"no_device":"","virtual_name":"ephemeral1"}],"boot_mode":"","creation_date":"2022-12-12T22:47:37.000Z","description":"Canonical, Ubuntu, 20.04 LTS, amd64 focal image build on 2022-12-12","ena_support":true,"executable_users":null,"filter":[{"name":"name","values":["ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*"]}],"hypervisor":"xen","id":"ami-0b81e95bb0a06ea8c","image_id":"ami-0b81e95bb0a06ea8c","image_location":"amazon/ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-20221212","image_owner_alias":"amazon","image_type":"machine","kernel_id":null,"most_recent":true,"name":"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-20221212","name_regex":null,"owner_id":"099720109477","owners":["099720109477"],"platform":null,"platform_details":"Linux/UNIX","product_codes":[],"public":true,"ramdisk_id":null,"root_device_name":"/dev/sda1","root_device_type":"ebs","root_snapshot_id":"snap-002f583af6c3a88a9","sriov_net_support":"simple","state":"available","state_reason":{"code":"UNSET","message":"UNSET"},"tags":{},"usage_operation":"RunInstances","virtualization_type":"hvm"},"sensitive_values":{"block_device_mappings":[{"ebs":{}},{"ebs":{}},{"ebs":{}}],"filter":[{"values":[false]}],"owners":[false],"product_codes":[],"state_reason":{},"tags":{}}},{"address":"module.runner.data.aws_ami.runner","mode":"data","type":"aws_ami","name":"runner","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"architecture":"x86_64","arn":"arn:aws:ec2:eu-central-1::image/ami-0d3fb251d83530a2e","block_device_mappings":[{"device_name":"/dev/xvda","ebs":{"delete_on_termination":"true","encrypted":"false","iops":"0","snapshot_id":"snap-0b3fad5c97198887f","throughput":"0","volume_size":"8","volume_type":"standard"},"no_device":"","virtual_name":""}],"boot_mode":"","creation_date":"2022-12-16T01:55:13.000Z","description":"Amazon Linux 2 AMI 2.0.20221210.1 x86_64 HVM ebs","ena_support":true,"executable_users":null,"filter":[{"name":"name","values":["amzn2-ami-hvm-2.*-x86_64-ebs"]}],"hypervisor":"xen","id":"ami-0d3fb251d83530a2e","image_id":"ami-0d3fb251d83530a2e","image_location":"amazon/amzn2-ami-hvm-2.0.20221210.1-x86_64-ebs","image_owner_alias":"amazon","image_type":"machine","kernel_id":null,"most_recent":true,"name":"amzn2-ami-hvm-2.0.20221210.1-x86_64-ebs","name_regex":null,"owner_id":"137112412989","owners":["amazon"],"platform":null,"platform_details":"Linux/UNIX","product_codes":[],"public":true,"ramdisk_id":null,"root_device_name":"/dev/xvda","root_device_type":"ebs","root_snapshot_id":"snap-0b3fad5c97198887f","sriov_net_support":"simple","state":"available","state_reason":{"code":"UNSET","message":"UNSET"},"tags":{},"usage_operation":"RunInstances","virtualization_type":"hvm"},"sensitive_values":{"block_device_mappings":[{"ebs":{}}],"filter":[{"values":[false]}],"owners":[false],"product_codes":[],"state_reason":{},"tags":{}}},{"address":"module.runner.data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"990563477234","arn":"arn:aws:sts::990563477234:assumed-role/Rackspace/customer-kayma","id":"990563477234","user_id":"AROA6NIRPE3ZEZGYS32SY:customer-kayma"},"sensitive_values":{}},{"address":"module.runner.data.aws_partition.current","mode":"data","type":"aws_partition","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"dns_suffix":"amazonaws.com","id":"aws","partition":"aws","reverse_dns_prefix":"com.amazonaws"},"sensitive_values":{}}],"address":"module.runner","child_modules":[{"resources":[{"address":"module.runner.module.cache[0].data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"990563477234","arn":"arn:aws:sts::990563477234:assumed-role/Rackspace/customer-kayma","id":"990563477234","user_id":"AROA6NIRPE3ZEZGYS32SY:customer-kayma"},"sensitive_values":{}}],"address":"module.runner.module.cache[0]"},{"resources":[{"address":"module.runner.module.terminate_agent_hook.data.archive_file.terminate_runner_instances_lambda","mode":"data","type":"archive_file","name":"terminate_runner_instances_lambda","provider_name":"registry.terraform.io/hashicorp/archive","schema_version":0,"values":{"excludes":null,"id":"32a32a5ed1186931f439ae9f1192029147edd1bf","output_base64sha256":"eeC7Wx01Z5w7ek/MJJxqpXjnqKC+vOQLnyol0EiWcIA=","output_file_mode":null,"output_md5":"d85960af22ae4861a6ee2f953b3dcbfa","output_path":"builds/lambda_function_037173b002bc0421d8c11a9afce8c2cf4bb065a2a3dada7096305b404a156542.zip","output_sha":"32a32a5ed1186931f439ae9f1192029147edd1bf","output_size":1574,"source":[],"source_content":null,"source_content_filename":null,"source_dir":null,"source_file":"../../../modules/terminate-agent-hook/lambda/lambda_function.py","type":"zip"},"sensitive_values":{"source":[]}},{"address":"module.runner.module.terminate_agent_hook.data.aws_caller_identity.this","mode":"data","type":"aws_caller_identity","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"990563477234","arn":"arn:aws:sts::990563477234:assumed-role/Rackspace/customer-kayma","id":"990563477234","user_id":"AROA6NIRPE3ZEZGYS32SY:customer-kayma"},"sensitive_values":{}},{"address":"module.runner.module.terminate_agent_hook.data.aws_iam_policy_document.assume_role","mode":"data","type":"aws_iam_policy_document","name":"assume_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"3693445097","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["lambda.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_values":{"statement":[{"actions":[false],"condition":[],"not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":[false]}],"resources":[]}]}},{"address":"module.runner.module.terminate_agent_hook.data.aws_partition.current","mode":"data","type":"aws_partition","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"dns_suffix":"amazonaws.com","id":"aws","partition":"aws","reverse_dns_prefix":"com.amazonaws"},"sensitive_values":{}},{"address":"module.runner.module.terminate_agent_hook.data.aws_region.this","mode":"data","type":"aws_region","name":"this","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Europe (Frankfurt)","endpoint":"ec2.eu-central-1.amazonaws.com","id":"eu-central-1","name":"eu-central-1"},"sensitive_values":{}}],"address":"module.runner.module.terminate_agent_hook"}]},{"resources":[{"address":"module.vpc_endpoints.data.aws_vpc_endpoint_service.this[\"s3\"]","mode":"data","type":"aws_vpc_endpoint_service","name":"this","index":"s3","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"acceptance_required":false,"arn":"arn:aws:ec2:eu-central-1:990563477234:vpc-endpoint-service/vpce-svc-072f809f5f2824ee6","availability_zones":["eu-central-1a","eu-central-1b","eu-central-1c"],"base_endpoint_dns_names":["s3.eu-central-1.vpce.amazonaws.com"],"filter":[{"name":"service-type","values":["Interface"]}],"id":"4172194041","manages_vpc_endpoints":false,"owner":"amazon","private_dns_name":"","service":"s3","service_id":"vpce-svc-072f809f5f2824ee6","service_name":"com.amazonaws.eu-central-1.s3","service_type":"Interface","tags":{},"vpc_endpoint_policy_supported":true},"sensitive_values":{"availability_zones":[false,false,false],"base_endpoint_dns_names":[false],"filter":[{"values":[false]}],"tags":{}}}],"address":"module.vpc_endpoints"}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"4.7.0","expressions":{"region":{"references":["var.aws_region"]}}},"local":{"name":"local","full_name":"registry.terraform.io/hashicorp/local","version_constraint":"2.0.0"},"module.runner.module.cache:random":{"name":"random","full_name":"registry.terraform.io/hashicorp/random","module_address":"module.runner.module.cache"},"module.runner.module.terminate_agent_hook:archive":{"name":"archive","full_name":"registry.terraform.io/hashicorp/archive","module_address":"module.runner.module.terminate_agent_hook"},"null":{"name":"null","full_name":"registry.terraform.io/hashicorp/null","version_constraint":"3.0.0"},"random":{"name":"random","full_name":"registry.terraform.io/hashicorp/random","version_constraint":"3.0.0"},"tls":{"name":"tls","full_name":"registry.terraform.io/hashicorp/tls","version_constraint":"3.0.0"}},"root_module":{"resources":[{"address":"data.aws_availability_zones.available","mode":"data","type":"aws_availability_zones","name":"available","provider_config_key":"aws","expressions":{"state":{"constant_value":"available"}},"schema_version":0},{"address":"data.aws_region.this","mode":"data","type":"aws_region","name":"this","provider_config_key":"aws","schema_version":0},{"address":"data.aws_security_group.default","mode":"data","type":"aws_security_group","name":"default","provider_config_key":"aws","expressions":{"name":{"constant_value":"default"},"vpc_id":{"references":["module.vpc.vpc_id","module.vpc"]}},"schema_version":0}],"module_calls":{"runner":{"source":"../../../","expressions":{"aws_region":{"references":["data.aws_region.this.id","data.aws_region.this"]},"docker_machine_spot_price_bid":{"constant_value":"on-demand-price"},"enable_runner_ssm_access":{"constant_value":true},"environment":{"constant_value":"default"},"gitlab_runner_registration_config":{"constant_value":{"description":"runner default - auto","locked_to_project":"true","maximum_timeout":"3600","registration_token":"some-token","run_untagged":"false","tag_list":"docker_spot_runner"}},"gitlab_runner_security_group_ids":{"references":["data.aws_security_group.default.id","data.aws_security_group.default"]},"metrics_autoscaling":{"constant_value":["GroupDesiredCapacity","GroupInServiceCapacity"]},"runners_gitlab_url":{"constant_value":"https://my.fancy.url/not/used"},"runners_name":{"constant_value":"runner-name"},"subnet_id":{"references":["module.vpc.private_subnets","module.vpc"]},"tags":{"constant_value":{"tf-aws-gitlab-runner:example":"runner-default","tf-aws-gitlab-runner:instancelifecycle":"spot:yes"}},"vpc_id":{"references":["module.vpc.vpc_id","module.vpc"]}},"module":{"outputs":{"runner_agent_role_arn":{"expression":{"references":["local.aws_iam_role_instance_arn"]},"description":"ARN of the role used for the ec2 instance for the GitLab runner agent."},"runner_agent_role_name":{"expression":{"references":["local.aws_iam_role_instance_name"]},"description":"Name of the role used for the ec2 instance for the GitLab runner agent."},"runner_agent_sg_id":{"expression":{"references":["aws_security_group.runner.id","aws_security_group.runner"]},"description":"ID of the security group attached to the GitLab runner agent."},"runner_as_group_name":{"expression":{"references":["aws_autoscaling_group.gitlab_runner_instance.name","aws_autoscaling_group.gitlab_runner_instance"]},"description":"Name of the autoscaling group for the gitlab-runner instance"},"runner_cache_bucket_arn":{"expression":{"references":["module.cache"]},"description":"ARN of the S3 for the build cache."},"runner_cache_bucket_name":{"expression":{"references":["module.cache"]},"description":"Name of the S3 for the build cache."},"runner_eip":{"expression":{"references":["aws_eip.gitlab_runner"]},"description":"EIP of the Gitlab Runner"},"runner_launch_template_name":{"expression":{"references":["aws_launch_template.gitlab_runner_instance.name","aws_launch_template.gitlab_runner_instance"]},"description":"The name of the runner's launch template."},"runner_role_arn":{"expression":{"references":["aws_iam_role.docker_machine"]},"description":"ARN of the role used for the docker machine runners."},"runner_role_name":{"expression":{"references":["aws_iam_role.docker_machine"]},"description":"Name of the role used for the docker machine runners."},"runner_sg_id":{"expression":{"references":["aws_security_group.docker_machine"]},"description":"ID of the security group attached to the docker machine runners."},"runner_user_data":{"expression":{"references":["local.template_user_data"]},"description":"The user data of the Gitlab Runner Agent's launch template."}},"resources":[{"address":"aws_autoscaling_group.gitlab_runner_instance","mode":"managed","type":"aws_autoscaling_group","name":"gitlab_runner_instance","provider_config_key":"aws","expressions":{"desired_capacity":{"constant_value":"1"},"enabled_metrics":{"references":["var.metrics_autoscaling"]},"health_check_grace_period":{"constant_value":0},"instance_refresh":[{"preferences":[{"min_healthy_percentage":{"constant_value":0}}],"strategy":{"constant_value":"Rolling"},"triggers":{"constant_value":["tag"]}}],"launch_template":[{"id":{"references":["aws_launch_template.gitlab_runner_instance.id","aws_launch_template.gitlab_runner_instance"]},"version":{"references":["aws_launch_template.gitlab_runner_instance.latest_version","aws_launch_template.gitlab_runner_instance"]}}],"max_instance_lifetime":{"references":["var.asg_max_instance_lifetime"]},"max_size":{"constant_value":"1"},"min_size":{"constant_value":"1"},"name":{"references":["var.enable_asg_recreation","aws_launch_template.gitlab_runner_instance.name","aws_launch_template.gitlab_runner_instance","var.environment"]},"timeouts":{"delete":{"references":["var.asg_delete_timeout"]}},"vpc_zone_identifier":{"references":["var.subnet_id","var.subnet_id","var.subnet_ids_gitlab_runner"]}},"schema_version":0},{"address":"aws_autoscaling_schedule.scale_in","mode":"managed","type":"aws_autoscaling_schedule","name":"scale_in","provider_config_key":"aws","expressions":{"autoscaling_group_name":{"references":["aws_autoscaling_group.gitlab_runner_instance.name","aws_autoscaling_group.gitlab_runner_instance"]},"desired_capacity":{"references":["var.schedule_config[\"scale_in_desired_capacity\"]","var.schedule_config","var.schedule_config[\"scale_in_count\"]","var.schedule_config"]},"max_size":{"references":["var.schedule_config[\"scale_in_max_size\"]","var.schedule_config","var.schedule_config[\"scale_in_count\"]","var.schedule_config"]},"min_size":{"references":["var.schedule_config[\"scale_in_min_size\"]","var.schedule_config","var.schedule_config[\"scale_in_count\"]","var.schedule_config"]},"recurrence":{"references":["var.schedule_config[\"scale_in_recurrence\"]","var.schedule_config"]},"scheduled_action_name":{"references":["aws_autoscaling_group.gitlab_runner_instance.name","aws_autoscaling_group.gitlab_runner_instance"]}},"schema_version":0,"count_expression":{"references":["var.enable_schedule"]}},{"address":"aws_autoscaling_schedule.scale_out","mode":"managed","type":"aws_autoscaling_schedule","name":"scale_out","provider_config_key":"aws","expressions":{"autoscaling_group_name":{"references":["aws_autoscaling_group.gitlab_runner_instance.name","aws_autoscaling_group.gitlab_runner_instance"]},"desired_capacity":{"references":["var.schedule_config[\"scale_out_desired_capacity\"]","var.schedule_config","var.schedule_config[\"scale_out_count\"]","var.schedule_config"]},"max_size":{"references":["var.schedule_config[\"scale_out_max_size\"]","var.schedule_config","var.schedule_config[\"scale_out_count\"]","var.schedule_config"]},"min_size":{"references":["var.schedule_config[\"scale_out_min_size\"]","var.schedule_config","var.schedule_config[\"scale_out_count\"]","var.schedule_config"]},"recurrence":{"references":["var.schedule_config[\"scale_out_recurrence\"]","var.schedule_config"]},"scheduled_action_name":{"references":["aws_autoscaling_group.gitlab_runner_instance.name","aws_autoscaling_group.gitlab_runner_instance"]}},"schema_version":0,"count_expression":{"references":["var.enable_schedule"]}},{"address":"aws_cloudwatch_log_group.environment","mode":"managed","type":"aws_cloudwatch_log_group","name":"environment","provider_config_key":"aws","expressions":{"kms_key_id":{"references":["local.kms_key"]},"name":{"references":["var.log_group_name","var.log_group_name","var.environment"]},"retention_in_days":{"references":["var.cloudwatch_logging_retention_in_days"]},"tags":{"references":["local.tags"]}},"schema_version":0,"count_expression":{"references":["var.enable_cloudwatch_logging"]}},{"address":"aws_eip.gitlab_runner","mode":"managed","type":"aws_eip","name":"gitlab_runner","provider_config_key":"aws","schema_version":0,"count_expression":{"references":["var.enable_eip"]}},{"address":"aws_iam_instance_profile.docker_machine","mode":"managed","type":"aws_iam_instance_profile","name":"docker_machine","provider_config_key":"aws","expressions":{"name":{"references":["local.name_iam_objects"]},"role":{"references":["aws_iam_role.docker_machine[0].name","aws_iam_role.docker_machine[0]","aws_iam_role.docker_machine"]},"tags":{"references":["local.tags"]}},"schema_version":0,"count_expression":{"references":["var.runners_executor"]}},{"address":"aws_iam_instance_profile.instance","mode":"managed","type":"aws_iam_instance_profile","name":"instance","provider_config_key":"aws","expressions":{"name":{"references":["local.aws_iam_role_instance_name"]},"role":{"references":["local.aws_iam_role_instance_name"]},"tags":{"references":["local.tags"]}},"schema_version":0,"count_expression":{"references":["var.create_runner_iam_role"]}},{"address":"aws_iam_policy.eip","mode":"managed","type":"aws_iam_policy","name":"eip","provider_config_key":"aws","expressions":{"description":{"constant_value":"Policy for runner to assign EIP"},"name":{"references":["local.name_iam_objects"]},"path":{"constant_value":"/"},"policy":{"references":["path.module"]},"tags":{"references":["local.tags"]}},"schema_version":0,"count_expression":{"references":["var.enable_eip"]}},{"address":"aws_iam_policy.instance_docker_machine_policy","mode":"managed","type":"aws_iam_policy","name":"instance_docker_machine_policy","provider_config_key":"aws","expressions":{"description":{"constant_value":"Policy for docker machine."},"name":{"references":["local.name_iam_objects"]},"path":{"constant_value":"/"},"policy":{"references":["path.module","aws_iam_role.docker_machine[0].arn","aws_iam_role.docker_machine[0]","aws_iam_role.docker_machine"]},"tags":{"references":["local.tags"]}},"schema_version":0,"count_expression":{"references":["var.runners_executor","var.create_runner_iam_role"]}},{"address":"aws_iam_policy.instance_session_manager_policy","mode":"managed","type":"aws_iam_policy","name":"instance_session_manager_policy","provider_config_key":"aws","expressions":{"description":{"constant_value":"Policy session manager."},"name":{"references":["local.name_iam_objects"]},"path":{"constant_value":"/"},"policy":{"references":["path.module"]},"tags":{"references":["local.tags"]}},"schema_version":0,"count_expression":{"references":["var.enable_runner_ssm_access"]}},{"address":"aws_iam_policy.service_linked_role","mode":"managed","type":"aws_iam_policy","name":"service_linked_role","provider_config_key":"aws","expressions":{"description":{"constant_value":"Policy for creation of service linked roles."},"name":{"references":["local.name_iam_objects"]},"path":{"constant_value":"/"},"policy":{"references":["path.module","data.aws_partition.current.partition","data.aws_partition.current"]},"tags":{"references":["local.tags"]}},"schema_version":0,"count_expression":{"references":["var.allow_iam_service_linked_role_creation"]}},{"address":"aws_iam_policy.ssm","mode":"managed","type":"aws_iam_policy","name":"ssm","provider_config_key":"aws","expressions":{"description":{"constant_value":"Policy for runner token param access via SSM"},"name":{"references":["local.name_iam_objects"]},"path":{"constant_value":"/"},"policy":{"references":["path.module","data.aws_partition.current.partition","data.aws_partition.current"]},"tags":{"references":["local.tags"]}},"schema_version":0,"count_expression":{"references":["var.enable_manage_gitlab_token"]}},{"address":"aws_iam_role.docker_machine","mode":"managed","type":"aws_iam_role","name":"docker_machine","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["var.docker_machine_role_json","var.docker_machine_role_json","path.module"]},"name":{"references":["local.name_iam_objects"]},"permissions_boundary":{"references":["var.permissions_boundary","data.aws_partition.current.partition","data.aws_partition.current","data.aws_caller_identity.current.account_id","data.aws_caller_identity.current","var.permissions_boundary"]},"tags":{"references":["local.tags"]}},"schema_version":0,"count_expression":{"references":["var.runners_executor"]}},{"address":"aws_iam_role.instance","mode":"managed","type":"aws_iam_role","name":"instance","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["var.instance_role_json","var.instance_role_json","path.module"]},"name":{"references":["local.aws_iam_role_instance_name"]},"permissions_boundary":{"references":["var.permissions_boundary","data.aws_partition.current.partition","data.aws_partition.current","data.aws_caller_identity.current.account_id","data.aws_caller_identity.current","var.permissions_boundary"]},"tags":{"references":["local.tags","var.role_tags"]}},"schema_version":0,"count_expression":{"references":["var.create_runner_iam_role"]}},{"address":"aws_iam_role_policy.instance","mode":"managed","type":"aws_iam_role_policy","name":"instance","provider_config_key":"aws","expressions":{"name":{"references":["local.name_iam_objects"]},"policy":{"references":["path.module","data.aws_partition.current.partition","data.aws_partition.current"]},"role":{"references":["local.aws_iam_role_instance_name"]}},"schema_version":0,"count_expression":{"references":["var.enable_cloudwatch_logging","var.create_runner_iam_role"]}},{"address":"aws_iam_role_policy_attachment.docker_machine_cache_instance","mode":"managed","type":"aws_iam_role_policy_attachment","name":"docker_machine_cache_instance","provider_config_key":"aws","expressions":{"policy_arn":{"references":["local.bucket_policy"]},"role":{"references":["local.aws_iam_role_instance_name"]}},"schema_version":0,"count_expression":{"references":["var.runners_executor","var.cache_bucket[\"create\"]","var.cache_bucket","var.cache_bucket"]}},{"address":"aws_iam_role_policy_attachment.docker_machine_session_manager_aws_managed","mode":"managed","type":"aws_iam_role_policy_attachment","name":"docker_machine_session_manager_aws_managed","provider_config_key":"aws","expressions":{"policy_arn":{"references":["data.aws_partition.current.partition","data.aws_partition.current"]},"role":{"references":["aws_iam_role.docker_machine[0].name","aws_iam_role.docker_machine[0]","aws_iam_role.docker_machine"]}},"schema_version":0,"count_expression":{"references":["var.runners_executor","var.enable_docker_machine_ssm_access"]}},{"address":"aws_iam_role_policy_attachment.docker_machine_user_defined_policies","mode":"managed","type":"aws_iam_role_policy_attachment","name":"docker_machine_user_defined_policies","provider_config_key":"aws","expressions":{"policy_arn":{"references":["var.docker_machine_iam_policy_arns","count.index"]},"role":{"references":["aws_iam_role.docker_machine[0].name","aws_iam_role.docker_machine[0]","aws_iam_role.docker_machine"]}},"schema_version":0,"count_expression":{"references":["var.runners_executor","var.docker_machine_iam_policy_arns"]}},{"address":"aws_iam_role_policy_attachment.eip","mode":"managed","type":"aws_iam_role_policy_attachment","name":"eip","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.eip[0].arn","aws_iam_policy.eip[0]","aws_iam_policy.eip"]},"role":{"references":["local.aws_iam_role_instance_name"]}},"schema_version":0,"count_expression":{"references":["var.enable_eip"]}},{"address":"aws_iam_role_policy_attachment.instance_docker_machine_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"instance_docker_machine_policy","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.instance_docker_machine_policy[0].arn","aws_iam_policy.instance_docker_machine_policy[0]","aws_iam_policy.instance_docker_machine_policy"]},"role":{"references":["aws_iam_role.instance[0].name","aws_iam_role.instance[0]","aws_iam_role.instance"]}},"schema_version":0,"count_expression":{"references":["var.runners_executor","var.create_runner_iam_role"]}},{"address":"aws_iam_role_policy_attachment.instance_session_manager_aws_managed","mode":"managed","type":"aws_iam_role_policy_attachment","name":"instance_session_manager_aws_managed","provider_config_key":"aws","expressions":{"policy_arn":{"references":["data.aws_partition.current.partition","data.aws_partition.current"]},"role":{"references":["local.aws_iam_role_instance_name"]}},"schema_version":0,"count_expression":{"references":["var.enable_runner_ssm_access"]}},{"address":"aws_iam_role_policy_attachment.instance_session_manager_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"instance_session_manager_policy","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.instance_session_manager_policy[0].arn","aws_iam_policy.instance_session_manager_policy[0]","aws_iam_policy.instance_session_manager_policy"]},"role":{"references":["local.aws_iam_role_instance_name"]}},"schema_version":0,"count_expression":{"references":["var.enable_runner_ssm_access"]}},{"address":"aws_iam_role_policy_attachment.service_linked_role","mode":"managed","type":"aws_iam_role_policy_attachment","name":"service_linked_role","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.service_linked_role[0].arn","aws_iam_policy.service_linked_role[0]","aws_iam_policy.service_linked_role"]},"role":{"references":["local.aws_iam_role_instance_name"]}},"schema_version":0,"count_expression":{"references":["var.allow_iam_service_linked_role_creation"]}},{"address":"aws_iam_role_policy_attachment.ssm","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ssm","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.ssm[0].arn","aws_iam_policy.ssm[0]","aws_iam_policy.ssm"]},"role":{"references":["local.aws_iam_role_instance_name"]}},"schema_version":0,"count_expression":{"references":["var.enable_manage_gitlab_token"]}},{"address":"aws_iam_role_policy_attachment.user_defined_policies","mode":"managed","type":"aws_iam_role_policy_attachment","name":"user_defined_policies","provider_config_key":"aws","expressions":{"policy_arn":{"references":["var.runner_iam_policy_arns","count.index"]},"role":{"references":["local.aws_iam_role_instance_name"]}},"schema_version":0,"count_expression":{"references":["var.runner_iam_policy_arns"]}},{"address":"aws_kms_alias.default","mode":"managed","type":"aws_kms_alias","name":"default","provider_config_key":"aws","expressions":{"name":{"references":["var.kms_alias_name"]},"target_key_id":{"references":["aws_kms_key.default[0].key_id","aws_kms_key.default[0]","aws_kms_key.default"]}},"schema_version":0,"count_expression":{"references":["var.enable_kms","var.kms_alias_name"]}},{"address":"aws_kms_key.default","mode":"managed","type":"aws_kms_key","name":"default","provider_config_key":"aws","expressions":{"deletion_window_in_days":{"references":["var.kms_deletion_window_in_days","var.kms_deletion_window_in_days"]},"description":{"references":["var.environment"]},"enable_key_rotation":{"references":["var.kms_deletion_window_in_days"]},"policy":{"references":["path.module","data.aws_partition.current.partition","data.aws_partition.current","var.aws_region","data.aws_caller_identity.current.account_id","data.aws_caller_identity.current"]},"tags":{"references":["local.tags"]}},"schema_version":0,"count_expression":{"references":["var.enable_kms"]}},{"address":"aws_launch_template.gitlab_runner_instance","mode":"managed","type":"aws_launch_template","name":"gitlab_runner_instance","provider_config_key":"aws","expressions":{"ebs_optimized":{"references":["var.runner_instance_ebs_optimized"]},"iam_instance_profile":[{"name":{"references":["local.aws_iam_role_instance_name"]}}],"image_id":{"references":["data.aws_ami.runner.id","data.aws_ami.runner"]},"instance_type":{"references":["var.instance_type"]},"metadata_options":[{"http_endpoint":{"references":["var.runner_instance_metadata_options.http_endpoint","var.runner_instance_metadata_options"]},"http_put_response_hop_limit":{"references":["var.runner_instance_metadata_options.http_put_response_hop_limit","var.runner_instance_metadata_options"]},"http_tokens":{"references":["var.runner_instance_metadata_options.http_tokens","var.runner_instance_metadata_options"]},"instance_metadata_tags":{"references":["var.runner_instance_metadata_options.instance_metadata_tags","var.runner_instance_metadata_options"]}}],"monitoring":[{"enabled":{"references":["var.runner_instance_enable_monitoring"]}}],"name_prefix":{"references":["local.name_runner_agent_instance"]},"network_interfaces":[{"associate_public_ip_address":{"references":["var.runner_agent_uses_private_address","var.runner_agent_uses_private_address","var.runners_use_private_address"]},"security_groups":{"references":["aws_security_group.runner.id","aws_security_group.runner","var.extra_security_group_ids_runner_agent"]}}],"tag_specifications":[{"resource_type":{"constant_value":"instance"},"tags":{"references":["local.tags"]}},{"resource_type":{"constant_value":"volume"},"tags":{"references":["local.tags"]}}],"tags":{"references":["local.tags"]},"update_default_version":{"constant_value":true},"user_data":{"references":["local.template_user_data"]}},"schema_version":0,"depends_on":["aws_cloudwatch_log_group.environment"]},{"address":"aws_security_group.docker_machine","mode":"managed","type":"aws_security_group","name":"docker_machine","provider_config_key":"aws","expressions":{"description":{"references":["var.docker_machine_security_group_description"]},"name_prefix":{"references":["local.name_sg"]},"tags":{"references":["local.tags","local.name_sg"]},"vpc_id":{"references":["var.vpc_id"]}},"schema_version":1,"count_expression":{"references":["var.runners_executor"]}},{"address":"aws_security_group.runner","mode":"managed","type":"aws_security_group","name":"runner","provider_config_key":"aws","expressions":{"description":{"references":["var.gitlab_runner_security_group_description"]},"name_prefix":{"references":["local.name_sg"]},"tags":{"references":["local.tags","local.name_sg"]},"vpc_id":{"references":["var.vpc_id"]}},"schema_version":1},{"address":"aws_security_group_rule.docker_machine_docker_runner","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_docker_runner","provider_config_key":"aws","expressions":{"description":{"references":["aws_security_group.runner.name","aws_security_group.runner","aws_security_group.docker_machine[0].name","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"from_port":{"constant_value":2376},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.docker_machine[0].id","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"source_security_group_id":{"references":["aws_security_group.runner.id","aws_security_group.runner"]},"to_port":{"constant_value":2376},"type":{"constant_value":"ingress"}},"schema_version":2,"count_expression":{"references":["var.runners_executor"]}},{"address":"aws_security_group_rule.docker_machine_docker_self","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_docker_self","provider_config_key":"aws","expressions":{"description":{"references":["aws_security_group.docker_machine[0].name","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"from_port":{"constant_value":2376},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.docker_machine[0].id","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"self":{"constant_value":true},"to_port":{"constant_value":2376},"type":{"constant_value":"ingress"}},"schema_version":2,"count_expression":{"references":["var.runners_executor"]}},{"address":"aws_security_group_rule.docker_machine_ping_runner","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_ping_runner","provider_config_key":"aws","expressions":{"description":{"references":["local.security_groups_ping","count.index","aws_security_group.docker_machine[0].name","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"from_port":{"constant_value":-1},"protocol":{"constant_value":"icmp"},"security_group_id":{"references":["aws_security_group.docker_machine[0].id","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"source_security_group_id":{"references":["local.security_groups_ping","count.index"]},"to_port":{"constant_value":-1},"type":{"constant_value":"ingress"}},"schema_version":2,"count_expression":{"references":["var.runners_executor","local.security_groups_ping"]}},{"address":"aws_security_group_rule.docker_machine_ping_self","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_ping_self","provider_config_key":"aws","expressions":{"description":{"references":["aws_security_group.docker_machine[0].name","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"from_port":{"constant_value":-1},"protocol":{"constant_value":"icmp"},"security_group_id":{"references":["aws_security_group.docker_machine[0].id","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"self":{"constant_value":true},"to_port":{"constant_value":-1},"type":{"constant_value":"ingress"}},"schema_version":2,"count_expression":{"references":["var.runners_executor","var.enable_ping"]}},{"address":"aws_security_group_rule.docker_machine_ssh_runner","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_ssh_runner","provider_config_key":"aws","expressions":{"description":{"references":["aws_security_group.runner.id","aws_security_group.runner","aws_security_group.docker_machine[0].name","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"from_port":{"constant_value":22},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.docker_machine[0].id","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"source_security_group_id":{"references":["aws_security_group.runner.id","aws_security_group.runner"]},"to_port":{"constant_value":22},"type":{"constant_value":"ingress"}},"schema_version":2,"count_expression":{"references":["var.runners_executor"]}},{"address":"aws_security_group_rule.docker_machine_ssh_self","mode":"managed","type":"aws_security_group_rule","name":"docker_machine_ssh_self","provider_config_key":"aws","expressions":{"description":{"references":["aws_security_group.docker_machine[0].name","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"from_port":{"constant_value":22},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.docker_machine[0].id","aws_security_group.docker_machine[0]","aws_security_group.docker_machine"]},"self":{"constant_value":true},"to_port":{"constant_value":22},"type":{"constant_value":"ingress"}},"schema_version":2,"count_expression":{"references":["var.runners_executor"]}},{"address":"aws_security_group_rule.runner_ping_group","mode":"managed","type":"aws_security_group_rule","name":"runner_ping_group","provider_config_key":"aws","expressions":{"description":{"references":["var.gitlab_runner_security_group_ids","count.index","aws_security_group.runner.name","aws_security_group.runner"]},"from_port":{"constant_value":-1},"protocol":{"constant_value":"icmp"},"security_group_id":{"references":["aws_security_group.runner.id","aws_security_group.runner"]},"source_security_group_id":{"references":["var.gitlab_runner_security_group_ids","count.index"]},"to_port":{"constant_value":-1},"type":{"constant_value":"ingress"}},"schema_version":2,"count_expression":{"references":["var.gitlab_runner_security_group_ids","var.enable_ping","var.gitlab_runner_security_group_ids"]}},{"address":"aws_ssm_parameter.runner_registration_token","mode":"managed","type":"aws_ssm_parameter","name":"runner_registration_token","provider_config_key":"aws","expressions":{"name":{"references":["local.secure_parameter_store_runner_token_key"]},"tags":{"references":["local.tags"]},"type":{"constant_value":"SecureString"},"value":{"constant_value":"null"}},"schema_version":0},{"address":"aws_ssm_parameter.runner_sentry_dsn","mode":"managed","type":"aws_ssm_parameter","name":"runner_sentry_dsn","provider_config_key":"aws","expressions":{"name":{"references":["local.secure_parameter_store_runner_sentry_dsn"]},"tags":{"references":["local.tags"]},"type":{"constant_value":"SecureString"},"value":{"constant_value":"null"}},"schema_version":0},{"address":"data.aws_ami.docker-machine","mode":"data","type":"aws_ami","name":"docker-machine","provider_config_key":"aws","expressions":{"most_recent":{"constant_value":"true"},"owners":{"references":["var.runner_ami_owners"]}},"schema_version":0,"count_expression":{"references":["var.runners_executor"]}},{"address":"data.aws_ami.runner","mode":"data","type":"aws_ami","name":"runner","provider_config_key":"aws","expressions":{"most_recent":{"constant_value":"true"},"owners":{"references":["var.ami_owners"]}},"schema_version":0},{"address":"data.aws_availability_zone.runners","mode":"data","type":"aws_availability_zone","name":"runners","provider_config_key":"aws","expressions":{"name":{"references":["data.aws_subnet.runners.availability_zone","data.aws_subnet.runners"]}},"schema_version":0},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"aws","schema_version":0},{"address":"data.aws_partition.current","mode":"data","type":"aws_partition","name":"current","provider_config_key":"aws","schema_version":0},{"address":"data.aws_subnet.runners","mode":"data","type":"aws_subnet","name":"runners","provider_config_key":"aws","expressions":{"id":{"references":["var.subnet_id","var.subnet_id","var.subnet_id_runners"]}},"schema_version":0}],"module_calls":{"cache":{"source":"./modules/cache","expressions":{"cache_bucket_name_include_account_id":{"references":["var.cache_bucket_name_include_account_id"]},"cache_bucket_prefix":{"references":["var.cache_bucket_prefix"]},"cache_bucket_set_random_suffix":{"references":["var.cache_bucket_set_random_suffix"]},"cache_bucket_versioning":{"references":["var.cache_bucket_versioning"]},"cache_expiration_days":{"references":["var.cache_expiration_days"]},"cache_logging_bucket":{"references":["var.cache_logging_bucket"]},"cache_logging_bucket_prefix":{"references":["var.cache_logging_bucket_prefix"]},"environment":{"references":["var.environment"]},"kms_key_id":{"references":["local.kms_key"]},"name_iam_objects":{"references":["local.name_iam_objects"]},"tags":{"references":["local.tags"]}},"count_expression":{"references":["var.cache_bucket[\"create\"]","var.cache_bucket"]},"module":{"outputs":{"arn":{"expression":{"references":["aws_s3_bucket.build_cache.arn","aws_s3_bucket.build_cache"]},"description":"The ARN of the created bucket."},"bucket":{"expression":{"references":["aws_s3_bucket.build_cache.bucket","aws_s3_bucket.build_cache"]},"description":"Name of the created bucket."},"policy_arn":{"expression":{"references":["aws_iam_policy.docker_machine_cache.arn","aws_iam_policy.docker_machine_cache"]},"description":"Policy for users of the cache (bucket)."}},"resources":[{"address":"aws_iam_policy.docker_machine_cache","mode":"managed","type":"aws_iam_policy","name":"docker_machine_cache","provider_config_key":"aws","expressions":{"description":{"constant_value":"Policy for docker machine instance to access cache"},"name":{"references":["local.name_iam_objects"]},"path":{"constant_value":"/"},"policy":{"references":["path.module","aws_s3_bucket.build_cache.arn","aws_s3_bucket.build_cache"]},"tags":{"references":["local.tags"]}},"schema_version":0},{"address":"aws_s3_bucket.build_cache","mode":"managed","type":"aws_s3_bucket","name":"build_cache","provider_config_key":"aws","expressions":{"bucket":{"references":["local.cache_bucket_name"]},"force_destroy":{"constant_value":true},"tags":{"references":["local.tags"]}},"schema_version":0},{"address":"aws_s3_bucket_acl.build_cache_acl","mode":"managed","type":"aws_s3_bucket_acl","name":"build_cache_acl","provider_config_key":"aws","expressions":{"acl":{"constant_value":"private"},"bucket":{"references":["aws_s3_bucket.build_cache.id","aws_s3_bucket.build_cache"]}},"schema_version":0},{"address":"aws_s3_bucket_lifecycle_configuration.build_cache_versioning","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"build_cache_versioning","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.build_cache.id","aws_s3_bucket.build_cache"]},"rule":[{"expiration":[{"days":{"references":["var.cache_expiration_days"]}}],"filter":[{"prefix":{"references":["var.cache_lifecycle_prefix"]}}],"id":{"constant_value":"clear"},"status":{"references":["var.cache_lifecycle_clear"]}}]},"schema_version":0},{"address":"aws_s3_bucket_logging.build_cache","mode":"managed","type":"aws_s3_bucket_logging","name":"build_cache","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.build_cache.id","aws_s3_bucket.build_cache"]},"target_bucket":{"references":["var.cache_logging_bucket"]},"target_prefix":{"references":["var.cache_logging_bucket_prefix"]}},"schema_version":0,"count_expression":{"references":["var.cache_logging_bucket"]}},{"address":"aws_s3_bucket_public_access_block.build_cache_policy","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"build_cache_policy","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.build_cache.id","aws_s3_bucket.build_cache"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.build_cache_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"build_cache_encryption","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.build_cache.id","aws_s3_bucket.build_cache"]},"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":{"references":["var.kms_key_id"]},"sse_algorithm":{"constant_value":"aws:kms"}}],"bucket_key_enabled":{"constant_value":true}}]},"schema_version":0},{"address":"aws_s3_bucket_versioning.build_cache_versioning","mode":"managed","type":"aws_s3_bucket_versioning","name":"build_cache_versioning","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.build_cache.id","aws_s3_bucket.build_cache"]},"versioning_configuration":[{"status":{"references":["var.cache_bucket_versioning"]}}]},"schema_version":0},{"address":"random_string.s3_suffix","mode":"managed","type":"random_string","name":"s3_suffix","provider_config_key":"module.runner.module.cache:random","expressions":{"length":{"constant_value":8},"special":{"constant_value":false},"upper":{"constant_value":false}},"schema_version":1,"count_expression":{"references":["var.cache_bucket_set_random_suffix"]}},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"aws","schema_version":0}],"variables":{"arn_format":{"default":"arn:aws","description":"ARN format to be used. May be changed to support deployment in GovCloud/China regions."},"cache_bucket_name_include_account_id":{"default":true,"description":"Boolean to add current account ID to cache bucket name."},"cache_bucket_prefix":{"default":"","description":"Prefix for s3 cache bucket name."},"cache_bucket_set_random_suffix":{"default":false,"description":"Random string suffix for s3 cache bucket"},"cache_bucket_versioning":{"default":false,"description":"Boolean used to enable versioning on the cache bucket, false by default."},"cache_expiration_days":{"default":1,"description":"Number of days before cache objects expires."},"cache_lifecycle_clear":{"default":true,"description":"Enable the rule to cleanup the cache for expired objects."},"cache_lifecycle_prefix":{"default":"runner/","description":"Object key prefix identifying one or more objects to which the clean up rule applies."},"cache_logging_bucket":{"default":null,"description":"S3 Bucket ID where the access logs to the cache bucket are stored."},"cache_logging_bucket_prefix":{"default":null,"description":"Prefix within the `cache_logging_bucket`."},"create_cache_bucket":{"default":null,"description":"(deprecated) If the cache should not be craeted, remove the whole module call!"},"environment":{"description":"A name that identifies the environment, used as prefix and for tagging."},"kms_key_id":{"default":"","description":"KMS key id to encrypted the resources. Ensure that your Runner/Executor has access to the KMS key."},"name_iam_objects":{"default":"","description":"Set the name prefix of all AWS IAM resources created by this module"},"tags":{"default":{},"description":"Map of tags that will be added to created resources. By default resources will be tagged with name and environment."}}}},"terminate_agent_hook":{"source":"./modules/terminate-agent-hook","expressions":{"arn_format":{"references":["var.arn_format"]},"asg_arn":{"references":["aws_autoscaling_group.gitlab_runner_instance.arn","aws_autoscaling_group.gitlab_runner_instance"]},"asg_name":{"references":["aws_autoscaling_group.gitlab_runner_instance.name","aws_autoscaling_group.gitlab_runner_instance"]},"cloudwatch_logging_retention_in_days":{"references":["var.cloudwatch_logging_retention_in_days"]},"environment":{"references":["var.environment"]},"kms_key_id":{"references":["local.kms_key"]},"name":{"references":["var.asg_terminate_lifecycle_hook_name","var.asg_terminate_lifecycle_hook_name"]},"name_iam_objects":{"references":["local.name_iam_objects"]},"role_permissions_boundary":{"references":["var.permissions_boundary","data.aws_partition.current.partition","data.aws_partition.current","data.aws_caller_identity.current.account_id","data.aws_caller_identity.current","var.permissions_boundary"]},"tags":{"references":["local.tags"]}},"module":{"outputs":{"lambda_function_arn":{"expression":{"references":["aws_lambda_function.terminate_runner_instances.arn","aws_lambda_function.terminate_runner_instances"]},"description":"Lambda function arn."},"lambda_function_invoke_arn":{"expression":{"references":["aws_lambda_function.terminate_runner_instances.invoke_arn","aws_lambda_function.terminate_runner_instances"]},"description":"Lambda function invoke arn."},"lambda_function_name":{"expression":{"references":["aws_lambda_function.terminate_runner_instances.function_name","aws_lambda_function.terminate_runner_instances"]},"description":"Lambda function name."},"lambda_function_source_code_hash":{"expression":{"references":["aws_lambda_function.terminate_runner_instances.source_code_hash","aws_lambda_function.terminate_runner_instances"]},"description":"Lambda function source code hash."}},"resources":[{"address":"aws_autoscaling_lifecycle_hook.terminate_instances","mode":"managed","type":"aws_autoscaling_lifecycle_hook","name":"terminate_instances","provider_config_key":"aws","expressions":{"autoscaling_group_name":{"references":["var.asg_name"]},"default_result":{"constant_value":"CONTINUE"},"heartbeat_timeout":{"references":["local.lambda_timeout"]},"lifecycle_transition":{"constant_value":"autoscaling:EC2_INSTANCE_TERMINATING"},"name":{"references":["var.environment","var.name"]}},"schema_version":0},{"address":"aws_cloudwatch_event_rule.terminate_instances","mode":"managed","type":"aws_cloudwatch_event_rule","name":"terminate_instances","provider_config_key":"aws","expressions":{"description":{"constant_value":"Trigger GitLab runner instance lifecycle hook on termination."},"event_pattern":{"references":["var.asg_name"]},"name":{"references":["var.environment","var.name"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"aws_cloudwatch_event_target.terminate_instances","mode":"managed","type":"aws_cloudwatch_event_target","name":"terminate_instances","provider_config_key":"aws","expressions":{"arn":{"references":["aws_lambda_function.terminate_runner_instances.arn","aws_lambda_function.terminate_runner_instances"]},"rule":{"references":["aws_cloudwatch_event_rule.terminate_instances.name","aws_cloudwatch_event_rule.terminate_instances"]},"target_id":{"references":["var.environment"]}},"schema_version":1},{"address":"aws_cloudwatch_log_group.lambda","mode":"managed","type":"aws_cloudwatch_log_group","name":"lambda","provider_config_key":"aws","expressions":{"kms_key_id":{"references":["var.kms_key_id"]},"name":{"references":["var.environment","var.name"]},"retention_in_days":{"references":["var.cloudwatch_logging_retention_in_days"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"aws_iam_policy.lambda","mode":"managed","type":"aws_iam_policy","name":"lambda","provider_config_key":"aws","expressions":{"name":{"references":["var.name_iam_objects","var.name"]},"path":{"constant_value":"/"},"policy":{"references":["data.aws_iam_policy_document.lambda.json","data.aws_iam_policy_document.lambda"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"aws_iam_role.lambda","mode":"managed","type":"aws_iam_role","name":"lambda","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.assume_role.json","data.aws_iam_policy_document.assume_role"]},"description":{"references":["var.name"]},"force_detach_policies":{"constant_value":true},"name":{"references":["var.name_iam_objects","var.name"]},"path":{"constant_value":"/"},"permissions_boundary":{"references":["var.role_permissions_boundary"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.lambda","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.lambda.arn","aws_iam_policy.lambda"]},"role":{"references":["aws_iam_role.lambda.name","aws_iam_role.lambda"]}},"schema_version":0},{"address":"aws_lambda_function.terminate_runner_instances","mode":"managed","type":"aws_lambda_function","name":"terminate_runner_instances","provider_config_key":"aws","expressions":{"architectures":{"constant_value":["x86_64"]},"description":{"constant_value":"Lifecycle hook for terminating GitLab runner agent instances"},"filename":{"references":["data.archive_file.terminate_runner_instances_lambda.output_path","data.archive_file.terminate_runner_instances_lambda"]},"function_name":{"references":["var.environment","var.name"]},"handler":{"constant_value":"lambda_function.handler"},"memory_size":{"constant_value":128},"package_type":{"constant_value":"Zip"},"publish":{"constant_value":true},"role":{"references":["aws_iam_role.lambda.arn","aws_iam_role.lambda"]},"runtime":{"constant_value":"python3.8"},"source_code_hash":{"references":["data.archive_file.terminate_runner_instances_lambda.output_base64sha256","data.archive_file.terminate_runner_instances_lambda"]},"tags":{"references":["var.tags"]},"timeout":{"references":["local.lambda_timeout"]}},"schema_version":0},{"address":"aws_lambda_permission.current_version_triggers","mode":"managed","type":"aws_lambda_permission","name":"current_version_triggers","provider_config_key":"aws","expressions":{"action":{"constant_value":"lambda:InvokeFunction"},"function_name":{"references":["aws_lambda_function.terminate_runner_instances.function_name","aws_lambda_function.terminate_runner_instances"]},"principal":{"constant_value":"events.amazonaws.com"},"qualifier":{"references":["aws_lambda_function.terminate_runner_instances.version","aws_lambda_function.terminate_runner_instances"]},"source_arn":{"references":["aws_cloudwatch_event_rule.terminate_instances.arn","aws_cloudwatch_event_rule.terminate_instances"]},"statement_id":{"constant_value":"TerminateInstanceEvent"}},"schema_version":0},{"address":"aws_lambda_permission.unqualified_alias_triggers","mode":"managed","type":"aws_lambda_permission","name":"unqualified_alias_triggers","provider_config_key":"aws","expressions":{"action":{"constant_value":"lambda:InvokeFunction"},"function_name":{"references":["aws_lambda_function.terminate_runner_instances.function_name","aws_lambda_function.terminate_runner_instances"]},"principal":{"constant_value":"events.amazonaws.com"},"source_arn":{"references":["aws_cloudwatch_event_rule.terminate_instances.arn","aws_cloudwatch_event_rule.terminate_instances"]},"statement_id":{"constant_value":"TerminateInstanceEventUnqualified"}},"schema_version":0},{"address":"data.archive_file.terminate_runner_instances_lambda","mode":"data","type":"archive_file","name":"terminate_runner_instances_lambda","provider_config_key":"module.runner.module.terminate_agent_hook:archive","expressions":{"output_path":{"references":["local.source_sha256"]},"source_file":{"references":["path.module"]},"type":{"constant_value":"zip"}},"schema_version":0},{"address":"data.aws_caller_identity.this","mode":"data","type":"aws_caller_identity","name":"this","provider_config_key":"aws","schema_version":0},{"address":"data.aws_iam_policy_document.assume_role","mode":"data","type":"aws_iam_policy_document","name":"assume_role","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"constant_value":["lambda.amazonaws.com"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0},{"address":"data.aws_iam_policy_document.lambda","mode":"data","type":"aws_iam_policy_document","name":"lambda","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["ec2:DescribeInstances","ec2:DescribeTags","ec2:DescribeRegions","ec2:DescribeInstanceStatus"]},"effect":{"constant_value":"Allow"},"resources":{"constant_value":["*"]},"sid":{"constant_value":"GitLabRunnerLifecycleGetInstances"}},{"actions":{"constant_value":["ec2:TerminateInstances"]},"condition":[{"test":{"constant_value":"StringLike"},"values":{"constant_value":["i-*"]},"variable":{"constant_value":"ec2:ResourceTag/gitlab-runner-parent-id"}}],"effect":{"constant_value":"Allow"},"resources":{"references":["data.aws_partition.current.partition","data.aws_partition.current","data.aws_region.this.name","data.aws_region.this","data.aws_caller_identity.this.account_id","data.aws_caller_identity.this"]},"sid":{"constant_value":"GitLabRunnerLifecycleTerminateInstances"}},{"actions":{"constant_value":["autoscaling:CompleteLifecycleAction"]},"effect":{"constant_value":"Allow"},"resources":{"references":["var.asg_arn"]},"sid":{"constant_value":"GitLabRunnerLifecycleTerminateEvent"}},{"actions":{"constant_value":["logs:PutLogEvents","logs:CreateLogStream"]},"effect":{"constant_value":"Allow"},"resources":{"references":["aws_cloudwatch_log_group.lambda.arn","aws_cloudwatch_log_group.lambda","aws_cloudwatch_log_group.lambda.arn","aws_cloudwatch_log_group.lambda"]},"sid":{"constant_value":"GitLabRunnerLifecycleTerminateLogs"}}]},"schema_version":0},{"address":"data.aws_partition.current","mode":"data","type":"aws_partition","name":"current","provider_config_key":"aws","schema_version":0},{"address":"data.aws_region.this","mode":"data","type":"aws_region","name":"this","provider_config_key":"aws","schema_version":0}],"variables":{"arn_format":{"default":"arn:aws","description":"ARN format to be used. May be changed to support deployment in GovCloud/China regions."},"asg_arn":{"description":"The ARN of the Auto Scaling Group to attach to."},"asg_name":{"description":"The name of the Auto Scaling Group to attach to. The 'environment' will be prefixed to this."},"cloudwatch_logging_retention_in_days":{"default":30,"description":"The number of days to retain logs in CloudWatch."},"enable_xray_tracing":{"default":false,"description":"Enables X-Ray for debugging and analysis"},"environment":{"description":"A name that identifies the environment, used as a name prefix and for tagging."},"kms_key_id":{"description":"KMS key id to encrypted the CloudWatch logs. Ensure CloudWatch has access to the provided KMS key."},"name":{"description":"The name of the Lambda function to create. The 'environment' will be prefixed to this."},"name_iam_objects":{"default":"","description":"The name to use for IAM resources - roles and policies."},"role_permissions_boundary":{"default":null,"description":"An optional IAM permissions boundary to use when creating IAM roles."},"tags":{"default":{},"description":"Map of tags to apply to resources."}}}}},"variables":{"agent_tags":{"default":{},"description":"Map of tags that will be added to agent EC2 instances."},"allow_iam_service_linked_role_creation":{"default":true,"description":"Boolean used to control attaching the policy to a runner instance to create service linked roles."},"ami_filter":{"default":{"name":["amzn2-ami-hvm-2.*-x86_64-ebs"]},"description":"List of maps used to create the AMI filter for the Gitlab runner agent AMI. Must resolve to an Amazon Linux 1 or 2 image."},"ami_owners":{"default":["amazon"],"description":"The list of owners used to select the AMI of Gitlab runner agent instances."},"arn_format":{"default":null,"description":"Deprecated! Calculated automatically by the module. ARN format to be used. May be changed to support deployment in GovCloud/China regions."},"asg_delete_timeout":{"default":"10m","description":"Timeout when trying to delete the Runner ASG."},"asg_max_instance_lifetime":{"default":null,"description":"The seconds before an instance is refreshed in the ASG."},"asg_terminate_lifecycle_hook_create":{"default":true,"description":"(Deprecated and always true now) Boolean toggling the creation of the ASG instance terminate lifecycle hook."},"asg_terminate_lifecycle_hook_heartbeat_timeout":{"default":null,"description":"(Deprecated and no longer in use) The amount of time, in seconds, for the instances to remain in wait state."},"asg_terminate_lifecycle_hook_name":{"default":null,"description":"Specifies a custom name for the ASG terminate lifecycle hook and related resources."},"asg_terminate_lifecycle_lambda_memory_size":{"default":128,"description":"(Deprecated and no longer in use) The memory size in MB to allocate to the terminate-instances Lambda function."},"asg_terminate_lifecycle_lambda_runtime":{"default":"python3.8","description":"(Deprecated and no longer in use) Identifier of the function's runtime. This should be a python3.x runtime. See https://docs.aws.amazon.com/lambda/latest/dg/API_CreateFunction.html#SSS-CreateFunction-request-Runtime for more information."},"asg_terminate_lifecycle_lambda_timeout":{"default":30,"description":"(Deprecated and no longer in use) Amount of time the terminate-instances Lambda Function has to run in seconds."},"auth_type_cache_sr":{"default":"iam","description":"A string that declares the AuthenticationType for [runners.cache.s3]. Can either be 'iam' or 'credentials'"},"aws_region":{"description":"AWS region."},"cache_bucket":{"default":{"bucket":"","create":"true","policy":""},"description":"Configuration to control the creation of the cache bucket. By default the bucket will be created and used as shared cache. To use the same cache across multiple runners disable the creation of the cache and provide a policy and bucket name. See the public runner example for more details."},"cache_bucket_name_include_account_id":{"default":true,"description":"Boolean to add current account ID to cache bucket name."},"cache_bucket_prefix":{"default":"","description":"Prefix for s3 cache bucket name."},"cache_bucket_set_random_suffix":{"default":false,"description":"Append the cache bucket name with a random string suffix"},"cache_bucket_versioning":{"default":false,"description":"Boolean used to enable versioning on the cache bucket, false by default."},"cache_expiration_days":{"default":1,"description":"Number of days before cache objects expires."},"cache_logging_bucket":{"default":null,"description":"S3 Bucket ID where the access logs to the cache bucket are stored."},"cache_logging_bucket_prefix":{"default":null,"description":"Prefix within the `cache_logging_bucket`."},"cache_shared":{"default":false,"description":"Enables cache sharing between runners, false by default."},"cloudwatch_logging_retention_in_days":{"default":0,"description":"Retention for cloudwatch logs. Defaults to unlimited"},"create_runner_iam_role":{"default":true,"description":"Whether to create the runner IAM role of the gitlab runner agent EC2 instance."},"docker_machine_download_url":{"default":"","description":"(Optional) By default the module will use `docker_machine_version` to download the GitLab mantained version of Docker Machine. Alternative you can set this property to download location of the distribution of for the OS. See also https://docs.gitlab.com/runner/executors/docker_machine.html#install"},"docker_machine_egress_rules":{"default":[{"cidr_blocks":["0.0.0.0/0"],"description":"Allow all egress traffic for docker machine build runners","from_port":0,"ipv6_cidr_blocks":["::/0"],"prefix_list_ids":null,"protocol":"-1","security_groups":null,"self":null,"to_port":0}],"description":"List of egress rules for the docker-machine instance(s)."},"docker_machine_iam_policy_arns":{"default":[],"description":"List of policy ARNs to be added to the instance profile of the docker machine runners."},"docker_machine_instance_metadata_options":{"default":{"http_put_response_hop_limit":2,"http_tokens":"required"},"description":"Enable the docker machine instances metadata service. Requires you use GitLab maintained docker machines."},"docker_machine_instance_type":{"default":"m5.large","description":"Instance type used for the instances hosting docker-machine."},"docker_machine_options":{"default":[],"description":"List of additional options for the docker machine config. Each element of this list must be a key=value pair. E.g. '[\"amazonec2-zone=a\"]'"},"docker_machine_role_json":{"default":"","description":"Docker machine runner instance override policy, expected to be in JSON format."},"docker_machine_security_group_description":{"default":"A security group containing docker-machine instances","description":"A description for the docker-machine security group"},"docker_machine_spot_price_bid":{"default":"on-demand-price","description":"Spot price bid. The maximum price willing to pay. By default the price is limited by the current on demand price for the instance type chosen."},"docker_machine_version":{"default":"0.16.2-gitlab.15","description":"By default docker_machine_download_url is used to set the docker machine version. Version of docker-machine. The version will be ingored once `docker_machine_download_url` is set."},"enable_asg_recreation":{"default":true,"description":"Enable automatic redeployment of the Runner ASG when the Launch Configs change."},"enable_cloudwatch_logging":{"default":true,"description":"Boolean used to enable or disable the CloudWatch logging."},"enable_docker_machine_ssm_access":{"default":false,"description":"Add IAM policies to the docker-machine instances to connect via the Session Manager."},"enable_eip":{"default":false,"description":"Enable the assignment of an EIP to the gitlab runner instance"},"enable_kms":{"default":false,"description":"Let the module manage a KMS key, logs will be encrypted via KMS. Be-aware of the costs of an custom key."},"enable_manage_gitlab_token":{"default":true,"description":"Boolean to enable the management of the GitLab token in SSM. If `true` the token will be stored in SSM, which means the SSM property is a terraform managed resource. If `false` the Gitlab token will be stored in the SSM by the user-data script during creation of the the instance. However the SSM parameter is not managed by terraform and will remain in SSM after a `terraform destroy`."},"enable_ping":{"default":false,"description":"Allow ICMP Ping to the ec2 instances."},"enable_runner_ssm_access":{"default":false,"description":"Add IAM policies to the runner agent instance to connect via the Session Manager."},"enable_runner_user_data_trace_log":{"default":true,"description":"Enable bash xtrace for the user data script that creates the EC2 instance for the runner agent. Be aware this could log sensitive data such as you GitLab runner token."},"enable_schedule":{"default":false,"description":"Flag used to enable/disable auto scaling group schedule for the runner instance. "},"environment":{"description":"A name that identifies the environment, used as prefix and for tagging."},"extra_security_group_ids_runner_agent":{"default":[],"description":"Optional IDs of extra security groups to apply to the runner agent. This will not apply to the runners spun up when using the docker+machine executor, which is the default."},"gitlab_runner_egress_rules":{"default":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":0,"ipv6_cidr_blocks":["::/0"],"prefix_list_ids":null,"protocol":"-1","security_groups":null,"self":null,"to_port":0}],"description":"List of egress rules for the gitlab runner instance."},"gitlab_runner_registration_config":{"default":{"access_level":"","description":"","locked_to_project":"","maximum_timeout":"","registration_token":"","run_untagged":"","tag_list":""},"description":"Configuration used to register the runner. See the README for an example, or reference the examples in the examples directory of this repo."},"gitlab_runner_security_group_description":{"default":"A security group containing gitlab-runner agent instances","description":"A description for the gitlab-runner security group"},"gitlab_runner_security_group_ids":{"default":[],"description":"A list of security group ids that are allowed to access the gitlab runner agent"},"gitlab_runner_version":{"default":"15.3.0","description":"Version of the [GitLab runner](https://gitlab.com/gitlab-org/gitlab-runner/-/releases)."},"instance_role_json":{"default":"","description":"Default runner instance override policy, expected to be in JSON format."},"instance_type":{"default":"t3.micro","description":"Instance type used for the GitLab runner."},"kms_alias_name":{"default":"","description":"Alias added to the kms_key (if created and not provided by kms_key_id)"},"kms_deletion_window_in_days":{"default":7,"description":"Key rotation window, set to 0 for no rotation. Only used when `enable_kms` is set to `true`."},"kms_key_id":{"default":"","description":"KMS key id to encrypted the resources. Ensure CloudWatch and Runner/Executor have access to the provided KMS key."},"log_group_name":{"default":null,"description":"Option to override the default name (`environment`) of the log group, requires `enable_cloudwatch_logging = true`."},"metrics_autoscaling":{"default":null,"description":"A list of metrics to collect. The allowed values are GroupDesiredCapacity, GroupInServiceCapacity, GroupPendingCapacity, GroupMinSize, GroupMaxSize, GroupInServiceInstances, GroupPendingInstances, GroupStandbyInstances, GroupStandbyCapacity, GroupTerminatingCapacity, GroupTerminatingInstances, GroupTotalCapacity, GroupTotalInstances."},"overrides":{"default":{"name_docker_machine_runners":"","name_iam_objects":"","name_runner_agent_instance":"","name_sg":""},"description":"This map provides the possibility to override some defaults. \nThe following attributes are supported: \n  * `name_sg` set the name prefix and overwrite the `Name` tag for all security groups created by this module. \n  * `name_runner_agent_instance` set the name prefix and override the `Name` tag for the EC2 gitlab runner instances defined in the auto launch configuration. \n  * `name_docker_machine_runners` override the `Name` tag of EC2 instances created by the runner agent (used as name prefix for `docker_machine_version` \u003e= 0.16.2).\n  * `name_iam_objects` set the name prefix of all AWS IAM resources created by this module.\n"},"permissions_boundary":{"default":"","description":"Name of permissions boundary policy to attach to AWS IAM roles"},"prometheus_listen_address":{"default":"","description":"Defines an address (\u003chost\u003e:\u003cport\u003e) the Prometheus metrics HTTP server should listen on."},"role_tags":{"default":{},"description":"Map of tags that will be added to the role created. Useful for tag based authorization."},"runner_agent_uses_private_address":{"default":true,"description":"Restrict the runner agent to the use of a private IP address. If `runner_agent_uses_private_address` is set to `false` it will override the `runners_use_private_address` for the agent."},"runner_ami_filter":{"default":{"name":["ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*"]},"description":"List of maps used to create the AMI filter for the Gitlab runner docker-machine AMI."},"runner_ami_owners":{"default":["099720109477"],"description":"The list of owners used to select the AMI of Gitlab runner docker-machine instances."},"runner_extra_config":{"default":"","description":"Extra commands to run as part of starting the runner"},"runner_iam_policy_arns":{"default":[],"description":"List of policy ARNs to be added to the instance profile of the gitlab runner agent ec2 instance."},"runner_iam_role_name":{"default":"","description":"IAM role name of the gitlab runner agent EC2 instance. If unspecified then `{name_iam_objects}-instance` is used"},"runner_instance_ebs_optimized":{"default":true,"description":"Enable the GitLab runner instance to be EBS-optimized."},"runner_instance_enable_monitoring":{"default":true,"description":"Enable the GitLab runner instance to have detailed monitoring."},"runner_instance_metadata_options":{"default":{"http_endpoint":"enabled","http_put_response_hop_limit":2,"http_tokens":"required","instance_metadata_tags":"disabled"},"description":"Enable the Gitlab runner agent instance metadata service."},"runner_instance_spot_price":{"default":null,"description":"By setting a spot price bid price the runner agent will be created via a spot request. Be aware that spot instances can be stopped by AWS. Choose \"on-demand-price\" to pay up to the current on demand price for the instance type chosen."},"runner_root_block_device":{"default":{},"description":"The EC2 instance root block device configuration. Takes the following keys: `device_name`, `delete_on_termination`, `volume_type`, `volume_size`, `encrypted`, `iops`, `throughput`, `kms_key_id`"},"runner_tags":{"default":{},"description":"Map of tags that will be added to runner EC2 instances."},"runner_yum_update":{"default":true,"description":"Run a yum update as part of starting the runner"},"runners_add_dind_volumes":{"default":false,"description":"Add certificates and docker.sock to the volumes to support docker-in-docker (dind)"},"runners_additional_volumes":{"default":[],"description":"Additional volumes that will be used in the runner config.toml, e.g Docker socket"},"runners_check_interval":{"default":3,"description":"defines the interval length, in seconds, between new jobs check."},"runners_clone_url":{"default":"","description":"Overwrites the URL for the GitLab instance. Use only if the runner cant connect to the GitLab URL."},"runners_concurrent":{"default":10,"description":"Concurrent value for the runners, will be used in the runner config.toml."},"runners_disable_cache":{"default":false,"description":"Runners will not use local cache, will be used in the runner config.toml"},"runners_docker_registry_mirror":{"default":"","description":"The docker registry mirror to use to avoid rate limiting by hub.docker.com"},"runners_docker_runtime":{"default":"","description":"docker runtime for runners, will be used in the runner config.toml"},"runners_docker_services":{"default":[],"description":"adds `runners.docker.services` blocks to config.toml.  All fields must be set (examine the Dockerfile of the service image for the entrypoint - see ./examples/runner-default/main.tf)"},"runners_ebs_optimized":{"default":true,"description":"Enable runners to be EBS-optimized."},"runners_environment_vars":{"default":[],"description":"Environment variables during build execution, e.g. KEY=Value, see runner-public example. Will be used in the runner config.toml"},"runners_executor":{"default":"docker+machine","description":"The executor to use. Currently supports `docker+machine` or `docker`."},"runners_extra_hosts":{"default":[],"description":"Extra hosts that will be used in the runner config.toml, e.g other-host:127.0.0.1"},"runners_gitlab_url":{"description":"URL of the GitLab instance to connect to."},"runners_helper_image":{"default":"","description":"Overrides the default helper image used to clone repos and upload artifacts, will be used in the runner config.toml"},"runners_iam_instance_profile_name":{"default":"","description":"IAM instance profile name of the runners, will be used in the runner config.toml"},"runners_idle_count":{"default":0,"description":"Idle count of the runners, will be used in the runner config.toml."},"runners_idle_time":{"default":600,"description":"Idle time of the runners, will be used in the runner config.toml."},"runners_image":{"default":"docker:18.03.1-ce","description":"Image to run builds, will be used in the runner config.toml"},"runners_install_amazon_ecr_credential_helper":{"default":false,"description":"Install amazon-ecr-credential-helper inside `userdata_pre_install` script"},"runners_limit":{"default":0,"description":"Limit for the runners, will be used in the runner config.toml."},"runners_machine_autoscaling":{"default":[],"description":"Set autoscaling parameters based on periods, see https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runnersmachine-section"},"runners_max_builds":{"default":0,"description":"Max builds for each runner after which it will be removed, will be used in the runner config.toml. By default set to 0, no maxBuilds will be set in the configuration."},"runners_monitoring":{"default":false,"description":"Enable detailed cloudwatch monitoring for spot instances."},"runners_name":{"description":"Name of the runner, will be used in the runner config.toml."},"runners_output_limit":{"default":4096,"description":"Sets the maximum build log size in kilobytes, by default set to 4096 (4MB)."},"runners_post_build_script":{"default":"\"\"","description":"Commands to be executed on the Runner just after executing the build, but before executing after_script. "},"runners_pre_build_script":{"default":"\"\"","description":"Script to execute in the pipeline just before the build, will be used in the runner config.toml"},"runners_pre_clone_script":{"default":"\"\"","description":"Commands to be executed on the Runner before cloning the Git repository. this can be used to adjust the Git client configuration first, for example. "},"runners_privileged":{"default":true,"description":"Runners will run in privileged mode, will be used in the runner config.toml"},"runners_pull_policies":{"default":["always"],"description":"pull policies for the runners, will be used in the runner config.toml, for Gitlab Runner \u003e= 13.8, see https://docs.gitlab.com/runner/executors/docker.html#using-multiple-pull-policies "},"runners_pull_policy":{"default":"","description":"Deprecated! Use runners_pull_policies instead. pull_policy for the runners, will be used in the runner config.toml"},"runners_request_concurrency":{"default":1,"description":"Limit number of concurrent requests for new jobs from GitLab (default 1)."},"runners_request_spot_instance":{"default":true,"description":"Whether or not to request spot instances via docker-machine"},"runners_root_size":{"default":16,"description":"Runner instance root size in GB."},"runners_services_volumes_tmpfs":{"default":[],"description":"Mount a tmpfs in gitlab service container. https://docs.gitlab.com/runner/executors/docker.html#mounting-a-directory-in-ram"},"runners_shm_size":{"default":0,"description":"shm_size for the runners, will be used in the runner config.toml"},"runners_token":{"default":"__REPLACED_BY_USER_DATA__","description":"Token for the runner, will be used in the runner config.toml."},"runners_use_private_address":{"default":true,"description":"Restrict runners to the use of a private IP address. If `runner_agent_uses_private_address` is set to `true`(default), `runners_use_private_address` will also apply for the agent."},"runners_userdata":{"default":"","description":"Cloud-init user data that will be passed to the runner ec2 instance. Available only for `docker+machine` driver. Should not be base64 encrypted."},"runners_volume_type":{"default":"gp2","description":"Runner instance volume type"},"runners_volumes_tmpfs":{"default":[],"description":"Mount a tmpfs in runner container. https://docs.gitlab.com/runner/executors/docker.html#mounting-a-directory-in-ram"},"schedule_config":{"default":{"scale_in_count":"0","scale_in_recurrence":"0 18 * * 1-5","scale_out_count":"1","scale_out_recurrence":"0 8 * * 1-5"},"description":"Map containing the configuration of the ASG scale-out and scale-in for the runner instance. Will only be used if enable_schedule is set to true. "},"secure_parameter_store_runner_sentry_dsn":{"default":"sentry-dsn","description":"The Sentry DSN name used to store the Sentry DSN in Secure Parameter Store"},"secure_parameter_store_runner_token_key":{"default":"runner-token","description":"The key name used store the Gitlab runner token in Secure Parameter Store"},"sentry_dsn":{"default":"__SENTRY_DSN_REPLACED_BY_USER_DATA__","description":"Sentry DSN of the project for the runner to use (uses legacy DSN format)"},"subnet_id":{"default":"","description":"Subnet id used for the runner and executors. Must belong to the VPC specified above."},"subnet_id_runners":{"default":"","description":"Deprecated! Use subnet_id instead. List of subnets used for hosting the gitlab-runners."},"subnet_ids_gitlab_runner":{"default":[],"description":"Deprecated! Use subnet_id instead. Subnet used for hosting the GitLab runner."},"tags":{"default":{},"description":"Map of tags that will be added to created resources. By default resources will be tagged with name and environment."},"userdata_post_install":{"default":"","description":"User-data script snippet to insert after GitLab runner install"},"userdata_pre_install":{"default":"","description":"User-data script snippet to insert before GitLab runner install"},"vpc_id":{"description":"The target VPC for the docker-machine and runner instances."}}}},"vpc":{"source":"terraform-aws-modules/vpc/aws","expressions":{"azs":{"references":["data.aws_availability_zones.available.names[0]","data.aws_availability_zones.available.names","data.aws_availability_zones.available"]},"cidr":{"constant_value":"10.0.0.0/16"},"enable_nat_gateway":{"constant_value":true},"name":{"references":["var.environment"]},"private_subnets":{"constant_value":["10.0.1.0/24"]},"public_subnets":{"constant_value":["10.0.101.0/24"]},"single_nat_gateway":{"constant_value":true},"tags":{"constant_value":{"Environment":"setup"}}},"module":{"outputs":{"azs":{"expression":{"references":["var.azs"]},"description":"A list of availability zones specified as argument to this module"},"cgw_arns":{"expression":{"references":["aws_customer_gateway.this"]},"description":"List of ARNs of Customer Gateway"},"cgw_ids":{"expression":{"references":["aws_customer_gateway.this"]},"description":"List of IDs of Customer Gateway"},"database_internet_gateway_route_id":{"expression":{"references":["aws_route.database_internet_gateway[0].id","aws_route.database_internet_gateway[0]","aws_route.database_internet_gateway"]},"description":"ID of the database internet gateway route"},"database_ipv6_egress_route_id":{"expression":{"references":["aws_route.database_ipv6_egress[0].id","aws_route.database_ipv6_egress[0]","aws_route.database_ipv6_egress"]},"description":"ID of the database IPv6 egress route"},"database_nat_gateway_route_ids":{"expression":{"references":["aws_route.database_nat_gateway"]},"description":"List of IDs of the database nat gateway route"},"database_network_acl_arn":{"expression":{"references":["aws_network_acl.database[0].arn","aws_network_acl.database[0]","aws_network_acl.database"]},"description":"ARN of the database network ACL"},"database_network_acl_id":{"expression":{"references":["aws_network_acl.database[0].id","aws_network_acl.database[0]","aws_network_acl.database"]},"description":"ID of the database network ACL"},"database_route_table_association_ids":{"expression":{"references":["aws_route_table_association.database"]},"description":"List of IDs of the database route table association"},"database_route_table_ids":{"expression":{"references":["aws_route_table.database","aws_route_table.private"]},"description":"List of IDs of database route tables"},"database_subnet_arns":{"expression":{"references":["aws_subnet.database"]},"description":"List of ARNs of database subnets"},"database_subnet_group":{"expression":{"references":["aws_db_subnet_group.database[0].id","aws_db_subnet_group.database[0]","aws_db_subnet_group.database"]},"description":"ID of database subnet group"},"database_subnet_group_name":{"expression":{"references":["aws_db_subnet_group.database[0].name","aws_db_subnet_group.database[0]","aws_db_subnet_group.database"]},"description":"Name of database subnet group"},"database_subnets":{"expression":{"references":["aws_subnet.database"]},"description":"List of IDs of database subnets"},"database_subnets_cidr_blocks":{"expression":{"references":["aws_subnet.database"]},"description":"List of cidr_blocks of database subnets"},"database_subnets_ipv6_cidr_blocks":{"expression":{"references":["aws_subnet.database"]},"description":"List of IPv6 cidr_blocks of database subnets in an IPv6 enabled VPC"},"default_network_acl_id":{"expression":{"references":["aws_vpc.this[0].default_network_acl_id","aws_vpc.this[0]","aws_vpc.this"]},"description":"The ID of the default network ACL"},"default_route_table_id":{"expression":{"references":["aws_vpc.this[0].default_route_table_id","aws_vpc.this[0]","aws_vpc.this"]},"description":"The ID of the default route table"},"default_security_group_id":{"expression":{"references":["aws_vpc.this[0].default_security_group_id","aws_vpc.this[0]","aws_vpc.this"]},"description":"The ID of the security group created by default on VPC creation"},"default_vpc_arn":{"expression":{"references":["aws_default_vpc.this[0].arn","aws_default_vpc.this[0]","aws_default_vpc.this"]},"description":"The ARN of the Default VPC"},"default_vpc_cidr_block":{"expression":{"references":["aws_default_vpc.this[0].cidr_block","aws_default_vpc.this[0]","aws_default_vpc.this"]},"description":"The CIDR block of the Default VPC"},"default_vpc_default_network_acl_id":{"expression":{"references":["aws_default_vpc.this[0].default_network_acl_id","aws_default_vpc.this[0]","aws_default_vpc.this"]},"description":"The ID of the default network ACL of the Default VPC"},"default_vpc_default_route_table_id":{"expression":{"references":["aws_default_vpc.this[0].default_route_table_id","aws_default_vpc.this[0]","aws_default_vpc.this"]},"description":"The ID of the default route table of the Default VPC"},"default_vpc_default_security_group_id":{"expression":{"references":["aws_default_vpc.this[0].default_security_group_id","aws_default_vpc.this[0]","aws_default_vpc.this"]},"description":"The ID of the security group created by default on Default VPC creation"},"default_vpc_enable_dns_hostnames":{"expression":{"references":["aws_default_vpc.this[0].enable_dns_hostnames","aws_default_vpc.this[0]","aws_default_vpc.this"]},"description":"Whether or not the Default VPC has DNS hostname support"},"default_vpc_enable_dns_support":{"expression":{"references":["aws_default_vpc.this[0].enable_dns_support","aws_default_vpc.this[0]","aws_default_vpc.this"]},"description":"Whether or not the Default VPC has DNS support"},"default_vpc_id":{"expression":{"references":["aws_default_vpc.this[0].id","aws_default_vpc.this[0]","aws_default_vpc.this"]},"description":"The ID of the Default VPC"},"default_vpc_instance_tenancy":{"expression":{"references":["aws_default_vpc.this[0].instance_tenancy","aws_default_vpc.this[0]","aws_default_vpc.this"]},"description":"Tenancy of instances spin up within Default VPC"},"default_vpc_main_route_table_id":{"expression":{"references":["aws_default_vpc.this[0].main_route_table_id","aws_default_vpc.this[0]","aws_default_vpc.this"]},"description":"The ID of the main route table associated with the Default VPC"},"dhcp_options_id":{"expression":{"references":["aws_vpc_dhcp_options.this[0].id","aws_vpc_dhcp_options.this[0]","aws_vpc_dhcp_options.this"]},"description":"The ID of the DHCP options"},"egress_only_internet_gateway_id":{"expression":{"references":["aws_egress_only_internet_gateway.this[0].id","aws_egress_only_internet_gateway.this[0]","aws_egress_only_internet_gateway.this"]},"description":"The ID of the egress only Internet Gateway"},"elasticache_network_acl_arn":{"expression":{"references":["aws_network_acl.elasticache[0].arn","aws_network_acl.elasticache[0]","aws_network_acl.elasticache"]},"description":"ARN of the elasticache network ACL"},"elasticache_network_acl_id":{"expression":{"references":["aws_network_acl.elasticache[0].id","aws_network_acl.elasticache[0]","aws_network_acl.elasticache"]},"description":"ID of the elasticache network ACL"},"elasticache_route_table_association_ids":{"expression":{"references":["aws_route_table_association.elasticache"]},"description":"List of IDs of the elasticache route table association"},"elasticache_route_table_ids":{"expression":{"references":["aws_route_table.elasticache","aws_route_table.private"]},"description":"List of IDs of elasticache route tables"},"elasticache_subnet_arns":{"expression":{"references":["aws_subnet.elasticache"]},"description":"List of ARNs of elasticache subnets"},"elasticache_subnet_group":{"expression":{"references":["aws_elasticache_subnet_group.elasticache[0].id","aws_elasticache_subnet_group.elasticache[0]","aws_elasticache_subnet_group.elasticache"]},"description":"ID of elasticache subnet group"},"elasticache_subnet_group_name":{"expression":{"references":["aws_elasticache_subnet_group.elasticache[0].name","aws_elasticache_subnet_group.elasticache[0]","aws_elasticache_subnet_group.elasticache"]},"description":"Name of elasticache subnet group"},"elasticache_subnets":{"expression":{"references":["aws_subnet.elasticache"]},"description":"List of IDs of elasticache subnets"},"elasticache_subnets_cidr_blocks":{"expression":{"references":["aws_subnet.elasticache"]},"description":"List of cidr_blocks of elasticache subnets"},"elasticache_subnets_ipv6_cidr_blocks":{"expression":{"references":["aws_subnet.elasticache"]},"description":"List of IPv6 cidr_blocks of elasticache subnets in an IPv6 enabled VPC"},"igw_arn":{"expression":{"references":["aws_internet_gateway.this[0].arn","aws_internet_gateway.this[0]","aws_internet_gateway.this"]},"description":"The ARN of the Internet Gateway"},"igw_id":{"expression":{"references":["aws_internet_gateway.this[0].id","aws_internet_gateway.this[0]","aws_internet_gateway.this"]},"description":"The ID of the Internet Gateway"},"intra_network_acl_arn":{"expression":{"references":["aws_network_acl.intra[0].arn","aws_network_acl.intra[0]","aws_network_acl.intra"]},"description":"ARN of the intra network ACL"},"intra_network_acl_id":{"expression":{"references":["aws_network_acl.intra[0].id","aws_network_acl.intra[0]","aws_network_acl.intra"]},"description":"ID of the intra network ACL"},"intra_route_table_association_ids":{"expression":{"references":["aws_route_table_association.intra"]},"description":"List of IDs of the intra route table association"},"intra_route_table_ids":{"expression":{"references":["aws_route_table.intra"]},"description":"List of IDs of intra route tables"},"intra_subnet_arns":{"expression":{"references":["aws_subnet.intra"]},"description":"List of ARNs of intra subnets"},"intra_subnets":{"expression":{"references":["aws_subnet.intra"]},"description":"List of IDs of intra subnets"},"intra_subnets_cidr_blocks":{"expression":{"references":["aws_subnet.intra"]},"description":"List of cidr_blocks of intra subnets"},"intra_subnets_ipv6_cidr_blocks":{"expression":{"references":["aws_subnet.intra"]},"description":"List of IPv6 cidr_blocks of intra subnets in an IPv6 enabled VPC"},"name":{"expression":{"references":["var.name"]},"description":"The name of the VPC specified as argument to this module"},"nat_ids":{"expression":{"references":["aws_eip.nat"]},"description":"List of allocation ID of Elastic IPs created for AWS NAT Gateway"},"nat_public_ips":{"expression":{"references":["var.reuse_nat_ips","var.external_nat_ips","aws_eip.nat"]},"description":"List of public Elastic IPs created for AWS NAT Gateway"},"natgw_ids":{"expression":{"references":["aws_nat_gateway.this"]},"description":"List of NAT Gateway IDs"},"outpost_network_acl_arn":{"expression":{"references":["aws_network_acl.outpost[0].arn","aws_network_acl.outpost[0]","aws_network_acl.outpost"]},"description":"ARN of the outpost network ACL"},"outpost_network_acl_id":{"expression":{"references":["aws_network_acl.outpost[0].id","aws_network_acl.outpost[0]","aws_network_acl.outpost"]},"description":"ID of the outpost network ACL"},"outpost_subnet_arns":{"expression":{"references":["aws_subnet.outpost"]},"description":"List of ARNs of outpost subnets"},"outpost_subnets":{"expression":{"references":["aws_subnet.outpost"]},"description":"List of IDs of outpost subnets"},"outpost_subnets_cidr_blocks":{"expression":{"references":["aws_subnet.outpost"]},"description":"List of cidr_blocks of outpost subnets"},"outpost_subnets_ipv6_cidr_blocks":{"expression":{"references":["aws_subnet.outpost"]},"description":"List of IPv6 cidr_blocks of outpost subnets in an IPv6 enabled VPC"},"private_ipv6_egress_route_ids":{"expression":{"references":["aws_route.private_ipv6_egress"]},"description":"List of IDs of the ipv6 egress route"},"private_nat_gateway_route_ids":{"expression":{"references":["aws_route.private_nat_gateway"]},"description":"List of IDs of the private nat gateway route"},"private_network_acl_arn":{"expression":{"references":["aws_network_acl.private[0].arn","aws_network_acl.private[0]","aws_network_acl.private"]},"description":"ARN of the private network ACL"},"private_network_acl_id":{"expression":{"references":["aws_network_acl.private[0].id","aws_network_acl.private[0]","aws_network_acl.private"]},"description":"ID of the private network ACL"},"private_route_table_association_ids":{"expression":{"references":["aws_route_table_association.private"]},"description":"List of IDs of the private route table association"},"private_route_table_ids":{"expression":{"references":["aws_route_table.private"]},"description":"List of IDs of private route tables"},"private_subnet_arns":{"expression":{"references":["aws_subnet.private"]},"description":"List of ARNs of private subnets"},"private_subnets":{"expression":{"references":["aws_subnet.private"]},"description":"List of IDs of private subnets"},"private_subnets_cidr_blocks":{"expression":{"references":["aws_subnet.private"]},"description":"List of cidr_blocks of private subnets"},"private_subnets_ipv6_cidr_blocks":{"expression":{"references":["aws_subnet.private"]},"description":"List of IPv6 cidr_blocks of private subnets in an IPv6 enabled VPC"},"public_internet_gateway_ipv6_route_id":{"expression":{"references":["aws_route.public_internet_gateway_ipv6[0].id","aws_route.public_internet_gateway_ipv6[0]","aws_route.public_internet_gateway_ipv6"]},"description":"ID of the IPv6 internet gateway route"},"public_internet_gateway_route_id":{"expression":{"references":["aws_route.public_internet_gateway[0].id","aws_route.public_internet_gateway[0]","aws_route.public_internet_gateway"]},"description":"ID of the internet gateway route"},"public_network_acl_arn":{"expression":{"references":["aws_network_acl.public[0].arn","aws_network_acl.public[0]","aws_network_acl.public"]},"description":"ARN of the public network ACL"},"public_network_acl_id":{"expression":{"references":["aws_network_acl.public[0].id","aws_network_acl.public[0]","aws_network_acl.public"]},"description":"ID of the public network ACL"},"public_route_table_association_ids":{"expression":{"references":["aws_route_table_association.public"]},"description":"List of IDs of the public route table association"},"public_route_table_ids":{"expression":{"references":["aws_route_table.public"]},"description":"List of IDs of public route tables"},"public_subnet_arns":{"expression":{"references":["aws_subnet.public"]},"description":"List of ARNs of public subnets"},"public_subnets":{"expression":{"references":["aws_subnet.public"]},"description":"List of IDs of public subnets"},"public_subnets_cidr_blocks":{"expression":{"references":["aws_subnet.public"]},"description":"List of cidr_blocks of public subnets"},"public_subnets_ipv6_cidr_blocks":{"expression":{"references":["aws_subnet.public"]},"description":"List of IPv6 cidr_blocks of public subnets in an IPv6 enabled VPC"},"redshift_network_acl_arn":{"expression":{"references":["aws_network_acl.redshift[0].arn","aws_network_acl.redshift[0]","aws_network_acl.redshift"]},"description":"ARN of the redshift network ACL"},"redshift_network_acl_id":{"expression":{"references":["aws_network_acl.redshift[0].id","aws_network_acl.redshift[0]","aws_network_acl.redshift"]},"description":"ID of the redshift network ACL"},"redshift_public_route_table_association_ids":{"expression":{"references":["aws_route_table_association.redshift_public"]},"description":"List of IDs of the public redshift route table association"},"redshift_route_table_association_ids":{"expression":{"references":["aws_route_table_association.redshift"]},"description":"List of IDs of the redshift route table association"},"redshift_route_table_ids":{"expression":{"references":["aws_route_table.redshift","aws_route_table.redshift","var.enable_public_redshift","aws_route_table.public","aws_route_table.private"]},"description":"List of IDs of redshift route tables"},"redshift_subnet_arns":{"expression":{"references":["aws_subnet.redshift"]},"description":"List of ARNs of redshift subnets"},"redshift_subnet_group":{"expression":{"references":["aws_redshift_subnet_group.redshift[0].id","aws_redshift_subnet_group.redshift[0]","aws_redshift_subnet_group.redshift"]},"description":"ID of redshift subnet group"},"redshift_subnets":{"expression":{"references":["aws_subnet.redshift"]},"description":"List of IDs of redshift subnets"},"redshift_subnets_cidr_blocks":{"expression":{"references":["aws_subnet.redshift"]},"description":"List of cidr_blocks of redshift subnets"},"redshift_subnets_ipv6_cidr_blocks":{"expression":{"references":["aws_subnet.redshift"]},"description":"List of IPv6 cidr_blocks of redshift subnets in an IPv6 enabled VPC"},"this_customer_gateway":{"expression":{"references":["aws_customer_gateway.this"]},"description":"Map of Customer Gateway attributes"},"vgw_arn":{"expression":{"references":["aws_vpn_gateway.this[0].arn","aws_vpn_gateway.this[0]","aws_vpn_gateway.this"]},"description":"The ARN of the VPN Gateway"},"vgw_id":{"expression":{"references":["aws_vpn_gateway.this[0].id","aws_vpn_gateway.this[0]","aws_vpn_gateway.this","aws_vpn_gateway_attachment.this[0].vpn_gateway_id","aws_vpn_gateway_attachment.this[0]","aws_vpn_gateway_attachment.this"]},"description":"The ID of the VPN Gateway"},"vpc_arn":{"expression":{"references":["aws_vpc.this[0].arn","aws_vpc.this[0]","aws_vpc.this"]},"description":"The ARN of the VPC"},"vpc_cidr_block":{"expression":{"references":["aws_vpc.this[0].cidr_block","aws_vpc.this[0]","aws_vpc.this"]},"description":"The CIDR block of the VPC"},"vpc_enable_dns_hostnames":{"expression":{"references":["aws_vpc.this[0].enable_dns_hostnames","aws_vpc.this[0]","aws_vpc.this"]},"description":"Whether or not the VPC has DNS hostname support"},"vpc_enable_dns_support":{"expression":{"references":["aws_vpc.this[0].enable_dns_support","aws_vpc.this[0]","aws_vpc.this"]},"description":"Whether or not the VPC has DNS support"},"vpc_flow_log_cloudwatch_iam_role_arn":{"expression":{"references":["local.flow_log_iam_role_arn"]},"description":"The ARN of the IAM role used when pushing logs to Cloudwatch log group"},"vpc_flow_log_destination_arn":{"expression":{"references":["local.flow_log_destination_arn"]},"description":"The ARN of the destination for VPC Flow Logs"},"vpc_flow_log_destination_type":{"expression":{"references":["var.flow_log_destination_type"]},"description":"The type of the destination for VPC Flow Logs"},"vpc_flow_log_id":{"expression":{"references":["aws_flow_log.this[0].id","aws_flow_log.this[0]","aws_flow_log.this"]},"description":"The ID of the Flow Log resource"},"vpc_id":{"expression":{"references":["aws_vpc.this[0].id","aws_vpc.this[0]","aws_vpc.this"]},"description":"The ID of the VPC"},"vpc_instance_tenancy":{"expression":{"references":["aws_vpc.this[0].instance_tenancy","aws_vpc.this[0]","aws_vpc.this"]},"description":"Tenancy of instances spin up within VPC"},"vpc_ipv6_association_id":{"expression":{"references":["aws_vpc.this[0].ipv6_association_id","aws_vpc.this[0]","aws_vpc.this"]},"description":"The association ID for the IPv6 CIDR block"},"vpc_ipv6_cidr_block":{"expression":{"references":["aws_vpc.this[0].ipv6_cidr_block","aws_vpc.this[0]","aws_vpc.this"]},"description":"The IPv6 CIDR block"},"vpc_main_route_table_id":{"expression":{"references":["aws_vpc.this[0].main_route_table_id","aws_vpc.this[0]","aws_vpc.this"]},"description":"The ID of the main route table associated with this VPC"},"vpc_owner_id":{"expression":{"references":["aws_vpc.this[0].owner_id","aws_vpc.this[0]","aws_vpc.this"]},"description":"The ID of the AWS account that owns the VPC"},"vpc_secondary_cidr_blocks":{"expression":{"references":["aws_vpc_ipv4_cidr_block_association.this"]},"description":"List of secondary CIDR blocks of the VPC"}},"resources":[{"address":"aws_cloudwatch_log_group.flow_log","mode":"managed","type":"aws_cloudwatch_log_group","name":"flow_log","provider_config_key":"aws","expressions":{"kms_key_id":{"references":["var.flow_log_cloudwatch_log_group_kms_key_id"]},"name":{"references":["var.flow_log_cloudwatch_log_group_name_prefix","local.flow_log_cloudwatch_log_group_name_suffix"]},"retention_in_days":{"references":["var.flow_log_cloudwatch_log_group_retention_in_days"]},"tags":{"references":["var.tags","var.vpc_flow_log_tags"]}},"schema_version":0,"count_expression":{"references":["local.create_flow_log_cloudwatch_log_group"]}},{"address":"aws_customer_gateway.this","mode":"managed","type":"aws_customer_gateway","name":"this","provider_config_key":"aws","expressions":{"bgp_asn":{"references":["each.value[\"bgp_asn\"]","each.value"]},"device_name":{"references":["each.value"]},"ip_address":{"references":["each.value[\"ip_address\"]","each.value"]},"tags":{"references":["var.name","each.key","var.tags","var.customer_gateway_tags"]},"type":{"constant_value":"ipsec.1"}},"schema_version":0,"for_each_expression":{"references":["var.customer_gateways"]}},{"address":"aws_db_subnet_group.database","mode":"managed","type":"aws_db_subnet_group","name":"database","provider_config_key":"aws","expressions":{"description":{"references":["var.name"]},"name":{"references":["var.database_subnet_group_name","var.name"]},"subnet_ids":{"references":["aws_subnet.database"]},"tags":{"references":["var.database_subnet_group_name","var.name","var.tags","var.database_subnet_group_tags"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.database_subnets","var.create_database_subnet_group"]}},{"address":"aws_default_network_acl.this","mode":"managed","type":"aws_default_network_acl","name":"this","provider_config_key":"aws","expressions":{"default_network_acl_id":{"references":["aws_vpc.this[0].default_network_acl_id","aws_vpc.this[0]","aws_vpc.this"]},"subnet_ids":{"constant_value":null},"tags":{"references":["var.default_network_acl_name","var.name","var.tags","var.default_network_acl_tags"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.manage_default_network_acl"]}},{"address":"aws_default_route_table.default","mode":"managed","type":"aws_default_route_table","name":"default","provider_config_key":"aws","expressions":{"default_route_table_id":{"references":["aws_vpc.this[0].default_route_table_id","aws_vpc.this[0]","aws_vpc.this"]},"propagating_vgws":{"references":["var.default_route_table_propagating_vgws"]},"tags":{"references":["var.default_route_table_name","var.name","var.tags","var.default_route_table_tags"]},"timeouts":{"create":{"constant_value":"5m"},"update":{"constant_value":"5m"}}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.manage_default_route_table"]}},{"address":"aws_default_security_group.this","mode":"managed","type":"aws_default_security_group","name":"this","provider_config_key":"aws","expressions":{"tags":{"references":["var.default_security_group_name","var.name","var.tags","var.default_security_group_tags"]},"vpc_id":{"references":["aws_vpc.this[0].id","aws_vpc.this[0]","aws_vpc.this"]}},"schema_version":1,"count_expression":{"references":["local.create_vpc","var.manage_default_security_group"]}},{"address":"aws_default_vpc.this","mode":"managed","type":"aws_default_vpc","name":"this","provider_config_key":"aws","expressions":{"enable_classiclink":{"constant_value":null},"enable_dns_hostnames":{"references":["var.default_vpc_enable_dns_hostnames"]},"enable_dns_support":{"references":["var.default_vpc_enable_dns_support"]},"tags":{"references":["var.default_vpc_name","var.tags","var.default_vpc_tags"]}},"schema_version":1,"count_expression":{"references":["var.manage_default_vpc"]}},{"address":"aws_egress_only_internet_gateway.this","mode":"managed","type":"aws_egress_only_internet_gateway","name":"this","provider_config_key":"aws","expressions":{"tags":{"references":["var.name","var.tags","var.igw_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.create_egress_only_igw","var.enable_ipv6","local.max_subnet_length"]}},{"address":"aws_eip.nat","mode":"managed","type":"aws_eip","name":"nat","provider_config_key":"aws","expressions":{"tags":{"references":["var.name","var.azs","var.single_nat_gateway","count.index","var.tags","var.nat_eip_tags"]},"vpc":{"constant_value":true}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.enable_nat_gateway","var.reuse_nat_ips","local.nat_gateway_count"]}},{"address":"aws_elasticache_subnet_group.elasticache","mode":"managed","type":"aws_elasticache_subnet_group","name":"elasticache","provider_config_key":"aws","expressions":{"description":{"references":["var.name"]},"name":{"references":["var.elasticache_subnet_group_name","var.name"]},"subnet_ids":{"references":["aws_subnet.elasticache"]},"tags":{"references":["var.elasticache_subnet_group_name","var.name","var.tags","var.elasticache_subnet_group_tags"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.elasticache_subnets","var.create_elasticache_subnet_group"]}},{"address":"aws_flow_log.this","mode":"managed","type":"aws_flow_log","name":"this","provider_config_key":"aws","expressions":{"iam_role_arn":{"references":["local.flow_log_iam_role_arn"]},"log_destination":{"references":["local.flow_log_destination_arn"]},"log_destination_type":{"references":["var.flow_log_destination_type"]},"log_format":{"references":["var.flow_log_log_format"]},"max_aggregation_interval":{"references":["var.flow_log_max_aggregation_interval"]},"tags":{"references":["var.tags","var.vpc_flow_log_tags"]},"traffic_type":{"references":["var.flow_log_traffic_type"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.enable_flow_log"]}},{"address":"aws_iam_policy.vpc_flow_log_cloudwatch","mode":"managed","type":"aws_iam_policy","name":"vpc_flow_log_cloudwatch","provider_config_key":"aws","expressions":{"name_prefix":{"constant_value":"vpc-flow-log-to-cloudwatch-"},"policy":{"references":["data.aws_iam_policy_document.vpc_flow_log_cloudwatch[0].json","data.aws_iam_policy_document.vpc_flow_log_cloudwatch[0]","data.aws_iam_policy_document.vpc_flow_log_cloudwatch"]},"tags":{"references":["var.tags","var.vpc_flow_log_tags"]}},"schema_version":0,"count_expression":{"references":["local.create_flow_log_cloudwatch_iam_role"]}},{"address":"aws_iam_role.vpc_flow_log_cloudwatch","mode":"managed","type":"aws_iam_role","name":"vpc_flow_log_cloudwatch","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.flow_log_cloudwatch_assume_role[0].json","data.aws_iam_policy_document.flow_log_cloudwatch_assume_role[0]","data.aws_iam_policy_document.flow_log_cloudwatch_assume_role"]},"name_prefix":{"constant_value":"vpc-flow-log-role-"},"permissions_boundary":{"references":["var.vpc_flow_log_permissions_boundary"]},"tags":{"references":["var.tags","var.vpc_flow_log_tags"]}},"schema_version":0,"count_expression":{"references":["local.create_flow_log_cloudwatch_iam_role"]}},{"address":"aws_iam_role_policy_attachment.vpc_flow_log_cloudwatch","mode":"managed","type":"aws_iam_role_policy_attachment","name":"vpc_flow_log_cloudwatch","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.vpc_flow_log_cloudwatch[0].arn","aws_iam_policy.vpc_flow_log_cloudwatch[0]","aws_iam_policy.vpc_flow_log_cloudwatch"]},"role":{"references":["aws_iam_role.vpc_flow_log_cloudwatch[0].name","aws_iam_role.vpc_flow_log_cloudwatch[0]","aws_iam_role.vpc_flow_log_cloudwatch"]}},"schema_version":0,"count_expression":{"references":["local.create_flow_log_cloudwatch_iam_role"]}},{"address":"aws_internet_gateway.this","mode":"managed","type":"aws_internet_gateway","name":"this","provider_config_key":"aws","expressions":{"tags":{"references":["var.name","var.tags","var.igw_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.create_igw","var.public_subnets"]}},{"address":"aws_nat_gateway.this","mode":"managed","type":"aws_nat_gateway","name":"this","provider_config_key":"aws","expressions":{"allocation_id":{"references":["local.nat_gateway_ips","var.single_nat_gateway","count.index"]},"subnet_id":{"references":["aws_subnet.public","var.single_nat_gateway","count.index"]},"tags":{"references":["var.name","var.azs","var.single_nat_gateway","count.index","var.tags","var.nat_gateway_tags"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.enable_nat_gateway","local.nat_gateway_count"]},"depends_on":["aws_internet_gateway.this"]},{"address":"aws_network_acl.database","mode":"managed","type":"aws_network_acl","name":"database","provider_config_key":"aws","expressions":{"subnet_ids":{"references":["aws_subnet.database"]},"tags":{"references":["var.name","var.database_subnet_suffix","var.tags","var.database_acl_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.database_dedicated_network_acl","var.database_subnets"]}},{"address":"aws_network_acl.elasticache","mode":"managed","type":"aws_network_acl","name":"elasticache","provider_config_key":"aws","expressions":{"subnet_ids":{"references":["aws_subnet.elasticache"]},"tags":{"references":["var.name","var.elasticache_subnet_suffix","var.tags","var.elasticache_acl_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.elasticache_dedicated_network_acl","var.elasticache_subnets"]}},{"address":"aws_network_acl.intra","mode":"managed","type":"aws_network_acl","name":"intra","provider_config_key":"aws","expressions":{"subnet_ids":{"references":["aws_subnet.intra"]},"tags":{"references":["var.name","var.intra_subnet_suffix","var.tags","var.intra_acl_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.intra_dedicated_network_acl","var.intra_subnets"]}},{"address":"aws_network_acl.outpost","mode":"managed","type":"aws_network_acl","name":"outpost","provider_config_key":"aws","expressions":{"subnet_ids":{"references":["aws_subnet.outpost"]},"tags":{"references":["var.name","var.outpost_subnet_suffix","var.tags","var.outpost_acl_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.outpost_dedicated_network_acl","var.outpost_subnets"]}},{"address":"aws_network_acl.private","mode":"managed","type":"aws_network_acl","name":"private","provider_config_key":"aws","expressions":{"subnet_ids":{"references":["aws_subnet.private"]},"tags":{"references":["var.name","var.private_subnet_suffix","var.tags","var.private_acl_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.private_dedicated_network_acl","var.private_subnets"]}},{"address":"aws_network_acl.public","mode":"managed","type":"aws_network_acl","name":"public","provider_config_key":"aws","expressions":{"subnet_ids":{"references":["aws_subnet.public"]},"tags":{"references":["var.name","var.public_subnet_suffix","var.tags","var.public_acl_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.public_dedicated_network_acl","var.public_subnets"]}},{"address":"aws_network_acl.redshift","mode":"managed","type":"aws_network_acl","name":"redshift","provider_config_key":"aws","expressions":{"subnet_ids":{"references":["aws_subnet.redshift"]},"tags":{"references":["var.name","var.redshift_subnet_suffix","var.tags","var.redshift_acl_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.redshift_dedicated_network_acl","var.redshift_subnets"]}},{"address":"aws_network_acl_rule.database_inbound","mode":"managed","type":"aws_network_acl_rule","name":"database_inbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.database_inbound_acl_rules","count.index"]},"egress":{"constant_value":false},"from_port":{"references":["var.database_inbound_acl_rules","count.index"]},"icmp_code":{"references":["var.database_inbound_acl_rules","count.index"]},"icmp_type":{"references":["var.database_inbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.database_inbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.database[0].id","aws_network_acl.database[0]","aws_network_acl.database"]},"protocol":{"references":["var.database_inbound_acl_rules","count.index"]},"rule_action":{"references":["var.database_inbound_acl_rules","count.index"]},"rule_number":{"references":["var.database_inbound_acl_rules","count.index"]},"to_port":{"references":["var.database_inbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.database_dedicated_network_acl","var.database_subnets","var.database_inbound_acl_rules"]}},{"address":"aws_network_acl_rule.database_outbound","mode":"managed","type":"aws_network_acl_rule","name":"database_outbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.database_outbound_acl_rules","count.index"]},"egress":{"constant_value":true},"from_port":{"references":["var.database_outbound_acl_rules","count.index"]},"icmp_code":{"references":["var.database_outbound_acl_rules","count.index"]},"icmp_type":{"references":["var.database_outbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.database_outbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.database[0].id","aws_network_acl.database[0]","aws_network_acl.database"]},"protocol":{"references":["var.database_outbound_acl_rules","count.index"]},"rule_action":{"references":["var.database_outbound_acl_rules","count.index"]},"rule_number":{"references":["var.database_outbound_acl_rules","count.index"]},"to_port":{"references":["var.database_outbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.database_dedicated_network_acl","var.database_subnets","var.database_outbound_acl_rules"]}},{"address":"aws_network_acl_rule.elasticache_inbound","mode":"managed","type":"aws_network_acl_rule","name":"elasticache_inbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.elasticache_inbound_acl_rules","count.index"]},"egress":{"constant_value":false},"from_port":{"references":["var.elasticache_inbound_acl_rules","count.index"]},"icmp_code":{"references":["var.elasticache_inbound_acl_rules","count.index"]},"icmp_type":{"references":["var.elasticache_inbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.elasticache_inbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.elasticache[0].id","aws_network_acl.elasticache[0]","aws_network_acl.elasticache"]},"protocol":{"references":["var.elasticache_inbound_acl_rules","count.index"]},"rule_action":{"references":["var.elasticache_inbound_acl_rules","count.index"]},"rule_number":{"references":["var.elasticache_inbound_acl_rules","count.index"]},"to_port":{"references":["var.elasticache_inbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.elasticache_dedicated_network_acl","var.elasticache_subnets","var.elasticache_inbound_acl_rules"]}},{"address":"aws_network_acl_rule.elasticache_outbound","mode":"managed","type":"aws_network_acl_rule","name":"elasticache_outbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.elasticache_outbound_acl_rules","count.index"]},"egress":{"constant_value":true},"from_port":{"references":["var.elasticache_outbound_acl_rules","count.index"]},"icmp_code":{"references":["var.elasticache_outbound_acl_rules","count.index"]},"icmp_type":{"references":["var.elasticache_outbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.elasticache_outbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.elasticache[0].id","aws_network_acl.elasticache[0]","aws_network_acl.elasticache"]},"protocol":{"references":["var.elasticache_outbound_acl_rules","count.index"]},"rule_action":{"references":["var.elasticache_outbound_acl_rules","count.index"]},"rule_number":{"references":["var.elasticache_outbound_acl_rules","count.index"]},"to_port":{"references":["var.elasticache_outbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.elasticache_dedicated_network_acl","var.elasticache_subnets","var.elasticache_outbound_acl_rules"]}},{"address":"aws_network_acl_rule.intra_inbound","mode":"managed","type":"aws_network_acl_rule","name":"intra_inbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.intra_inbound_acl_rules","count.index"]},"egress":{"constant_value":false},"from_port":{"references":["var.intra_inbound_acl_rules","count.index"]},"icmp_code":{"references":["var.intra_inbound_acl_rules","count.index"]},"icmp_type":{"references":["var.intra_inbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.intra_inbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.intra[0].id","aws_network_acl.intra[0]","aws_network_acl.intra"]},"protocol":{"references":["var.intra_inbound_acl_rules","count.index"]},"rule_action":{"references":["var.intra_inbound_acl_rules","count.index"]},"rule_number":{"references":["var.intra_inbound_acl_rules","count.index"]},"to_port":{"references":["var.intra_inbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.intra_dedicated_network_acl","var.intra_subnets","var.intra_inbound_acl_rules"]}},{"address":"aws_network_acl_rule.intra_outbound","mode":"managed","type":"aws_network_acl_rule","name":"intra_outbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.intra_outbound_acl_rules","count.index"]},"egress":{"constant_value":true},"from_port":{"references":["var.intra_outbound_acl_rules","count.index"]},"icmp_code":{"references":["var.intra_outbound_acl_rules","count.index"]},"icmp_type":{"references":["var.intra_outbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.intra_outbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.intra[0].id","aws_network_acl.intra[0]","aws_network_acl.intra"]},"protocol":{"references":["var.intra_outbound_acl_rules","count.index"]},"rule_action":{"references":["var.intra_outbound_acl_rules","count.index"]},"rule_number":{"references":["var.intra_outbound_acl_rules","count.index"]},"to_port":{"references":["var.intra_outbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.intra_dedicated_network_acl","var.intra_subnets","var.intra_outbound_acl_rules"]}},{"address":"aws_network_acl_rule.outpost_inbound","mode":"managed","type":"aws_network_acl_rule","name":"outpost_inbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.outpost_inbound_acl_rules","count.index"]},"egress":{"constant_value":false},"from_port":{"references":["var.outpost_inbound_acl_rules","count.index"]},"icmp_code":{"references":["var.outpost_inbound_acl_rules","count.index"]},"icmp_type":{"references":["var.outpost_inbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.outpost_inbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.outpost[0].id","aws_network_acl.outpost[0]","aws_network_acl.outpost"]},"protocol":{"references":["var.outpost_inbound_acl_rules","count.index"]},"rule_action":{"references":["var.outpost_inbound_acl_rules","count.index"]},"rule_number":{"references":["var.outpost_inbound_acl_rules","count.index"]},"to_port":{"references":["var.outpost_inbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.outpost_dedicated_network_acl","var.outpost_subnets","var.outpost_inbound_acl_rules"]}},{"address":"aws_network_acl_rule.outpost_outbound","mode":"managed","type":"aws_network_acl_rule","name":"outpost_outbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.outpost_outbound_acl_rules","count.index"]},"egress":{"constant_value":true},"from_port":{"references":["var.outpost_outbound_acl_rules","count.index"]},"icmp_code":{"references":["var.outpost_outbound_acl_rules","count.index"]},"icmp_type":{"references":["var.outpost_outbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.outpost_outbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.outpost[0].id","aws_network_acl.outpost[0]","aws_network_acl.outpost"]},"protocol":{"references":["var.outpost_outbound_acl_rules","count.index"]},"rule_action":{"references":["var.outpost_outbound_acl_rules","count.index"]},"rule_number":{"references":["var.outpost_outbound_acl_rules","count.index"]},"to_port":{"references":["var.outpost_outbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.outpost_dedicated_network_acl","var.outpost_subnets","var.outpost_outbound_acl_rules"]}},{"address":"aws_network_acl_rule.private_inbound","mode":"managed","type":"aws_network_acl_rule","name":"private_inbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.private_inbound_acl_rules","count.index"]},"egress":{"constant_value":false},"from_port":{"references":["var.private_inbound_acl_rules","count.index"]},"icmp_code":{"references":["var.private_inbound_acl_rules","count.index"]},"icmp_type":{"references":["var.private_inbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.private_inbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.private[0].id","aws_network_acl.private[0]","aws_network_acl.private"]},"protocol":{"references":["var.private_inbound_acl_rules","count.index"]},"rule_action":{"references":["var.private_inbound_acl_rules","count.index"]},"rule_number":{"references":["var.private_inbound_acl_rules","count.index"]},"to_port":{"references":["var.private_inbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.private_dedicated_network_acl","var.private_subnets","var.private_inbound_acl_rules"]}},{"address":"aws_network_acl_rule.private_outbound","mode":"managed","type":"aws_network_acl_rule","name":"private_outbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.private_outbound_acl_rules","count.index"]},"egress":{"constant_value":true},"from_port":{"references":["var.private_outbound_acl_rules","count.index"]},"icmp_code":{"references":["var.private_outbound_acl_rules","count.index"]},"icmp_type":{"references":["var.private_outbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.private_outbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.private[0].id","aws_network_acl.private[0]","aws_network_acl.private"]},"protocol":{"references":["var.private_outbound_acl_rules","count.index"]},"rule_action":{"references":["var.private_outbound_acl_rules","count.index"]},"rule_number":{"references":["var.private_outbound_acl_rules","count.index"]},"to_port":{"references":["var.private_outbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.private_dedicated_network_acl","var.private_subnets","var.private_outbound_acl_rules"]}},{"address":"aws_network_acl_rule.public_inbound","mode":"managed","type":"aws_network_acl_rule","name":"public_inbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.public_inbound_acl_rules","count.index"]},"egress":{"constant_value":false},"from_port":{"references":["var.public_inbound_acl_rules","count.index"]},"icmp_code":{"references":["var.public_inbound_acl_rules","count.index"]},"icmp_type":{"references":["var.public_inbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.public_inbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.public[0].id","aws_network_acl.public[0]","aws_network_acl.public"]},"protocol":{"references":["var.public_inbound_acl_rules","count.index"]},"rule_action":{"references":["var.public_inbound_acl_rules","count.index"]},"rule_number":{"references":["var.public_inbound_acl_rules","count.index"]},"to_port":{"references":["var.public_inbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.public_dedicated_network_acl","var.public_subnets","var.public_inbound_acl_rules"]}},{"address":"aws_network_acl_rule.public_outbound","mode":"managed","type":"aws_network_acl_rule","name":"public_outbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.public_outbound_acl_rules","count.index"]},"egress":{"constant_value":true},"from_port":{"references":["var.public_outbound_acl_rules","count.index"]},"icmp_code":{"references":["var.public_outbound_acl_rules","count.index"]},"icmp_type":{"references":["var.public_outbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.public_outbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.public[0].id","aws_network_acl.public[0]","aws_network_acl.public"]},"protocol":{"references":["var.public_outbound_acl_rules","count.index"]},"rule_action":{"references":["var.public_outbound_acl_rules","count.index"]},"rule_number":{"references":["var.public_outbound_acl_rules","count.index"]},"to_port":{"references":["var.public_outbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.public_dedicated_network_acl","var.public_subnets","var.public_outbound_acl_rules"]}},{"address":"aws_network_acl_rule.redshift_inbound","mode":"managed","type":"aws_network_acl_rule","name":"redshift_inbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.redshift_inbound_acl_rules","count.index"]},"egress":{"constant_value":false},"from_port":{"references":["var.redshift_inbound_acl_rules","count.index"]},"icmp_code":{"references":["var.redshift_inbound_acl_rules","count.index"]},"icmp_type":{"references":["var.redshift_inbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.redshift_inbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.redshift[0].id","aws_network_acl.redshift[0]","aws_network_acl.redshift"]},"protocol":{"references":["var.redshift_inbound_acl_rules","count.index"]},"rule_action":{"references":["var.redshift_inbound_acl_rules","count.index"]},"rule_number":{"references":["var.redshift_inbound_acl_rules","count.index"]},"to_port":{"references":["var.redshift_inbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.redshift_dedicated_network_acl","var.redshift_subnets","var.redshift_inbound_acl_rules"]}},{"address":"aws_network_acl_rule.redshift_outbound","mode":"managed","type":"aws_network_acl_rule","name":"redshift_outbound","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.redshift_outbound_acl_rules","count.index"]},"egress":{"constant_value":true},"from_port":{"references":["var.redshift_outbound_acl_rules","count.index"]},"icmp_code":{"references":["var.redshift_outbound_acl_rules","count.index"]},"icmp_type":{"references":["var.redshift_outbound_acl_rules","count.index"]},"ipv6_cidr_block":{"references":["var.redshift_outbound_acl_rules","count.index"]},"network_acl_id":{"references":["aws_network_acl.redshift[0].id","aws_network_acl.redshift[0]","aws_network_acl.redshift"]},"protocol":{"references":["var.redshift_outbound_acl_rules","count.index"]},"rule_action":{"references":["var.redshift_outbound_acl_rules","count.index"]},"rule_number":{"references":["var.redshift_outbound_acl_rules","count.index"]},"to_port":{"references":["var.redshift_outbound_acl_rules","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.redshift_dedicated_network_acl","var.redshift_subnets","var.redshift_outbound_acl_rules"]}},{"address":"aws_redshift_subnet_group.redshift","mode":"managed","type":"aws_redshift_subnet_group","name":"redshift","provider_config_key":"aws","expressions":{"description":{"references":["var.name"]},"name":{"references":["var.redshift_subnet_group_name","var.name"]},"subnet_ids":{"references":["aws_subnet.redshift"]},"tags":{"references":["var.redshift_subnet_group_name","var.name","var.tags","var.redshift_subnet_group_tags"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.redshift_subnets","var.create_redshift_subnet_group"]}},{"address":"aws_route.database_internet_gateway","mode":"managed","type":"aws_route","name":"database_internet_gateway","provider_config_key":"aws","expressions":{"destination_cidr_block":{"constant_value":"0.0.0.0/0"},"gateway_id":{"references":["aws_internet_gateway.this[0].id","aws_internet_gateway.this[0]","aws_internet_gateway.this"]},"route_table_id":{"references":["aws_route_table.database[0].id","aws_route_table.database[0]","aws_route_table.database"]},"timeouts":{"create":{"constant_value":"5m"}}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.create_igw","var.create_database_subnet_route_table","var.database_subnets","var.create_database_internet_gateway_route","var.create_database_nat_gateway_route"]}},{"address":"aws_route.database_ipv6_egress","mode":"managed","type":"aws_route","name":"database_ipv6_egress","provider_config_key":"aws","expressions":{"destination_ipv6_cidr_block":{"constant_value":"::/0"},"egress_only_gateway_id":{"references":["aws_egress_only_internet_gateway.this[0].id","aws_egress_only_internet_gateway.this[0]","aws_egress_only_internet_gateway.this"]},"route_table_id":{"references":["aws_route_table.database[0].id","aws_route_table.database[0]","aws_route_table.database"]},"timeouts":{"create":{"constant_value":"5m"}}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.create_egress_only_igw","var.enable_ipv6","var.create_database_subnet_route_table","var.database_subnets","var.create_database_internet_gateway_route"]}},{"address":"aws_route.database_nat_gateway","mode":"managed","type":"aws_route","name":"database_nat_gateway","provider_config_key":"aws","expressions":{"destination_cidr_block":{"constant_value":"0.0.0.0/0"},"nat_gateway_id":{"references":["aws_nat_gateway.this","count.index"]},"route_table_id":{"references":["aws_route_table.database","count.index"]},"timeouts":{"create":{"constant_value":"5m"}}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.create_database_subnet_route_table","var.database_subnets","var.create_database_internet_gateway_route","var.create_database_nat_gateway_route","var.enable_nat_gateway","var.single_nat_gateway","var.database_subnets"]}},{"address":"aws_route.private_ipv6_egress","mode":"managed","type":"aws_route","name":"private_ipv6_egress","provider_config_key":"aws","expressions":{"destination_ipv6_cidr_block":{"constant_value":"::/0"},"egress_only_gateway_id":{"references":["aws_egress_only_internet_gateway.this"]},"route_table_id":{"references":["aws_route_table.private","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.create_egress_only_igw","var.enable_ipv6","var.private_subnets"]}},{"address":"aws_route.private_nat_gateway","mode":"managed","type":"aws_route","name":"private_nat_gateway","provider_config_key":"aws","expressions":{"destination_cidr_block":{"references":["var.nat_gateway_destination_cidr_block"]},"nat_gateway_id":{"references":["aws_nat_gateway.this","count.index"]},"route_table_id":{"references":["aws_route_table.private","count.index"]},"timeouts":{"create":{"constant_value":"5m"}}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.enable_nat_gateway","local.nat_gateway_count"]}},{"address":"aws_route.public_internet_gateway","mode":"managed","type":"aws_route","name":"public_internet_gateway","provider_config_key":"aws","expressions":{"destination_cidr_block":{"constant_value":"0.0.0.0/0"},"gateway_id":{"references":["aws_internet_gateway.this[0].id","aws_internet_gateway.this[0]","aws_internet_gateway.this"]},"route_table_id":{"references":["aws_route_table.public[0].id","aws_route_table.public[0]","aws_route_table.public"]},"timeouts":{"create":{"constant_value":"5m"}}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.create_igw","var.public_subnets"]}},{"address":"aws_route.public_internet_gateway_ipv6","mode":"managed","type":"aws_route","name":"public_internet_gateway_ipv6","provider_config_key":"aws","expressions":{"destination_ipv6_cidr_block":{"constant_value":"::/0"},"gateway_id":{"references":["aws_internet_gateway.this[0].id","aws_internet_gateway.this[0]","aws_internet_gateway.this"]},"route_table_id":{"references":["aws_route_table.public[0].id","aws_route_table.public[0]","aws_route_table.public"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.create_igw","var.enable_ipv6","var.public_subnets"]}},{"address":"aws_route_table.database","mode":"managed","type":"aws_route_table","name":"database","provider_config_key":"aws","expressions":{"tags":{"references":["var.single_nat_gateway","var.create_database_internet_gateway_route","var.name","var.database_subnet_suffix","var.name","var.database_subnet_suffix","var.azs","count.index","var.tags","var.database_route_table_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.create_database_subnet_route_table","var.database_subnets","var.single_nat_gateway","var.create_database_internet_gateway_route","var.database_subnets"]}},{"address":"aws_route_table.elasticache","mode":"managed","type":"aws_route_table","name":"elasticache","provider_config_key":"aws","expressions":{"tags":{"references":["var.name","var.elasticache_subnet_suffix","var.tags","var.elasticache_route_table_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.create_elasticache_subnet_route_table","var.elasticache_subnets"]}},{"address":"aws_route_table.intra","mode":"managed","type":"aws_route_table","name":"intra","provider_config_key":"aws","expressions":{"tags":{"references":["var.name","var.intra_subnet_suffix","var.tags","var.intra_route_table_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.intra_subnets"]}},{"address":"aws_route_table.private","mode":"managed","type":"aws_route_table","name":"private","provider_config_key":"aws","expressions":{"tags":{"references":["var.single_nat_gateway","var.name","var.private_subnet_suffix","var.name","var.private_subnet_suffix","var.azs","count.index","var.tags","var.private_route_table_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","local.max_subnet_length","local.nat_gateway_count"]}},{"address":"aws_route_table.public","mode":"managed","type":"aws_route_table","name":"public","provider_config_key":"aws","expressions":{"tags":{"references":["var.name","var.public_subnet_suffix","var.tags","var.public_route_table_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.public_subnets"]}},{"address":"aws_route_table.redshift","mode":"managed","type":"aws_route_table","name":"redshift","provider_config_key":"aws","expressions":{"tags":{"references":["var.name","var.redshift_subnet_suffix","var.tags","var.redshift_route_table_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.create_redshift_subnet_route_table","var.redshift_subnets"]}},{"address":"aws_route_table_association.database","mode":"managed","type":"aws_route_table_association","name":"database","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.database","aws_route_table.private","var.create_database_subnet_route_table","var.single_nat_gateway","var.create_database_internet_gateway_route","count.index","count.index"]},"subnet_id":{"references":["aws_subnet.database","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.database_subnets","var.database_subnets"]}},{"address":"aws_route_table_association.elasticache","mode":"managed","type":"aws_route_table_association","name":"elasticache","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.elasticache","aws_route_table.private","var.single_nat_gateway","var.create_elasticache_subnet_route_table","count.index"]},"subnet_id":{"references":["aws_subnet.elasticache","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.elasticache_subnets","var.elasticache_subnets"]}},{"address":"aws_route_table_association.intra","mode":"managed","type":"aws_route_table_association","name":"intra","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.intra"]},"subnet_id":{"references":["aws_subnet.intra","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.intra_subnets","var.intra_subnets"]}},{"address":"aws_route_table_association.outpost","mode":"managed","type":"aws_route_table_association","name":"outpost","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.private","var.single_nat_gateway","count.index"]},"subnet_id":{"references":["aws_subnet.outpost","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.outpost_subnets","var.outpost_subnets"]}},{"address":"aws_route_table_association.private","mode":"managed","type":"aws_route_table_association","name":"private","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.private","var.single_nat_gateway","count.index"]},"subnet_id":{"references":["aws_subnet.private","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.private_subnets","var.private_subnets"]}},{"address":"aws_route_table_association.public","mode":"managed","type":"aws_route_table_association","name":"public","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.public[0].id","aws_route_table.public[0]","aws_route_table.public"]},"subnet_id":{"references":["aws_subnet.public","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.public_subnets","var.public_subnets"]}},{"address":"aws_route_table_association.redshift","mode":"managed","type":"aws_route_table_association","name":"redshift","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.redshift","aws_route_table.private","var.single_nat_gateway","var.create_redshift_subnet_route_table","count.index"]},"subnet_id":{"references":["aws_subnet.redshift","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.redshift_subnets","var.enable_public_redshift","var.redshift_subnets"]}},{"address":"aws_route_table_association.redshift_public","mode":"managed","type":"aws_route_table_association","name":"redshift_public","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.redshift","aws_route_table.public","var.single_nat_gateway","var.create_redshift_subnet_route_table","count.index"]},"subnet_id":{"references":["aws_subnet.redshift","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.redshift_subnets","var.enable_public_redshift","var.redshift_subnets"]}},{"address":"aws_subnet.database","mode":"managed","type":"aws_subnet","name":"database","provider_config_key":"aws","expressions":{"assign_ipv6_address_on_creation":{"references":["var.database_subnet_assign_ipv6_address_on_creation","var.assign_ipv6_address_on_creation","var.database_subnet_assign_ipv6_address_on_creation"]},"availability_zone":{"references":["var.azs","count.index","var.azs","count.index"]},"availability_zone_id":{"references":["var.azs","count.index","var.azs","count.index"]},"cidr_block":{"references":["var.database_subnets","count.index"]},"ipv6_cidr_block":{"references":["var.enable_ipv6","var.database_subnet_ipv6_prefixes","aws_vpc.this[0].ipv6_cidr_block","aws_vpc.this[0]","aws_vpc.this","var.database_subnet_ipv6_prefixes","count.index"]},"tags":{"references":["var.database_subnet_names","count.index","var.name","var.database_subnet_suffix","var.azs","count.index","var.tags","var.database_subnet_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":1,"count_expression":{"references":["local.create_vpc","var.database_subnets","var.database_subnets"]}},{"address":"aws_subnet.elasticache","mode":"managed","type":"aws_subnet","name":"elasticache","provider_config_key":"aws","expressions":{"assign_ipv6_address_on_creation":{"references":["var.elasticache_subnet_assign_ipv6_address_on_creation","var.assign_ipv6_address_on_creation","var.elasticache_subnet_assign_ipv6_address_on_creation"]},"availability_zone":{"references":["var.azs","count.index","var.azs","count.index"]},"availability_zone_id":{"references":["var.azs","count.index","var.azs","count.index"]},"cidr_block":{"references":["var.elasticache_subnets","count.index"]},"ipv6_cidr_block":{"references":["var.enable_ipv6","var.elasticache_subnet_ipv6_prefixes","aws_vpc.this[0].ipv6_cidr_block","aws_vpc.this[0]","aws_vpc.this","var.elasticache_subnet_ipv6_prefixes","count.index"]},"tags":{"references":["var.elasticache_subnet_names","count.index","var.name","var.elasticache_subnet_suffix","var.azs","count.index","var.tags","var.elasticache_subnet_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":1,"count_expression":{"references":["local.create_vpc","var.elasticache_subnets","var.elasticache_subnets"]}},{"address":"aws_subnet.intra","mode":"managed","type":"aws_subnet","name":"intra","provider_config_key":"aws","expressions":{"assign_ipv6_address_on_creation":{"references":["var.intra_subnet_assign_ipv6_address_on_creation","var.assign_ipv6_address_on_creation","var.intra_subnet_assign_ipv6_address_on_creation"]},"availability_zone":{"references":["var.azs","count.index","var.azs","count.index"]},"availability_zone_id":{"references":["var.azs","count.index","var.azs","count.index"]},"cidr_block":{"references":["var.intra_subnets","count.index"]},"ipv6_cidr_block":{"references":["var.enable_ipv6","var.intra_subnet_ipv6_prefixes","aws_vpc.this[0].ipv6_cidr_block","aws_vpc.this[0]","aws_vpc.this","var.intra_subnet_ipv6_prefixes","count.index"]},"tags":{"references":["var.intra_subnet_names","count.index","var.name","var.intra_subnet_suffix","var.azs","count.index","var.tags","var.intra_subnet_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":1,"count_expression":{"references":["local.create_vpc","var.intra_subnets","var.intra_subnets"]}},{"address":"aws_subnet.outpost","mode":"managed","type":"aws_subnet","name":"outpost","provider_config_key":"aws","expressions":{"assign_ipv6_address_on_creation":{"references":["var.outpost_subnet_assign_ipv6_address_on_creation","var.assign_ipv6_address_on_creation","var.outpost_subnet_assign_ipv6_address_on_creation"]},"availability_zone":{"references":["var.outpost_az"]},"cidr_block":{"references":["var.outpost_subnets","count.index"]},"ipv6_cidr_block":{"references":["var.enable_ipv6","var.outpost_subnet_ipv6_prefixes","aws_vpc.this[0].ipv6_cidr_block","aws_vpc.this[0]","aws_vpc.this","var.outpost_subnet_ipv6_prefixes","count.index"]},"outpost_arn":{"references":["var.outpost_arn"]},"tags":{"references":["var.outpost_subnet_names","count.index","var.name","var.outpost_subnet_suffix","var.outpost_az","var.tags","var.outpost_subnet_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":1,"count_expression":{"references":["local.create_vpc","var.outpost_subnets","var.outpost_subnets"]}},{"address":"aws_subnet.private","mode":"managed","type":"aws_subnet","name":"private","provider_config_key":"aws","expressions":{"assign_ipv6_address_on_creation":{"references":["var.private_subnet_assign_ipv6_address_on_creation","var.assign_ipv6_address_on_creation","var.private_subnet_assign_ipv6_address_on_creation"]},"availability_zone":{"references":["var.azs","count.index","var.azs","count.index"]},"availability_zone_id":{"references":["var.azs","count.index","var.azs","count.index"]},"cidr_block":{"references":["var.private_subnets","count.index"]},"ipv6_cidr_block":{"references":["var.enable_ipv6","var.private_subnet_ipv6_prefixes","aws_vpc.this[0].ipv6_cidr_block","aws_vpc.this[0]","aws_vpc.this","var.private_subnet_ipv6_prefixes","count.index"]},"tags":{"references":["var.private_subnet_names","count.index","var.name","var.private_subnet_suffix","var.azs","count.index","var.tags","var.private_subnet_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":1,"count_expression":{"references":["local.create_vpc","var.private_subnets","var.private_subnets"]}},{"address":"aws_subnet.public","mode":"managed","type":"aws_subnet","name":"public","provider_config_key":"aws","expressions":{"assign_ipv6_address_on_creation":{"references":["var.public_subnet_assign_ipv6_address_on_creation","var.assign_ipv6_address_on_creation","var.public_subnet_assign_ipv6_address_on_creation"]},"availability_zone":{"references":["var.azs","count.index","var.azs","count.index"]},"availability_zone_id":{"references":["var.azs","count.index","var.azs","count.index"]},"cidr_block":{"references":["var.public_subnets","count.index"]},"ipv6_cidr_block":{"references":["var.enable_ipv6","var.public_subnet_ipv6_prefixes","aws_vpc.this[0].ipv6_cidr_block","aws_vpc.this[0]","aws_vpc.this","var.public_subnet_ipv6_prefixes","count.index"]},"map_public_ip_on_launch":{"references":["var.map_public_ip_on_launch"]},"tags":{"references":["var.public_subnet_names","count.index","var.name","var.public_subnet_suffix","var.azs","count.index","var.tags","var.public_subnet_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":1,"count_expression":{"references":["local.create_vpc","var.public_subnets","var.one_nat_gateway_per_az","var.public_subnets","var.azs","var.public_subnets"]}},{"address":"aws_subnet.redshift","mode":"managed","type":"aws_subnet","name":"redshift","provider_config_key":"aws","expressions":{"assign_ipv6_address_on_creation":{"references":["var.redshift_subnet_assign_ipv6_address_on_creation","var.assign_ipv6_address_on_creation","var.redshift_subnet_assign_ipv6_address_on_creation"]},"availability_zone":{"references":["var.azs","count.index","var.azs","count.index"]},"availability_zone_id":{"references":["var.azs","count.index","var.azs","count.index"]},"cidr_block":{"references":["var.redshift_subnets","count.index"]},"ipv6_cidr_block":{"references":["var.enable_ipv6","var.redshift_subnet_ipv6_prefixes","aws_vpc.this[0].ipv6_cidr_block","aws_vpc.this[0]","aws_vpc.this","var.redshift_subnet_ipv6_prefixes","count.index"]},"tags":{"references":["var.redshift_subnet_names","count.index","var.name","var.redshift_subnet_suffix","var.azs","count.index","var.tags","var.redshift_subnet_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":1,"count_expression":{"references":["local.create_vpc","var.redshift_subnets","var.redshift_subnets"]}},{"address":"aws_vpc.this","mode":"managed","type":"aws_vpc","name":"this","provider_config_key":"aws","expressions":{"assign_generated_ipv6_cidr_block":{"references":["var.enable_ipv6","var.use_ipam_pool"]},"cidr_block":{"references":["var.use_ipam_pool","var.cidr"]},"enable_classiclink":{"constant_value":null},"enable_classiclink_dns_support":{"constant_value":null},"enable_dns_hostnames":{"references":["var.enable_dns_hostnames"]},"enable_dns_support":{"references":["var.enable_dns_support"]},"instance_tenancy":{"references":["var.instance_tenancy"]},"ipv4_ipam_pool_id":{"references":["var.ipv4_ipam_pool_id"]},"ipv4_netmask_length":{"references":["var.ipv4_netmask_length"]},"ipv6_cidr_block":{"references":["var.ipv6_cidr"]},"ipv6_ipam_pool_id":{"references":["var.ipv6_ipam_pool_id"]},"ipv6_netmask_length":{"references":["var.ipv6_netmask_length"]},"tags":{"references":["var.name","var.tags","var.vpc_tags"]}},"schema_version":1,"count_expression":{"references":["local.create_vpc"]}},{"address":"aws_vpc_dhcp_options.this","mode":"managed","type":"aws_vpc_dhcp_options","name":"this","provider_config_key":"aws","expressions":{"domain_name":{"references":["var.dhcp_options_domain_name"]},"domain_name_servers":{"references":["var.dhcp_options_domain_name_servers"]},"netbios_name_servers":{"references":["var.dhcp_options_netbios_name_servers"]},"netbios_node_type":{"references":["var.dhcp_options_netbios_node_type"]},"ntp_servers":{"references":["var.dhcp_options_ntp_servers"]},"tags":{"references":["var.name","var.tags","var.dhcp_options_tags"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.enable_dhcp_options"]}},{"address":"aws_vpc_dhcp_options_association.this","mode":"managed","type":"aws_vpc_dhcp_options_association","name":"this","provider_config_key":"aws","expressions":{"dhcp_options_id":{"references":["aws_vpc_dhcp_options.this[0].id","aws_vpc_dhcp_options.this[0]","aws_vpc_dhcp_options.this"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.enable_dhcp_options"]}},{"address":"aws_vpc_ipv4_cidr_block_association.this","mode":"managed","type":"aws_vpc_ipv4_cidr_block_association","name":"this","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.secondary_cidr_blocks","count.index"]},"vpc_id":{"references":["aws_vpc.this[0].id","aws_vpc.this[0]","aws_vpc.this"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.secondary_cidr_blocks","var.secondary_cidr_blocks"]}},{"address":"aws_vpn_gateway.this","mode":"managed","type":"aws_vpn_gateway","name":"this","provider_config_key":"aws","expressions":{"amazon_side_asn":{"references":["var.amazon_side_asn"]},"availability_zone":{"references":["var.vpn_gateway_az"]},"tags":{"references":["var.name","var.tags","var.vpn_gateway_tags"]},"vpc_id":{"references":["local.vpc_id"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.enable_vpn_gateway"]}},{"address":"aws_vpn_gateway_attachment.this","mode":"managed","type":"aws_vpn_gateway_attachment","name":"this","provider_config_key":"aws","expressions":{"vpc_id":{"references":["local.vpc_id"]},"vpn_gateway_id":{"references":["var.vpn_gateway_id"]}},"schema_version":0,"count_expression":{"references":["var.vpn_gateway_id"]}},{"address":"aws_vpn_gateway_route_propagation.intra","mode":"managed","type":"aws_vpn_gateway_route_propagation","name":"intra","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.intra","count.index"]},"vpn_gateway_id":{"references":["aws_vpn_gateway.this","aws_vpn_gateway_attachment.this","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.propagate_intra_route_tables_vgw","var.enable_vpn_gateway","var.vpn_gateway_id","var.intra_subnets"]}},{"address":"aws_vpn_gateway_route_propagation.private","mode":"managed","type":"aws_vpn_gateway_route_propagation","name":"private","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.private","count.index"]},"vpn_gateway_id":{"references":["aws_vpn_gateway.this","aws_vpn_gateway_attachment.this","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.propagate_private_route_tables_vgw","var.enable_vpn_gateway","var.vpn_gateway_id","var.private_subnets"]}},{"address":"aws_vpn_gateway_route_propagation.public","mode":"managed","type":"aws_vpn_gateway_route_propagation","name":"public","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.public","count.index"]},"vpn_gateway_id":{"references":["aws_vpn_gateway.this","aws_vpn_gateway_attachment.this","count.index"]}},"schema_version":0,"count_expression":{"references":["local.create_vpc","var.propagate_public_route_tables_vgw","var.enable_vpn_gateway","var.vpn_gateway_id"]}},{"address":"data.aws_iam_policy_document.flow_log_cloudwatch_assume_role","mode":"data","type":"aws_iam_policy_document","name":"flow_log_cloudwatch_assume_role","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"constant_value":["vpc-flow-logs.amazonaws.com"]},"type":{"constant_value":"Service"}}],"sid":{"constant_value":"AWSVPCFlowLogsAssumeRole"}}]},"schema_version":0,"count_expression":{"references":["local.create_flow_log_cloudwatch_iam_role"]}},{"address":"data.aws_iam_policy_document.vpc_flow_log_cloudwatch","mode":"data","type":"aws_iam_policy_document","name":"vpc_flow_log_cloudwatch","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["logs:CreateLogStream","logs:PutLogEvents","logs:DescribeLogGroups","logs:DescribeLogStreams"]},"effect":{"constant_value":"Allow"},"resources":{"constant_value":["*"]},"sid":{"constant_value":"AWSVPCFlowLogsPushToCloudWatch"}}]},"schema_version":0,"count_expression":{"references":["local.create_flow_log_cloudwatch_iam_role"]}}],"variables":{"amazon_side_asn":{"default":"64512","description":"The Autonomous System Number (ASN) for the Amazon side of the gateway. By default the virtual private gateway is created with the current default Amazon ASN."},"assign_ipv6_address_on_creation":{"default":false,"description":"Assign IPv6 address on subnet, must be disabled to change IPv6 CIDRs. This is the IPv6 equivalent of map_public_ip_on_launch"},"azs":{"default":[],"description":"A list of availability zones names or ids in the region"},"cidr":{"default":"0.0.0.0/0","description":"(Optional) The IPv4 CIDR block for the VPC. CIDR can be explicitly set or it can be derived from IPAM using `ipv4_netmask_length` \u0026 `ipv4_ipam_pool_id`"},"create_database_internet_gateway_route":{"default":false,"description":"Controls if an internet gateway route for public database access should be created"},"create_database_nat_gateway_route":{"default":false,"description":"Controls if a nat gateway route should be created to give internet access to the database subnets"},"create_database_subnet_group":{"default":true,"description":"Controls if database subnet group should be created (n.b. database_subnets must also be set)"},"create_database_subnet_route_table":{"default":false,"description":"Controls if separate route table for database should be created"},"create_egress_only_igw":{"default":true,"description":"Controls if an Egress Only Internet Gateway is created and its related routes."},"create_elasticache_subnet_group":{"default":true,"description":"Controls if elasticache subnet group should be created"},"create_elasticache_subnet_route_table":{"default":false,"description":"Controls if separate route table for elasticache should be created"},"create_flow_log_cloudwatch_iam_role":{"default":false,"description":"Whether to create IAM role for VPC Flow Logs"},"create_flow_log_cloudwatch_log_group":{"default":false,"description":"Whether to create CloudWatch log group for VPC Flow Logs"},"create_igw":{"default":true,"description":"Controls if an Internet Gateway is created for public subnets and the related routes that connect them."},"create_redshift_subnet_group":{"default":true,"description":"Controls if redshift subnet group should be created"},"create_redshift_subnet_route_table":{"default":false,"description":"Controls if separate route table for redshift should be created"},"create_vpc":{"default":true,"description":"Controls if VPC should be created (it affects almost all resources)"},"customer_gateway_tags":{"default":{},"description":"Additional tags for the Customer Gateway"},"customer_gateways":{"default":{},"description":"Maps of Customer Gateway's attributes (BGP ASN and Gateway's Internet-routable external IP address)"},"database_acl_tags":{"default":{},"description":"Additional tags for the database subnets network ACL"},"database_dedicated_network_acl":{"default":false,"description":"Whether to use dedicated network ACL (not default) and custom rules for database subnets"},"database_inbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Database subnets inbound network ACL rules"},"database_outbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Database subnets outbound network ACL rules"},"database_route_table_tags":{"default":{},"description":"Additional tags for the database route tables"},"database_subnet_assign_ipv6_address_on_creation":{"default":null,"description":"Assign IPv6 address on database subnet, must be disabled to change IPv6 CIDRs. This is the IPv6 equivalent of map_public_ip_on_launch"},"database_subnet_group_name":{"default":null,"description":"Name of database subnet group"},"database_subnet_group_tags":{"default":{},"description":"Additional tags for the database subnet group"},"database_subnet_ipv6_prefixes":{"default":[],"description":"Assigns IPv6 database subnet id based on the Amazon provided /56 prefix base 10 integer (0-256). Must be of equal length to the corresponding IPv4 subnet list"},"database_subnet_names":{"default":[],"description":"Explicit values to use in the Name tag on database subnets. If empty, Name tags are generated."},"database_subnet_suffix":{"default":"db","description":"Suffix to append to database subnets name"},"database_subnet_tags":{"default":{},"description":"Additional tags for the database subnets"},"database_subnets":{"default":[],"description":"A list of database subnets"},"default_network_acl_egress":{"default":[{"action":"allow","cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_no":"100","to_port":"0"},{"action":"allow","from_port":"0","ipv6_cidr_block":"::/0","protocol":"-1","rule_no":"101","to_port":"0"}],"description":"List of maps of egress rules to set on the Default Network ACL"},"default_network_acl_ingress":{"default":[{"action":"allow","cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_no":"100","to_port":"0"},{"action":"allow","from_port":"0","ipv6_cidr_block":"::/0","protocol":"-1","rule_no":"101","to_port":"0"}],"description":"List of maps of ingress rules to set on the Default Network ACL"},"default_network_acl_name":{"default":null,"description":"Name to be used on the Default Network ACL"},"default_network_acl_tags":{"default":{},"description":"Additional tags for the Default Network ACL"},"default_route_table_name":{"default":null,"description":"Name to be used on the default route table"},"default_route_table_propagating_vgws":{"default":[],"description":"List of virtual gateways for propagation"},"default_route_table_routes":{"default":[],"description":"Configuration block of routes. See https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_route_table#route"},"default_route_table_tags":{"default":{},"description":"Additional tags for the default route table"},"default_security_group_egress":{"default":[],"description":"List of maps of egress rules to set on the default security group"},"default_security_group_ingress":{"default":[],"description":"List of maps of ingress rules to set on the default security group"},"default_security_group_name":{"default":null,"description":"Name to be used on the default security group"},"default_security_group_tags":{"default":{},"description":"Additional tags for the default security group"},"default_vpc_enable_classiclink":{"default":false,"description":"[DEPRECATED](https://github.com/hashicorp/terraform/issues/31730) Should be true to enable ClassicLink in the Default VPC"},"default_vpc_enable_dns_hostnames":{"default":false,"description":"Should be true to enable DNS hostnames in the Default VPC"},"default_vpc_enable_dns_support":{"default":true,"description":"Should be true to enable DNS support in the Default VPC"},"default_vpc_name":{"default":null,"description":"Name to be used on the Default VPC"},"default_vpc_tags":{"default":{},"description":"Additional tags for the Default VPC"},"dhcp_options_domain_name":{"default":"","description":"Specifies DNS name for DHCP options set (requires enable_dhcp_options set to true)"},"dhcp_options_domain_name_servers":{"default":["AmazonProvidedDNS"],"description":"Specify a list of DNS server addresses for DHCP options set, default to AWS provided (requires enable_dhcp_options set to true)"},"dhcp_options_netbios_name_servers":{"default":[],"description":"Specify a list of netbios servers for DHCP options set (requires enable_dhcp_options set to true)"},"dhcp_options_netbios_node_type":{"default":"","description":"Specify netbios node_type for DHCP options set (requires enable_dhcp_options set to true)"},"dhcp_options_ntp_servers":{"default":[],"description":"Specify a list of NTP servers for DHCP options set (requires enable_dhcp_options set to true)"},"dhcp_options_tags":{"default":{},"description":"Additional tags for the DHCP option set (requires enable_dhcp_options set to true)"},"elasticache_acl_tags":{"default":{},"description":"Additional tags for the elasticache subnets network ACL"},"elasticache_dedicated_network_acl":{"default":false,"description":"Whether to use dedicated network ACL (not default) and custom rules for elasticache subnets"},"elasticache_inbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Elasticache subnets inbound network ACL rules"},"elasticache_outbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Elasticache subnets outbound network ACL rules"},"elasticache_route_table_tags":{"default":{},"description":"Additional tags for the elasticache route tables"},"elasticache_subnet_assign_ipv6_address_on_creation":{"default":null,"description":"Assign IPv6 address on elasticache subnet, must be disabled to change IPv6 CIDRs. This is the IPv6 equivalent of map_public_ip_on_launch"},"elasticache_subnet_group_name":{"default":null,"description":"Name of elasticache subnet group"},"elasticache_subnet_group_tags":{"default":{},"description":"Additional tags for the elasticache subnet group"},"elasticache_subnet_ipv6_prefixes":{"default":[],"description":"Assigns IPv6 elasticache subnet id based on the Amazon provided /56 prefix base 10 integer (0-256). Must be of equal length to the corresponding IPv4 subnet list"},"elasticache_subnet_names":{"default":[],"description":"Explicit values to use in the Name tag on elasticache subnets. If empty, Name tags are generated."},"elasticache_subnet_suffix":{"default":"elasticache","description":"Suffix to append to elasticache subnets name"},"elasticache_subnet_tags":{"default":{},"description":"Additional tags for the elasticache subnets"},"elasticache_subnets":{"default":[],"description":"A list of elasticache subnets"},"enable_classiclink":{"default":null,"description":"[DEPRECATED](https://github.com/hashicorp/terraform/issues/31730) Should be true to enable ClassicLink for the VPC. Only valid in regions and accounts that support EC2 Classic."},"enable_classiclink_dns_support":{"default":null,"description":"[DEPRECATED](https://github.com/hashicorp/terraform/issues/31730) Should be true to enable ClassicLink DNS Support for the VPC. Only valid in regions and accounts that support EC2 Classic."},"enable_dhcp_options":{"default":false,"description":"Should be true if you want to specify a DHCP options set with a custom domain name, DNS servers, NTP servers, netbios servers, and/or netbios server type"},"enable_dns_hostnames":{"default":false,"description":"Should be true to enable DNS hostnames in the VPC"},"enable_dns_support":{"default":true,"description":"Should be true to enable DNS support in the VPC"},"enable_flow_log":{"default":false,"description":"Whether or not to enable VPC Flow Logs"},"enable_ipv6":{"default":false,"description":"Requests an Amazon-provided IPv6 CIDR block with a /56 prefix length for the VPC. You cannot specify the range of IP addresses, or the size of the CIDR block."},"enable_nat_gateway":{"default":false,"description":"Should be true if you want to provision NAT Gateways for each of your private networks"},"enable_public_redshift":{"default":false,"description":"Controls if redshift should have public routing table"},"enable_vpn_gateway":{"default":false,"description":"Should be true if you want to create a new VPN Gateway resource and attach it to the VPC"},"external_nat_ip_ids":{"default":[],"description":"List of EIP IDs to be assigned to the NAT Gateways (used in combination with reuse_nat_ips)"},"external_nat_ips":{"default":[],"description":"List of EIPs to be used for `nat_public_ips` output (used in combination with reuse_nat_ips and external_nat_ip_ids)"},"flow_log_cloudwatch_iam_role_arn":{"default":"","description":"The ARN for the IAM role that's used to post flow logs to a CloudWatch Logs log group. When flow_log_destination_arn is set to ARN of Cloudwatch Logs, this argument needs to be provided."},"flow_log_cloudwatch_log_group_kms_key_id":{"default":null,"description":"The ARN of the KMS Key to use when encrypting log data for VPC flow logs."},"flow_log_cloudwatch_log_group_name_prefix":{"default":"/aws/vpc-flow-log/","description":"Specifies the name prefix of CloudWatch Log Group for VPC flow logs."},"flow_log_cloudwatch_log_group_name_suffix":{"default":"","description":"Specifies the name suffix of CloudWatch Log Group for VPC flow logs."},"flow_log_cloudwatch_log_group_retention_in_days":{"default":null,"description":"Specifies the number of days you want to retain log events in the specified log group for VPC flow logs."},"flow_log_destination_arn":{"default":"","description":"The ARN of the CloudWatch log group or S3 bucket where VPC Flow Logs will be pushed. If this ARN is a S3 bucket the appropriate permissions need to be set on that bucket's policy. When create_flow_log_cloudwatch_log_group is set to false this argument must be provided."},"flow_log_destination_type":{"default":"cloud-watch-logs","description":"Type of flow log destination. Can be s3 or cloud-watch-logs."},"flow_log_file_format":{"default":"plain-text","description":"(Optional) The format for the flow log. Valid values: `plain-text`, `parquet`."},"flow_log_hive_compatible_partitions":{"default":false,"description":"(Optional) Indicates whether to use Hive-compatible prefixes for flow logs stored in Amazon S3."},"flow_log_log_format":{"default":null,"description":"The fields to include in the flow log record, in the order in which they should appear."},"flow_log_max_aggregation_interval":{"default":600,"description":"The maximum interval of time during which a flow of packets is captured and aggregated into a flow log record. Valid Values: `60` seconds or `600` seconds."},"flow_log_per_hour_partition":{"default":false,"description":"(Optional) Indicates whether to partition the flow log per hour. This reduces the cost and response time for queries."},"flow_log_traffic_type":{"default":"ALL","description":"The type of traffic to capture. Valid values: ACCEPT, REJECT, ALL."},"igw_tags":{"default":{},"description":"Additional tags for the internet gateway"},"instance_tenancy":{"default":"default","description":"A tenancy option for instances launched into the VPC"},"intra_acl_tags":{"default":{},"description":"Additional tags for the intra subnets network ACL"},"intra_dedicated_network_acl":{"default":false,"description":"Whether to use dedicated network ACL (not default) and custom rules for intra subnets"},"intra_inbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Intra subnets inbound network ACLs"},"intra_outbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Intra subnets outbound network ACLs"},"intra_route_table_tags":{"default":{},"description":"Additional tags for the intra route tables"},"intra_subnet_assign_ipv6_address_on_creation":{"default":null,"description":"Assign IPv6 address on intra subnet, must be disabled to change IPv6 CIDRs. This is the IPv6 equivalent of map_public_ip_on_launch"},"intra_subnet_ipv6_prefixes":{"default":[],"description":"Assigns IPv6 intra subnet id based on the Amazon provided /56 prefix base 10 integer (0-256). Must be of equal length to the corresponding IPv4 subnet list"},"intra_subnet_names":{"default":[],"description":"Explicit values to use in the Name tag on intra subnets. If empty, Name tags are generated."},"intra_subnet_suffix":{"default":"intra","description":"Suffix to append to intra subnets name"},"intra_subnet_tags":{"default":{},"description":"Additional tags for the intra subnets"},"intra_subnets":{"default":[],"description":"A list of intra subnets"},"ipv4_ipam_pool_id":{"default":null,"description":"(Optional) The ID of an IPv4 IPAM pool you want to use for allocating this VPC's CIDR."},"ipv4_netmask_length":{"default":null,"description":"(Optional) The netmask length of the IPv4 CIDR you want to allocate to this VPC. Requires specifying a ipv4_ipam_pool_id."},"ipv6_cidr":{"default":null,"description":"(Optional) IPv6 CIDR block to request from an IPAM Pool. Can be set explicitly or derived from IPAM using `ipv6_netmask_length`."},"ipv6_ipam_pool_id":{"default":null,"description":"(Optional) IPAM Pool ID for a IPv6 pool. Conflicts with `assign_generated_ipv6_cidr_block`."},"ipv6_netmask_length":{"default":null,"description":"(Optional) Netmask length to request from IPAM Pool. Conflicts with `ipv6_cidr_block`. This can be omitted if IPAM pool as a `allocation_default_netmask_length` set. Valid values: `56`."},"manage_default_network_acl":{"default":false,"description":"Should be true to adopt and manage Default Network ACL"},"manage_default_route_table":{"default":false,"description":"Should be true to manage default route table"},"manage_default_security_group":{"default":false,"description":"Should be true to adopt and manage default security group"},"manage_default_vpc":{"default":false,"description":"Should be true to adopt and manage Default VPC"},"map_public_ip_on_launch":{"default":true,"description":"Should be false if you do not want to auto-assign public IP on launch"},"name":{"default":"","description":"Name to be used on all the resources as identifier"},"nat_eip_tags":{"default":{},"description":"Additional tags for the NAT EIP"},"nat_gateway_destination_cidr_block":{"default":"0.0.0.0/0","description":"Used to pass a custom destination route for private NAT Gateway. If not specified, the default 0.0.0.0/0 is used as a destination route."},"nat_gateway_tags":{"default":{},"description":"Additional tags for the NAT gateways"},"one_nat_gateway_per_az":{"default":false,"description":"Should be true if you want only one NAT Gateway per availability zone. Requires `var.azs` to be set, and the number of `public_subnets` created to be greater than or equal to the number of availability zones specified in `var.azs`."},"outpost_acl_tags":{"default":{},"description":"Additional tags for the outpost subnets network ACL"},"outpost_arn":{"default":null,"description":"ARN of Outpost you want to create a subnet in."},"outpost_az":{"default":null,"description":"AZ where Outpost is anchored."},"outpost_dedicated_network_acl":{"default":false,"description":"Whether to use dedicated network ACL (not default) and custom rules for outpost subnets"},"outpost_inbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Outpost subnets inbound network ACLs"},"outpost_outbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Outpost subnets outbound network ACLs"},"outpost_subnet_assign_ipv6_address_on_creation":{"default":null,"description":"Assign IPv6 address on outpost subnet, must be disabled to change IPv6 CIDRs. This is the IPv6 equivalent of map_public_ip_on_launch"},"outpost_subnet_ipv6_prefixes":{"default":[],"description":"Assigns IPv6 outpost subnet id based on the Amazon provided /56 prefix base 10 integer (0-256). Must be of equal length to the corresponding IPv4 subnet list"},"outpost_subnet_names":{"default":[],"description":"Explicit values to use in the Name tag on outpost subnets. If empty, Name tags are generated."},"outpost_subnet_suffix":{"default":"outpost","description":"Suffix to append to outpost subnets name"},"outpost_subnet_tags":{"default":{},"description":"Additional tags for the outpost subnets"},"outpost_subnets":{"default":[],"description":"A list of outpost subnets inside the VPC"},"private_acl_tags":{"default":{},"description":"Additional tags for the private subnets network ACL"},"private_dedicated_network_acl":{"default":false,"description":"Whether to use dedicated network ACL (not default) and custom rules for private subnets"},"private_inbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Private subnets inbound network ACLs"},"private_outbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Private subnets outbound network ACLs"},"private_route_table_tags":{"default":{},"description":"Additional tags for the private route tables"},"private_subnet_assign_ipv6_address_on_creation":{"default":null,"description":"Assign IPv6 address on private subnet, must be disabled to change IPv6 CIDRs. This is the IPv6 equivalent of map_public_ip_on_launch"},"private_subnet_ipv6_prefixes":{"default":[],"description":"Assigns IPv6 private subnet id based on the Amazon provided /56 prefix base 10 integer (0-256). Must be of equal length to the corresponding IPv4 subnet list"},"private_subnet_names":{"default":[],"description":"Explicit values to use in the Name tag on private subnets. If empty, Name tags are generated."},"private_subnet_suffix":{"default":"private","description":"Suffix to append to private subnets name"},"private_subnet_tags":{"default":{},"description":"Additional tags for the private subnets"},"private_subnets":{"default":[],"description":"A list of private subnets inside the VPC"},"propagate_intra_route_tables_vgw":{"default":false,"description":"Should be true if you want route table propagation"},"propagate_private_route_tables_vgw":{"default":false,"description":"Should be true if you want route table propagation"},"propagate_public_route_tables_vgw":{"default":false,"description":"Should be true if you want route table propagation"},"public_acl_tags":{"default":{},"description":"Additional tags for the public subnets network ACL"},"public_dedicated_network_acl":{"default":false,"description":"Whether to use dedicated network ACL (not default) and custom rules for public subnets"},"public_inbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Public subnets inbound network ACLs"},"public_outbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Public subnets outbound network ACLs"},"public_route_table_tags":{"default":{},"description":"Additional tags for the public route tables"},"public_subnet_assign_ipv6_address_on_creation":{"default":null,"description":"Assign IPv6 address on public subnet, must be disabled to change IPv6 CIDRs. This is the IPv6 equivalent of map_public_ip_on_launch"},"public_subnet_ipv6_prefixes":{"default":[],"description":"Assigns IPv6 public subnet id based on the Amazon provided /56 prefix base 10 integer (0-256). Must be of equal length to the corresponding IPv4 subnet list"},"public_subnet_names":{"default":[],"description":"Explicit values to use in the Name tag on public subnets. If empty, Name tags are generated."},"public_subnet_suffix":{"default":"public","description":"Suffix to append to public subnets name"},"public_subnet_tags":{"default":{},"description":"Additional tags for the public subnets"},"public_subnets":{"default":[],"description":"A list of public subnets inside the VPC"},"putin_khuylo":{"default":true,"description":"Do you agree that Putin doesn't respect Ukrainian sovereignty and territorial integrity? More info: https://en.wikipedia.org/wiki/Putin_khuylo!"},"redshift_acl_tags":{"default":{},"description":"Additional tags for the redshift subnets network ACL"},"redshift_dedicated_network_acl":{"default":false,"description":"Whether to use dedicated network ACL (not default) and custom rules for redshift subnets"},"redshift_inbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Redshift subnets inbound network ACL rules"},"redshift_outbound_acl_rules":{"default":[{"cidr_block":"0.0.0.0/0","from_port":"0","protocol":"-1","rule_action":"allow","rule_number":"100","to_port":"0"}],"description":"Redshift subnets outbound network ACL rules"},"redshift_route_table_tags":{"default":{},"description":"Additional tags for the redshift route tables"},"redshift_subnet_assign_ipv6_address_on_creation":{"default":null,"description":"Assign IPv6 address on redshift subnet, must be disabled to change IPv6 CIDRs. This is the IPv6 equivalent of map_public_ip_on_launch"},"redshift_subnet_group_name":{"default":null,"description":"Name of redshift subnet group"},"redshift_subnet_group_tags":{"default":{},"description":"Additional tags for the redshift subnet group"},"redshift_subnet_ipv6_prefixes":{"default":[],"description":"Assigns IPv6 redshift subnet id based on the Amazon provided /56 prefix base 10 integer (0-256). Must be of equal length to the corresponding IPv4 subnet list"},"redshift_subnet_names":{"default":[],"description":"Explicit values to use in the Name tag on redshift subnets. If empty, Name tags are generated."},"redshift_subnet_suffix":{"default":"redshift","description":"Suffix to append to redshift subnets name"},"redshift_subnet_tags":{"default":{},"description":"Additional tags for the redshift subnets"},"redshift_subnets":{"default":[],"description":"A list of redshift subnets"},"reuse_nat_ips":{"default":false,"description":"Should be true if you don't want EIPs to be created for your NAT Gateways and will instead pass them in via the 'external_nat_ip_ids' variable"},"secondary_cidr_blocks":{"default":[],"description":"List of secondary CIDR blocks to associate with the VPC to extend the IP Address pool"},"single_nat_gateway":{"default":false,"description":"Should be true if you want to provision a single shared NAT Gateway across all of your private networks"},"tags":{"default":{},"description":"A map of tags to add to all resources"},"use_ipam_pool":{"default":false,"description":"Determines whether IPAM pool is used for CIDR allocation"},"vpc_flow_log_permissions_boundary":{"default":null,"description":"The ARN of the Permissions Boundary for the VPC Flow Log IAM Role"},"vpc_flow_log_tags":{"default":{},"description":"Additional tags for the VPC Flow Logs"},"vpc_tags":{"default":{},"description":"Additional tags for the VPC"},"vpn_gateway_az":{"default":null,"description":"The Availability Zone for the VPN Gateway"},"vpn_gateway_id":{"default":"","description":"ID of VPN Gateway to attach to the VPC"},"vpn_gateway_tags":{"default":{},"description":"Additional tags for the VPN gateway"}}},"version_constraint":"3.18.1"},"vpc_endpoints":{"source":"terraform-aws-modules/vpc/aws//modules/vpc-endpoints","expressions":{"endpoints":{"constant_value":{"s3":{"service":"s3","tags":{"Name":"s3-vpc-endpoint"}}}},"tags":{"constant_value":{"Environment":"setup"}},"vpc_id":{"references":["module.vpc.vpc_id","module.vpc"]}},"module":{"outputs":{"endpoints":{"expression":{"references":["aws_vpc_endpoint.this"]},"description":"Array containing the full resource object and attributes for all endpoints created"}},"resources":[{"address":"aws_vpc_endpoint.this","mode":"managed","type":"aws_vpc_endpoint","name":"this","provider_config_key":"aws","expressions":{"auto_accept":{"references":["each.value"]},"policy":{"references":["each.value"]},"private_dns_enabled":{"references":["each.value","each.value"]},"route_table_ids":{"references":["each.value","each.value"]},"security_group_ids":{"references":["each.value","var.security_group_ids","each.value","var.security_group_ids","each.value"]},"service_name":{"references":["data.aws_vpc_endpoint_service.this","each.key"]},"subnet_ids":{"references":["each.value","var.subnet_ids","each.value"]},"tags":{"references":["var.tags","each.value"]},"timeouts":{"create":{"references":["var.timeouts"]},"delete":{"references":["var.timeouts"]},"update":{"references":["var.timeouts"]}},"vpc_endpoint_type":{"references":["each.value"]},"vpc_id":{"references":["var.vpc_id"]}},"schema_version":0,"for_each_expression":{"references":["local.endpoints"]}},{"address":"data.aws_vpc_endpoint_service.this","mode":"data","type":"aws_vpc_endpoint_service","name":"this","provider_config_key":"aws","expressions":{"filter":[{"name":{"constant_value":"service-type"},"values":{"references":["each.value"]}}],"service":{"references":["each.value"]},"service_name":{"references":["each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.endpoints"]}}],"variables":{"create":{"default":true,"description":"Determines whether resources will be created"},"endpoints":{"default":{},"description":"A map of interface and/or gateway endpoints containing their properties and configurations"},"security_group_ids":{"default":[],"description":"Default security group IDs to associate with the VPC endpoints"},"subnet_ids":{"default":[],"description":"Default subnets IDs to associate with the VPC endpoints"},"tags":{"default":{},"description":"A map of tags to use on all resources"},"timeouts":{"default":{},"description":"Define maximum timeout for creating, updating, and deleting VPC endpoint resources"},"vpc_id":{"default":null,"description":"The ID of the VPC in which the endpoint will be used"}}},"version_constraint":"3.18.1"}},"variables":{"aws_region":{"description":"AWS region."},"environment":{"description":"A name that identifies the environment, used as prefix and for tagging."}}}},"relevant_attributes":[{"resource":"module.vpc.aws_vpc_ipv4_cidr_block_association.this","attribute":[]},{"resource":"module.runner.aws_security_group.runner","attribute":["id"]},{"resource":"module.vpc.aws_default_vpc.this[0]","attribute":["id"]},{"resource":"module.vpc.aws_default_vpc.this[0]","attribute":["enable_dns_support"]},{"resource":"module.vpc.aws_default_vpc.this[0]","attribute":["arn"]},{"resource":"module.vpc.aws_default_vpc.this[0]","attribute":["default_route_table_id"]},{"resource":"module.vpc.aws_network_acl.public[0]","attribute":["arn"]},{"resource":"module.vpc.aws_internet_gateway.this[0]","attribute":["id"]},{"resource":"module.vpc.aws_customer_gateway.this","attribute":[]},{"resource":"data.aws_availability_zones.available","attribute":["names",0]},{"resource":"module.runner.aws_iam_role.docker_machine[0]","attribute":["name"]},{"resource":"module.runner.module.terminate_agent_hook.aws_lambda_function.terminate_runner_instances","attribute":["arn"]},{"resource":"module.runner.module.terminate_agent_hook.aws_cloudwatch_event_rule.terminate_instances","attribute":["name"]},{"resource":"module.vpc.aws_route.database_ipv6_egress[0]","attribute":["id"]},{"resource":"module.vpc.aws_route_table_association.redshift_public","attribute":[]},{"resource":"module.runner.module.terminate_agent_hook.aws_lambda_function.terminate_runner_instances","attribute":["invoke_arn"]},{"resource":"module.vpc.aws_route_table.private","attribute":[]},{"resource":"module.runner.module.terminate_agent_hook.data.aws_iam_policy_document.assume_role","attribute":["json"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["ipv6_association_id"]},{"resource":"module.runner.aws_kms_key.default[0]","attribute":["arn"]},{"resource":"module.vpc.aws_iam_role.vpc_flow_log_cloudwatch[0]","attribute":["arn"]},{"resource":"module.vpc.aws_elasticache_subnet_group.elasticache[0]","attribute":["id"]},{"resource":"module.vpc.aws_eip.nat","attribute":[]},{"resource":"module.runner.aws_iam_role.docker_machine[0]","attribute":["arn"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["cidr_block"]},{"resource":"module.vpc.aws_network_acl.private[0]","attribute":["id"]},{"resource":"module.vpc.aws_route_table_association.public","attribute":[]},{"resource":"module.vpc.aws_route.private_nat_gateway","attribute":[]},{"resource":"module.runner.aws_security_group.runner","attribute":["name"]},{"resource":"module.runner.aws_iam_role.instance[0]","attribute":["name"]},{"resource":"module.runner.aws_launch_template.gitlab_runner_instance","attribute":["latest_version"]},{"resource":"module.vpc.aws_route_table_association.intra","attribute":[]},{"resource":"module.vpc.aws_route_table.redshift","attribute":[]},{"resource":"module.vpc.aws_route_table.elasticache","attribute":[]},{"resource":"module.runner.aws_iam_role.docker_machine","attribute":[]},{"resource":"module.runner.data.aws_caller_identity.current","attribute":["account_id"]},{"resource":"module.vpc.aws_default_vpc.this[0]","attribute":["default_network_acl_id"]},{"resource":"module.vpc.aws_route_table.intra","attribute":[]},{"resource":"module.vpc.aws_network_acl.redshift[0]","attribute":["arn"]},{"resource":"module.vpc.aws_route_table.database","attribute":[]},{"resource":"module.runner.aws_eip.gitlab_runner","attribute":[]},{"resource":"module.vpc.aws_route.public_internet_gateway_ipv6[0]","attribute":["id"]},{"resource":"module.runner.aws_security_group.docker_machine","attribute":[]},{"resource":"module.vpc.aws_subnet.intra","attribute":[]},{"resource":"module.vpc.aws_network_acl.redshift[0]","attribute":["id"]},{"resource":"module.vpc.aws_vpc_ipv4_cidr_block_association.this[0]","attribute":["vpc_id"]},{"resource":"module.vpc.aws_route_table.public","attribute":[]},{"resource":"module.vpc.aws_network_acl.private[0]","attribute":["arn"]},{"resource":"module.runner.aws_security_group.docker_machine[0]","attribute":["id"]},{"resource":"module.runner.module.terminate_agent_hook.aws_iam_role.lambda","attribute":["name"]},{"resource":"module.vpc.aws_default_vpc.this[0]","attribute":["instance_tenancy"]},{"resource":"module.vpc.aws_default_vpc.this[0]","attribute":["main_route_table_id"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["default_security_group_id"]},{"resource":"module.vpc.aws_network_acl.outpost[0]","attribute":["id"]},{"resource":"module.runner.aws_autoscaling_group.gitlab_runner_instance","attribute":["arn"]},{"resource":"module.vpc.aws_nat_gateway.this","attribute":[]},{"resource":"module.runner.data.aws_ami.runner","attribute":["id"]},{"resource":"module.vpc.aws_default_vpc.this[0]","attribute":["cidr_block"]},{"resource":"module.vpc.aws_db_subnet_group.database[0]","attribute":["id"]},{"resource":"module.vpc.aws_redshift_subnet_group.redshift[0]","attribute":["id"]},{"resource":"module.runner.module.terminate_agent_hook.data.archive_file.terminate_runner_instances_lambda","attribute":["output_path"]},{"resource":"module.vpc.aws_vpn_gateway.this[0]","attribute":["id"]},{"resource":"module.vpc.aws_route_table_association.private","attribute":[]},{"resource":"module.runner.module.cache[0].aws_s3_bucket.build_cache","attribute":["bucket"]},{"resource":"module.runner.module.cache[0].data.aws_caller_identity.current","attribute":["account_id"]},{"resource":"module.runner.data.aws_partition.current","attribute":["partition"]},{"resource":"module.vpc.aws_vpc_dhcp_options.this[0]","attribute":["id"]},{"resource":"module.vpc.aws_route.database_nat_gateway","attribute":[]},{"resource":"module.vpc_endpoints.aws_vpc_endpoint.this","attribute":[]},{"resource":"module.vpc.aws_cloudwatch_log_group.flow_log[0]","attribute":["arn"]},{"resource":"module.vpc.aws_default_vpc.this[0]","attribute":["enable_dns_hostnames"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["default_network_acl_id"]},{"resource":"module.runner.data.aws_availability_zone.runners","attribute":["name_suffix"]},{"resource":"module.runner.aws_iam_policy.instance_session_manager_policy[0]","attribute":["arn"]},{"resource":"module.runner.aws_security_group.docker_machine[0]","attribute":["name"]},{"resource":"module.runner.module.terminate_agent_hook.aws_iam_policy.lambda","attribute":["arn"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["arn"]},{"resource":"module.runner.aws_autoscaling_group.gitlab_runner_instance","attribute":["name"]},{"resource":"module.vpc.aws_egress_only_internet_gateway.this","attribute":[]},{"resource":"module.runner.aws_launch_template.gitlab_runner_instance","attribute":["name"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["id"]},{"resource":"module.vpc.aws_subnet.elasticache","attribute":[]},{"resource":"module.vpc.aws_network_acl.database[0]","attribute":["arn"]},{"resource":"module.runner.module.cache.aws_s3_bucket.build_cache","attribute":["bucket"]},{"resource":"module.runner.aws_iam_instance_profile.docker_machine[0]","attribute":["name"]},{"resource":"module.vpc.aws_internet_gateway.this[0]","attribute":["arn"]},{"resource":"data.aws_region.this","attribute":["id"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["ipv6_cidr_block"]},{"resource":"module.vpc.aws_route.database_internet_gateway[0]","attribute":["id"]},{"resource":"module.runner.module.cache[0].random_string.s3_suffix[0]","attribute":["result"]},{"resource":"module.runner.module.cache.data.aws_caller_identity.current","attribute":["account_id"]},{"resource":"module.runner.aws_iam_policy.ssm[0]","attribute":["arn"]},{"resource":"module.vpc.aws_subnet.public","attribute":[]},{"resource":"module.runner.module.terminate_agent_hook.data.aws_caller_identity.this","attribute":["account_id"]},{"resource":"module.vpc.aws_default_vpc.this[0]","attribute":["default_security_group_id"]},{"resource":"module.vpc.aws_network_acl.elasticache[0]","attribute":["id"]},{"resource":"module.runner.module.cache[0].aws_iam_policy.docker_machine_cache","attribute":["arn"]},{"resource":"module.vpc.aws_network_acl.intra[0]","attribute":["id"]},{"resource":"module.runner.module.terminate_agent_hook.data.archive_file.terminate_runner_instances_lambda","attribute":["output_base64sha256"]},{"resource":"module.runner.module.cache[0].aws_s3_bucket.build_cache","attribute":["arn"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["owner_id"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["instance_tenancy"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["main_route_table_id"]},{"resource":"module.vpc.aws_vpn_gateway.this[0]","attribute":["arn"]},{"resource":"module.vpc.aws_subnet.private","attribute":[]},{"resource":"module.runner.module.terminate_agent_hook.data.aws_iam_policy_document.lambda","attribute":["json"]},{"resource":"module.runner.module.terminate_agent_hook.aws_lambda_function.terminate_runner_instances","attribute":["version"]},{"resource":"module.vpc.aws_network_acl.database[0]","attribute":["id"]},{"resource":"module.runner.module.cache.aws_s3_bucket.build_cache","attribute":["arn"]},{"resource":"module.runner.aws_iam_policy.service_linked_role[0]","attribute":["arn"]},{"resource":"module.runner.aws_iam_policy.instance_docker_machine_policy[0]","attribute":["arn"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["enable_dns_support"]},{"resource":"module.vpc.aws_subnet.database","attribute":[]},{"resource":"module.runner.module.terminate_agent_hook.aws_lambda_function.terminate_runner_instances","attribute":["function_name"]},{"resource":"module.vpc.aws_route.private_ipv6_egress","attribute":[]},{"resource":"module.runner.module.terminate_agent_hook.aws_iam_role.lambda","attribute":["arn"]},{"resource":"module.runner.module.terminate_agent_hook.data.aws_partition.current","attribute":["partition"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["default_route_table_id"]},{"resource":"module.vpc.aws_vpc.this[0]","attribute":["enable_dns_hostnames"]},{"resource":"module.vpc.aws_db_subnet_group.database[0]","attribute":["name"]},{"resource":"module.vpc.aws_subnet.redshift","attribute":[]},{"resource":"module.vpc.aws_elasticache_subnet_group.elasticache[0]","attribute":["name"]},{"resource":"module.runner.module.cache.aws_iam_policy.docker_machine_cache","attribute":["arn"]},{"resource":"module.vpc_endpoints.data.aws_vpc_endpoint_service.this","attribute":[]},{"resource":"module.runner.module.cache[0].aws_s3_bucket.build_cache","attribute":["id"]},{"resource":"module.runner.module.terminate_agent_hook.aws_cloudwatch_log_group.lambda","attribute":["arn"]},{"resource":"module.vpc.aws_egress_only_internet_gateway.this[0]","attribute":["id"]},{"resource":"module.vpc.aws_vpn_gateway_attachment.this[0]","attribute":["vpn_gateway_id"]},{"resource":"module.vpc.aws_network_acl.outpost[0]","attribute":["arn"]},{"resource":"module.runner.module.terminate_agent_hook.aws_cloudwatch_event_rule.terminate_instances","attribute":["arn"]},{"resource":"module.vpc.aws_route.public_internet_gateway[0]","attribute":["id"]},{"resource":"module.vpc.aws_network_acl.intra[0]","attribute":["arn"]},{"resource":"module.vpc.aws_network_acl.elasticache[0]","attribute":["arn"]},{"resource":"module.vpc.aws_route_table_association.elasticache","attribute":[]},{"resource":"module.runner.module.terminate_agent_hook.aws_lambda_function.terminate_runner_instances","attribute":["source_code_hash"]},{"resource":"module.runner.data.aws_ami.docker-machine[0]","attribute":["id"]},{"resource":"module.vpc.aws_route_table.public[0]","attribute":["id"]},{"resource":"module.runner.data.aws_subnet.runners","attribute":["availability_zone"]},{"resource":"module.vpc.aws_flow_log.this[0]","attribute":["id"]},{"resource":"module.vpc.aws_route_table_association.database","attribute":[]},{"resource":"module.vpc.aws_network_acl.public[0]","attribute":["id"]},{"resource":"module.runner.aws_launch_template.gitlab_runner_instance","attribute":["id"]},{"resource":"module.runner.module.terminate_agent_hook.data.aws_region.this","attribute":["name"]},{"resource":"module.vpc.aws_subnet.outpost","attribute":[]},{"resource":"module.vpc.aws_route_table_association.redshift","attribute":[]},{"resource":"module.runner.module.cache.random_string.s3_suffix[0]","attribute":["result"]}]}
